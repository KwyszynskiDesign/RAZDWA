<div class="category-template">
  <h2>Druk A4/A3 + skan</h2>
  
  <!-- TRYB + FORMAT -->
  <div class="form-row">
    <div class="form-group">
      <label>Tryb:</label>
      <select id="d-mode">
        <option value="bw">CzarnobiaÅ‚y</option>
        <option value="color">Kolorowy</option>
      </select>
    </div>
    <div class="form-group">
      <label>Format:</label>
      <select id="d-format">
        <option value="A4">A4</option>
        <option value="A3">A3</option>
      </select>
    </div>
  </div>

  <!-- DRUK -->
  <div class="form-group">
    <label>IloÅ›Ä‡ stron do druku:</label>
    <input type="number" id="d-print-qty" min="0" value="1">
  </div>

  <!-- OPCJE -->
  <div class="form-row">
    <div class="form-group">
      <label><input type="checkbox" id="d-email"> E-mail (1zÅ‚)</label>
    </div>
    <div class="form-group">
      <label><input type="checkbox" id="d-surcharge"> Zadruk >25% (+50%)</label>
    </div>
  </div>

  <!-- DOPÅATA ZADRUK -->
  <div class="form-row" id="surcharge-qty-row" style="display:none;">
    <div class="form-group">
      <label>IloÅ›Ä‡ zadrukowanych >25%:</label>
      <input type="number" id="d-surcharge-qty" min="0" value="0">
    </div>
  </div>

  <!-- SKANOWANIE -->
  <div class="form-group">
    <label>Rodzaj skanowania:</label>
    <select id="d-scan-type">
      <option value="none">Brak</option>
      <option value="auto">Automatyczne</option>
      <option value="manual">RÄ™czne z szyby</option>
    </select>
  </div>

  <div class="form-row" id="scan-qty-row" style="display:none;">
    <div class="form-group">
      <label>IloÅ›Ä‡ stron do skanowania:</label>
      <input type="number" id="d-scan-qty" min="0" value="1">
    </div>
  </div>

  <!-- PRZYCISKI -->
  <div class="form-row">
    <button id="d-calculate" class="btn-primary">Oblicz</button>
    <button id="d-add-to-cart" class="btn-secondary" disabled>Dodaj do listy</button>
  </div>

  <!-- WYNIKI -->
  <div id="d-result-display" style="display:none;">
    <div class="result-row">ğŸ’° Cena druku/str.: <span id="d-unit-print-price">-</span></div>
    <div class="result-row">ğŸ“„ CaÅ‚kowity druk: <span id="d-total-print-price">-</span></div>
    <div class="result-row" id="d-scan-row" style="display:none;">ğŸ“· Skanowanie: <span id="d-total-scan-price">-</span></div>
    <div class="result-row" id="d-email-row" style="display:none;">ğŸ“§ E-mail: <span id="d-email-price">-</span></div>
    <div class="result-row" id="d-surcharge-row" style="display:none;">ğŸ¨ DopÅ‚ata zadruk: <span id="d-surcharge-price">-</span></div>
    <hr>
    <div class="result-row total" style="font-size:1.4em; color:#28a745; font-weight:bold;">
      ğŸ’ **SUMA: <span id="d-total-price">-</span>**
    </div>
  </div>

  <!-- EXPRESS HINT -->
  <div id="d-express-hint" style="display:none; color:orange; font-weight:bold;">âš¡ TRYB EXPRESS +20%</div>

  <!-- CENNÄ°K - POPRAWNE CENY Z TWOJEGO KODU + Tabele UX -->
  <div class="pricing-table" style="margin-top:30px;">
    <h3>ğŸ“‹ Cennik Studio Raz Dwa</h3>
    
    <!-- DRUK CZARNO-BIAÅY -->
    <h4>ğŸ–¨ï¸ DRUK CZARNO-BIAÅY</h4>
    <table style="width:100%; border-collapse:collapse; margin:10px 0; background:#f8f9fa;">
      <tr style="background:#343a40; color:white;">
        <th style="padding:8px; border:1px solid #ddd;">NakÅ‚ad</th>
        <th style="padding:8px; border:1px solid #ddd;">A4</th>
        <th style="padding:8px; border:1px solid #ddd;">A3</th>
      </tr>
      <tr><td style="padding:6px; border:1px solid #ddd;">1-5 str.</td><td style="padding:6px; border:1px solid #ddd;">0,90 zÅ‚</td><td style="padding:6px; border:1px solid #ddd;">1,70 zÅ‚</td></tr>
      <tr><td style="padding:6px; border:1px solid #ddd;">6-20 str.</td><td style="padding:6px; border:1px solid #ddd;">0,60 zÅ‚</td><td style="padding:6px; border:1px solid #ddd;">1,10 zÅ‚</td></tr>
      <tr><td style="padding:6px; border:1px solid #ddd;">21-100 str.</td><td style="padding:6px; border:1px solid #ddd;">0,35 zÅ‚</td><td style="padding:6px; border:1px solid #ddd;">0,70 zÅ‚</td></tr>
      <tr><td style="padding:6px; border:1px solid #ddd;">101-500 str.</td><td style="padding:6px; border:1px solid #ddd;">0,30 zÅ‚</td><td style="padding:6px; border:1px solid #ddd;">0,60 zÅ‚</td></tr>
      <tr><td style="padding:6px; border:1px solid #ddd;">501-999 str.</td><td style="padding:6px; border:1px solid #ddd;">0,23 zÅ‚</td><td style="padding:6px; border:1px solid #ddd;">0,45 zÅ‚</td></tr>
      <tr><td style="padding:6px; border:1px solid #ddd;">1000+ str.</td><td style="padding:6px; border:1px solid #ddd;">0,15 zÅ‚</td><td style="padding:6px; border:1px solid #ddd;">0,33 zÅ‚</td></tr>
    </table>

    <!-- DRUK KOLOROWY -->
    <h4>ğŸŒˆ DRUK KOLOROWY</h4>
    <table style="width:100%; border-collapse:collapse; margin:10px 0; background:#f8f9fa;">
      <tr style="background:#007bff; color:white;">
        <th style="padding:8px; border:1px solid #ddd;">NakÅ‚ad</th>
        <th style="padding:8px; border:1px solid #ddd;">A4</th>
        <th style="padding:8px; border:1px solid #ddd;">A3</th>
      </tr>
      <tr><td style="padding:6px; border:1px solid #ddd;">1-10 str.</td><td style="padding:6px; border:1px solid #ddd;">2,40 zÅ‚</td><td style="padding:6px; border:1px solid #ddd;">4,80 zÅ‚</td></tr>
      <tr><td style="padding:6px; border:1px solid #ddd;">11-40 str.</td><td style="padding:6px; border:1px solid #ddd;">2,20 zÅ‚</td><td style="padding:6px; border:1px solid #ddd;">4,20 zÅ‚</td></tr>
      <tr><td style="padding:6px; border:1px solid #ddd;">41-100 str.</td><td style="padding:6px; border:1px solid #ddd;">2,00 zÅ‚</td><td style="padding:6px; border:1px solid #ddd;">3,80 zÅ‚</td></tr>
      <tr><td style="padding:6px; border:1px solid #ddd;">101-250 str.</td><td style="padding:6px; border:1px solid #ddd;">1,80 zÅ‚</td><td style="padding:6px; border:1px solid #ddd;">3,00 zÅ‚</td></tr>
      <tr><td style="padding:6px; border:1px solid #ddd;">251-500 str.</td><td style="padding:6px; border:1px solid #ddd;">1,60 zÅ‚</td><td style="padding:6px; border:1px solid #ddd;">2,50 zÅ‚</td></tr>
      <tr><td style="padding:6px; border:1px solid #ddd;">501+ str.</td><td style="padding:6px; border:1px solid #ddd;">1,10 zÅ‚</td><td style="padding:6px; border:1px solid #ddd;">1,60 zÅ‚</td></tr>
    </table>

    <!-- SKANOWANIE -->
    <h4>ğŸ“· SKANOWANIE</h4>
    <table style="width:100%; border-collapse:collapse; margin:10px 0; background:#f8f9fa;">
      <tr style="background:#28a745; color:white;">
        <th style="padding:8px; border:1px solid #ddd;">Automatyczne</th>
        <th style="padding:8px; border:1px solid #ddd;">NakÅ‚ad</th>
        <th style="padding:8px; border:1px solid #ddd;">Cena</th>
      </tr>
      <tr><td style="padding:6px; border:1px solid #ddd;" colspan="3">1-9: 1,00 zÅ‚ | 10-49: 0,50 zÅ‚ | 50-99: 0,40 zÅ‚ | 100+: 0,25 zÅ‚</td></tr>
      
      <tr style="background:#ffc107; color:black;">
        <th style="padding:8px; border:1px solid #ddd;">RÄ™czne (z szyby)</th>
        <th style="padding:8px; border:1px solid #ddd;">NakÅ‚ad</th>
        <th style="padding:8px; border:1px solid #ddd;">Cena</th>
      </tr>
      <tr><td style="padding:6px; border:1px solid #ddd;" colspan="3">1-4: 2,00 zÅ‚ | 5+: 1,00 zÅ‚ (+20% kopie z szyby)</td></tr>
    </table>

    <div style="font-size:0.9em; color:#666; margin-top:15px; padding:10px; background:#e9ecef; border-radius:5px;">
      âš ï¸ <strong>Zadruk >25% powierzchni:</strong> +50% ceny podstawowej<br>
      ğŸ“§ <strong>E-mail:</strong> 1,00 zÅ‚
    </div>
  </div>
</div>

<script>
document.getElementById('d-surcharge').addEventListener('change', function() {
  document.getElementById('surcharge-qty-row').style.display = this.checked ? 'flex' : 'none';
});

document.getElementById('d-scan-type').addEventListener('change', function() {
  document.getElementById('scan-qty-row').style.display = this.value !== 'none' ? 'flex' : 'none';
});

// CENNÄ°K POPRAWNY - Z TWOJEGO KODU
const cenyDruk = {
  bw: {
    A4: [[5,0.90],[20,0.60],[100,0.35],[500,0.30],[999,0.23],[Infinity,0.15]],
    A3: [[5,1.70],[20,1.10],[100,0.70],[500,0.60],[999,0.45],[Infinity,0.33]]
  },
  color: {
    A4: [[10,2.40],[40,2.20],[100,2.00],[250,1.80],[500,1.60],[Infinity,1.10]],
    A3: [[10,4.80],[40,4.20],[100,3.80],[250,3.00],[500,2.50],[Infinity,1.60]]
  }
};

document.getElementById('d-calculate').addEventListener('click', function() {
  // OBLICZANIE DRUKU
  const mode = document.getElementById('d-mode').value;
  const format = document.getElementById('d-format').value;
  const printQty = parseInt(document.getElementById('d-print-qty').value) || 0;
  
  let unitPrintPrice = 0;
  if (printQty > 0) {
    for (let zakres of cenyDruk[mode][format]) {
      if (printQty <= zakres[0]) {
        unitPrintPrice = zakres[1];
        break;
      }
    }
  }
  
  const totalPrintPrice = (unitPrintPrice * printQty).toFixed(2);
  
  // DOPÅATA ZADRUK
  const surchargeChecked = document.getElementById('d-surcharge').checked;
  let surchargePrice = 0;
  if (surchargeChecked) {
    const surchargeQty = parseInt(document.getElementById('d-surcharge-qty').value) || 0;
    surchargePrice = (unitPrintPrice * 0.5 * surchargeQty).toFixed(2);
  }
  
  // SKANOWANIE
  const scanType = document.getElementById('d-scan-type').value;
  let scanPrice = 0;
  if (scanType !== 'none') {
    const scanQty = parseInt(document.getElementById('d-scan-qty').value) || 0;
    if (scanType === 'auto') {
      if (scanQty <= 9) scanPrice = 1.00;
      else if (scanQty <= 49) scanPrice = 0.50;
      else if (scanQty <= 99) scanPrice = 0.40;
      else scanPrice = 0.25;
    } else {
      scanPrice = scanQty <= 4 ? 2.00 : 1.00;
    }
    scanPrice *= scanQty;
    scanPrice = scanPrice.toFixed(2);
  }
  
  // E-MAIL
  const emailChecked = document.getElementById('d-email').checked;
  const emailPrice = emailChecked ? '1,00' : '0,00';
  
  // SUMA
  const total = (parseFloat(totalPrintPrice) + parseFloat(surchargePrice) + parseFloat(scanPrice) + parseFloat(emailPrice.replace(',','.'))).toFixed(2);
  
  // WYÅšWIETLANIE
  document.getElementById('d-unit-print-price').textContent = unitPrintPrice.toFixed(2) + ' zÅ‚';
  document.getElementById('d-total-print-price').textContent = totalPrintPrice + ' zÅ‚';
  document.getElementById('d-total-scan-price').textContent = scanPrice + ' zÅ‚';
  document.getElementById('d-email-price').textContent = emailPrice + ' zÅ‚';
  document.getElementById('d-surcharge-price').textContent = surchargePrice + ' zÅ‚';
  document.getElementById('d-total-price').textContent = total.replace('.',',') + ' zÅ‚';
  
  document.getElementById('d-result-display').style.display = 'block';
  document.querySelector('.total').scrollIntoView({ behavior: 'smooth' });
  
  if (totalPrintPrice > 0) {
    document.getElementById('d-add-to-cart').disabled = false;
  }
});
</script>
