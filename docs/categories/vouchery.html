<!DOCTYPE html>
<html>
<head>
  <title>Vouchery A4 - RAZDWA</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="assets/styles.css">
  <style>
    /* Quick UI fixes jeśli brak w CSS */
    .card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    .btn { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
    .btn-primary { background: #007cba; color: white; }
    .btn-success { background: #28a745; color: white; }
    .price-value { font-size: 1.5em; font-weight: bold; color: #28a745; }
  </style>
</head>
<body>
<div class="category-view">
    <div class="view-header">
        <h2>Vouchery A4</h2>
    </div>

    <div class="calculator-form card">
        <div class="form-group">
            <label for="v-qty">Ilość (szt):</label>
            <input type="number" id="v-qty" class="form-control" value="1" min="1" max="30" step="1">
            <div class="hint">Zakres 1-30 szt.</div>
        </div>

        <div class="form-group">
            <label>Zadruk:</label>
            <div class="radio-group" style="display: flex; gap: 20px; margin-top: 8px;">
                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                    <input type="radio" name="v-sides" value="single" checked> Jednostronne
                </label>
                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                    <input type="radio" name="v-sides" value="double"> Dwustronne
                </label>
            </div>
        </div>

        <!-- NOWE: Papier typ -->
        <div class="form-group">
            <label>Papier:</label>
            <select id="v-papier">
                <option value="kreda">Kreda (+0%)</option>
                <option value="satyna">Satyna (+12%)</option>
            </select>
        </div>

        <!-- NOWE: Gramatura (bez 100g) -->
        <div class="form-group">
            <label>Gramatura:</label>
            <select id="v-gramatura">
                <option value="200g">200g standard (+0%)</option>
                <option value="300g">300g premium (+25%)</option>
            </select>
        </div>

        <div class="form-group checkbox-group">
            <input type="checkbox" id="v-express">
            <label for="v-express">EXPRESS (+30%)</label>
        </div>

        <div class="form-actions">
            <button id="v-calculate" class="btn btn-primary">Oblicz Live</button>
            <button id="v-export-excel" class="btn btn-info">Export Excel</button>
            <button id="v-add-to-cart" class="btn btn-success" disabled>Dodaj do koszyka</button>
        </div>
    </div>

    <div id="v-result-display" class="result-display card" style="display: none;">
        <div class="result-row">
            <span>Cena bazowa:</span>
            <span id="v-base-price" class="price-unit">-</span>
        </div>
        <div id="v-modifiers-row" class="result-row" style="display: none;">
            <span>Dopłaty:</span>
            <span id="v-modifiers-total">-</span>
        </div>
        <div class="result-row total-row">
            <span>Cena brutto (VAT 23%):</span>
            <span id="v-total-price" class="price-value">-</span>
        </div>
    </div>
</div>

<script>
// Live calculator + Excel export
class VoucherCalculator {
  constructor() {
    this.qty = document.getElementById('v-qty');
    this.sides = document.querySelector('input[name="v-sides"]');
    this.papier = document.getElementById('v-papier');
    this.gramatura = document.getElementById('v-gramatura');
    this.express = document.getElementById('v-express');
    
    // Live update
    this.qty.addEventListener('input', () => this.calc());
    this.sides.addEventListener('change', () => this.calc());
    this.papier.addEventListener('change', () => this.calc());
    this.gramatura.addEventListener('change', () => this.calc());
    this.express.addEventListener('change', () => this.calc());
    
    document.getElementById('v-export-excel').onclick = () => this.exportExcel();
  }
  
  calc() {
    const qty = parseInt(this.qty.value) || 1;
    let base = 2.50;  // Cena jednostkowa voucher A4
    
    // Modyfikatory
    const sidesMod = document.querySelector('input[name="v-sides"]:checked').value === 'double' ? 1.8 : 1;
    const papierMod = this.papier.value === 'satyna' ? 1.12 : 1;
    const gramMod = this.gramatura.value === '300g' ? 1.25 : 1;
    const expressMod = this.express.checked ? 1.30 : 1;
    
    const subtotal = qty * base * sidesMod * papierMod * gramMod * expressMod;
    const vat = subtotal * 0.23;
    const total = subtotal + vat;
    
    // Update UI
    document.getElementById('v-base-price').textContent = `${(qty * base).toFixed(2)}zł`;
    document.getElementById('v-modifiers-total').textContent = 
      `S:${sidesMod.toFixed(1)}x P:${papierMod.toFixed(1)}x G:${gramMod.toFixed(1)}x E:${expressMod.toFixed(1)}x`;
    document.getElementById('v-total-price').textContent = `${total.toFixed(2)}zł`;
    document.getElementById('v-result-display').style.display = 'block';
    document.getElementById('v-add-to-cart').disabled = false;
    
    this.currentData = { qty, papier: this.papier.value, gramatura: this.gramatura.value, total: total.toFixed(2) };
  }
  
  exportExcel() {
    const excelData = {
      Kategoria: 'Vouchery A4',
      Ilość: this.currentData.qty,
      Papier: this.currentData.papier,
      Gramatura: this.currentData.gramatura,
      'Cena brutto': this.currentData.total + ' PLN',
      Data: new Date().toLocaleString('pl-PL')
    };
    navigator.clipboard.writeText(JSON.stringify(excelData, null, 2));
    alert('✅ Dane skopiowane do Excela/Sheets!');
  }
}

new VoucherCalculator();
</script>
</body>
</html>
