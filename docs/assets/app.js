"use strict";(()=>{var at=Object.defineProperty;var j=(e,t)=>{for(var r in t)at(e,r,{get:t[r],enumerable:!0})};var R=class{constructor(t,r){this.routes=new Map;this.currentView=null;this.categories=[];this.container=t,this.getCtx=r,window.addEventListener("hashchange",()=>{this.handleRoute().catch(o=>{console.error("Router navigation error:",o),this.renderHome()})})}setCategories(t){this.categories=t}addRoute(t){this.routes.set(t.id,t)}async handleRoute(){var n;let t=window.location.hash||"#/",r=t.startsWith("#/")?t.slice(2):"";if(r=r.replace(/^\/+/,""),!r){this.renderHome();return}(n=this.currentView)!=null&&n.unmount&&this.currentView.unmount();let o=this.routes.get(r);if(o)this.currentView=o,await o.mount(this.container,this.getCtx());else try{let i=await fetch(`categories/${r}.html`);if(i.ok){this.currentView=null,this.container.innerHTML=await i.text(),this.container.querySelectorAll("script").forEach(m=>{var u;let p=document.createElement("script");p.textContent=(u=m.textContent)!=null?u:"",m.replaceWith(p)});try{let m=await fetch(`categories/${r}.js`);if(m.ok){let p=document.createElement("script");p.textContent=await m.text(),this.container.appendChild(p)}}catch{}}else this.renderHome()}catch(i){console.error("Category load:",i),this.renderHome()}}renderHome(){this.container.innerHTML=`
      <div style="text-align: center; padding: 40px; color: rgba(255,255,255,0.8);">
        <h2 style="margin:0; font-size: 24px;">Witaj w kalkulatorze Raz Druku Dwa</h2>
        <p style="margin-top: 10px;">Wybierz kategori\u0119 z panelu powy\u017Cej, aby rozpocz\u0105\u0107 obliczenia.</p>
      </div>
    `}start(){this.handleRoute()}};function ot(e,t){let r=[...e].sort((i,m)=>i.min-m.min),o=r.find(i=>t>=i.min&&(i.max===null||t<=i.max));if(o)return o;let n=r.find(i=>i.min>=t);return n!=null?n:r[r.length-1]}function Q(e,t){var m;let r=((m=e.rules)!=null?m:[]).find(p=>p.type==="minimum"&&p.unit==="m2"),o=r&&t<r.value?r.value:t,n=ot(e.tiers,o);return{basePrice:e.pricing==="per_unit"?o*n.price:n.price,effectiveQuantity:o,tierPrice:n.price}}function X(e,t,r,o){let n=0,i=[];for(let m of r){let p=o.find(u=>u.id===m);p&&(i.push(p.name),p.type==="percent"?n+=e*p.value:p.type==="fixed_per_unit"?n+=p.value*t:n+=p.value)}return{modifiersTotal:n,appliedModifiers:i}}function Z(e){return 0}function E(e,t,r=[]){var a,l;let{basePrice:o,effectiveQuantity:n,tierPrice:i}=Q(e,t),{modifiersTotal:m,appliedModifiers:p}=X(o,n,r,(a=e.modifiers)!=null?a:[]),u=o+m;u+=Z(u),u=u;let s=((l=e.rules)!=null?l:[]).find(c=>c.type==="minimum"&&c.unit==="pln");return s&&u<s.value&&(u=s.value),{basePrice:o,effectiveQuantity:n,tierPrice:i,modifiersTotal:m,totalPrice:parseFloat(u.toFixed(2)),appliedModifiers:p}}var I={};j(I,{default:()=>ut,id:()=>it,materials:()=>pt,modifiers:()=>mt,pricing:()=>lt,rules:()=>ct,title:()=>nt,unit:()=>st});var it="solwent-plakaty",nt="SOLWENT - PLAKATY",st="m2",lt="per_unit",ct=[{type:"minimum",unit:"m2",value:1}],mt=[{id:"express",name:"EXPRESS",type:"percent",value:.2}],pt=[{name:"Papier 150g p\xF3\u0142mat",tiers:[{min:1,max:3,price:65},{min:4,max:9,price:60},{min:10,max:20,price:55},{min:21,max:40,price:50},{min:41,max:null,price:42}]},{name:"Papier 200g po\u0142ysk",tiers:[{min:1,max:3,price:70},{min:4,max:9,price:65},{min:10,max:20,price:59},{min:21,max:40,price:53},{min:41,max:null,price:45}]},{name:"Papier 115g matowy",tiers:[{min:1,max:3,price:45},{min:4,max:19,price:40},{min:20,max:null,price:35}]}],ut={id:it,title:nt,unit:st,pricing:lt,rules:ct,modifiers:mt,materials:pt};function J(e){let t=I,r=t.materials.find(i=>i.name===e.material);if(!r)throw new Error(`Unknown material: ${e.material}`);let o={id:t.id,title:t.title,unit:t.unit,pricing:t.pricing,tiers:r.tiers,rules:t.rules,modifiers:t.modifiers},n=[];return e.express&&n.push("express"),E(o,e.areaM2,n)}var dt="pl-PL";function yt(e,t="PLN"){return new Intl.NumberFormat(dt,{style:"currency",currency:t==="PLN"?"PLN":"EUR",minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}var x=yt;var Y={id:"solwent-plakaty",name:"Solwent - Plakaty",async mount(e,t){try{let r=await fetch("categories/solwent-plakaty.html");if(!r.ok)throw new Error("Failed to load template");e.innerHTML=await r.text();let n=I.materials,i=e.querySelector("#material");i.innerHTML=n.map(m=>`<option value="${m.name}">${m.name}</option>`).join(""),this.initLogic(e,t)}catch(r){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${r}</div>`}},initLogic(e,t){let r=e.querySelector("#material"),o=e.querySelector("#area"),n=e.querySelector("#calculate"),i=e.querySelector("#add-to-cart"),m=e.querySelector("#result-display"),p=e.querySelector("#unit-price"),u=e.querySelector("#total-price"),s=e.querySelector("#express-hint"),a=null;n.onclick=()=>{let l={material:r.value,areaM2:parseFloat(o.value),express:t.expressMode};try{let c=J(l);a=c,p.innerText=x(c.tierPrice),u.innerText=x(c.totalPrice),s&&(s.style.display=t.expressMode?"block":"none"),m.style.display="block",i.disabled=!1,t.updateLastCalculated(c.totalPrice,"Solwent - Plakaty")}catch(c){alert("B\u0142\u0105d: "+c.message)}},i.onclick=()=>{a&&t.cart.addItem({id:`solwent-${Date.now()}`,category:"Solwent - Plakaty",name:r.value,quantity:parseFloat(o.value),unit:"m2",unitPrice:a.tierPrice,isExpress:t.expressMode,totalPrice:a.totalPrice,optionsHint:`${o.value}m2${t.expressMode?", EXPRESS":""}`,payload:a})}}};var C={};j(C,{default:()=>kt,formatowe:()=>gt,id:()=>ft,modifiers:()=>bt,solwent:()=>wt,title:()=>xt});var ft="plakaty",xt="Plakaty",wt={unit:"m2",minimumM2:1,materials:[{id:"200g-polysk",name:"200g Po\u0142ysk (solwent)",tiers:[{min:1,max:3,price:70},{min:4,max:9,price:65},{min:10,max:20,price:59},{min:21,max:40,price:53},{min:41,max:null,price:45}]},{id:"blockout200g",name:"Blockout 200g Satyna (solwent)",tiers:[{min:1,max:3,price:80},{min:4,max:9,price:75},{min:10,max:20,price:70},{min:21,max:40,price:65},{min:41,max:null,price:60}]},{id:"150g-polmat",name:"150g P\xF3\u0142mat (solwent)",tiers:[{min:1,max:3,price:65},{min:4,max:9,price:60},{min:10,max:20,price:55},{min:21,max:40,price:50},{min:41,max:null,price:42}]},{id:"115g-mat",name:"115g Matowy (solwent)",tiers:[{min:1,max:3,price:45},{min:4,max:19,price:40},{min:20,max:null,price:35}]}]},gt={unit:"szt",formats:["297x420","420x594","594x841","841x1189","914x1189","914x1292","rolka1067"],materials:[{id:"120g-formatowe",name:"120g Formatowe",discountGroup:"120g",prices:{"297x420":9,"420x594":12,"594x841":18,"841x1189":28,"914x1189":34,"914x1292":50,rolka1067:68}},{id:"120g-nieformatowe",name:"120g Nieformatowe",discountGroup:"120g",prices:{"297x420":28,"420x594":30,"594x841":33,"841x1189":35,"914x1292":50,rolka1067:63}},{id:"260g-satyna-formatowe",name:"260g Satyna Formatowe (fotoplakaty)",discountGroup:"260g",prices:{"297x420":23,"420x594":39,"594x841":50,"841x1189":80,"914x1292":88}},{id:"260g-satyna-nieformatowe",name:"260g Satyna Nieformatowe (fotoplakaty)",discountGroup:"260g",prices:{"297x420":27,"420x594":36,"594x841":39.5,"841x1189":66.7,"914x1292":75.3}},{id:"180g-pp-formatowe",name:"180g PP Formatowe",discountGroup:"120g",prices:{"297x420":18,"420x594":37,"610x841":45,"841x1189":70,"914x1292":74}},{id:"180g-pp-nieformatowe",name:"180g PP Nieformatowe",discountGroup:"120g",prices:{"297x420":23,"420x594":31,"610x841":34,"841x1189":62,"914x1292":70.5}}],discounts:{"120g":[{min:2,max:5,factor:.95},{min:6,max:20,factor:.92},{min:21,max:30,factor:.87}],"260g":[{min:9,max:20,factor:.93},{min:21,max:30,factor:.88}]}},bt=[{id:"express",name:"TRYB EXPRESS (+20%)",type:"percent",value:.2}],kt={id:ft,title:xt,solwent:wt,formatowe:gt,modifiers:bt};function G(e){var s;let t=C,r=t.solwent.materials.find(a=>a.id===e.materialId);if(!r)throw new Error(`Unknown solwent material: ${e.materialId}`);let o=(s=t.solwent.minimumM2)!=null?s:1,n=Math.max(e.areaM2,o),i=r.tiers.find(a=>n>=a.min&&(a.max===null||n<=a.max));if(!i)throw new Error(`No tier for ${n} m2`);let m=parseFloat((n*i.price).toFixed(2)),p=0,u=[];if(e.express){let a=t.modifiers.find(l=>l.id==="express");a&&(p=parseFloat((m*a.value).toFixed(2)),u.push(a.name))}return{materialName:r.name,effectiveM2:n,tierPrice:i.price,basePrice:m,modifiersTotal:p,totalPrice:parseFloat((m+p).toFixed(2)),appliedModifiers:u}}function ee(e){var c;let t=C,r=t.formatowe.materials.find(d=>d.id===e.materialId);if(!r)throw new Error(`Unknown format material: ${e.materialId}`);let o=r.prices[e.formatKey];if(o===void 0)throw new Error(`Unknown format: ${e.formatKey}`);let n=r.discountGroup,m=((c=t.formatowe.discounts[n])!=null?c:[]).find(d=>e.qty>=d.min&&(d.max===null||e.qty<=d.max)),p=m?m.factor:1,u=parseFloat((o*p).toFixed(2)),s=parseFloat((u*e.qty).toFixed(2)),a=0,l=[];if(e.express){let d=t.modifiers.find(k=>k.id==="express");d&&(a=parseFloat((s*d.value).toFixed(2)),l.push(d.name))}return{materialName:r.name,formatKey:e.formatKey,qty:e.qty,unitPrice:o,discountFactor:p,pricePerPiece:u,basePrice:s,modifiersTotal:a,totalPrice:parseFloat((s+a).toFixed(2)),appliedModifiers:l}}var ht=new Set(["200g-polysk","blockout200g","150g-polmat","115g-mat"]),te={id:"plakaty",name:"Plakaty",async mount(e,t){try{let r=await fetch("categories/plakaty.html");if(!r.ok)throw new Error("Failed to load template");e.innerHTML=await r.text(),this.initLogic(e,t)}catch(r){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${r}</div>`}},initLogic(e,t){let r=C,o=e.querySelector("#p-material"),n=e.querySelector("#p-format-group"),i=e.querySelector("#p-m2-group"),m=e.querySelector("#p-format"),p=e.querySelector("#p-qty"),u=e.querySelector("#p-area"),s=e.querySelector("#p-calculate"),a=e.querySelector("#p-add-to-cart"),l=e.querySelector("#p-result-display"),c=e.querySelector("#p-unit-price"),d=e.querySelector("#p-total-price"),k=e.querySelector("#p-express-hint"),f=[...r.solwent.materials,...r.formatowe.materials];o.innerHTML=f.map(b=>`<option value="${b.id}">${b.name}</option>`).join("");function w(b){return ht.has(b)}function h(b){let v=r.formatowe.materials.find(P=>P.id===b);if(!v)return;let S=Object.keys(v.prices);m.innerHTML=S.map(P=>`<option value="${P}">${P}</option>`).join("")}function g(){let b=o.value;w(b)?(n.style.display="none",i.style.display=""):(n.style.display="",i.style.display="none",h(b))}o.addEventListener("change",g),g();let y=null,T=null;s.onclick=()=>{let b=o.value;try{if(w(b)){let v=parseFloat(u.value)||1,S=G({materialId:b,areaM2:v,express:t.expressMode});y=S,T={type:"m2",matId:b,area:v},c.innerText=x(S.tierPrice),d.innerText=x(S.totalPrice)}else{let v=m.value,S=parseInt(p.value,10)||1,P=ee({materialId:b,formatKey:v,qty:S,express:t.expressMode});y=P,T={type:"format",matId:b,fmt:v,qty:S},c.innerText=x(P.pricePerPiece),d.innerText=x(P.totalPrice)}k&&(k.style.display=t.expressMode?"block":"none"),l.style.display="block",a.disabled=!1,t.updateLastCalculated(y.totalPrice,"Plakaty")}catch(v){alert("B\u0142\u0105d: "+v.message)}},a.onclick=()=>{if(!y||!T)return;let b=o.options[o.selectedIndex].text;if(T.type==="m2"){let v=`${T.area} m2${t.expressMode?", EXPRESS":""}`;t.cart.addItem({id:`plakaty-${Date.now()}`,category:"Plakaty",name:b,quantity:T.area,unit:"m2",unitPrice:y.tierPrice,isExpress:t.expressMode,totalPrice:y.totalPrice,optionsHint:v,payload:y})}else{let v=`${T.fmt} \xD7 ${T.qty} szt${t.expressMode?", EXPRESS":""}`;t.cart.addItem({id:`plakaty-${Date.now()}`,category:"Plakaty",name:b,quantity:T.qty,unit:"szt",unitPrice:y.pricePerPiece,isExpress:t.expressMode,totalPrice:y.totalPrice,optionsHint:v,payload:y})}}}};var re=[{qty:1,single:20,double:25},{qty:2,single:29,double:32},{qty:3,single:30,double:37},{qty:4,single:32,double:39},{qty:5,single:35,double:43},{qty:6,single:39,double:45},{qty:7,single:41,double:48},{qty:8,single:45,double:50},{qty:9,single:48,double:52},{qty:10,single:52,double:58},{qty:15,single:60,double:70},{qty:20,single:67,double:82},{qty:25,single:74,double:100},{qty:30,single:84,double:120}];function St(e,t){let r=re[0];for(let o of re)if(e>=o.qty)r=o;else break;return t?r.single:r.double}function ae(e){let t=St(e.qty,e.sides==="single"),r=0;e.satin&&(r+=.12),e.express&&(r+=.2);let o=t*r,n=t+o;return{basePrice:t,modifiersTotal:parseFloat(o.toFixed(2)),totalPrice:parseFloat(n.toFixed(2))}}var oe={id:"vouchery",name:"Vouchery",async mount(e,t){try{let r=await fetch("categories/vouchery.html");if(!r.ok)throw new Error("Failed to load template");e.innerHTML=await r.text(),this.initLogic(e,t)}catch(r){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${r}</div>`}},initLogic(e,t){let r=e.querySelector("#v-qty"),o=e.querySelector("#v-satin"),n=e.querySelector("#v-calculate"),i=e.querySelector("#v-add-to-cart"),m=e.querySelector("#v-result-display"),p=e.querySelector("#v-base-price"),u=e.querySelector("#v-modifiers-row"),s=e.querySelector("#v-modifiers-total"),a=e.querySelector("#v-total-price"),l=null,c=null;n.onclick=()=>{let d=e.querySelector('input[name="v-sides"]:checked'),k=d?d.value:"single";c={qty:parseInt(r.value),sides:k,satin:o.checked,express:t.expressMode};try{let f=ae(c);l=f,p.innerText=x(f.basePrice),f.modifiersTotal>0?(u.style.display="flex",s.innerText="+"+x(f.modifiersTotal)):u.style.display="none",a.innerText=x(f.totalPrice),m.style.display="block",i.disabled=!1,t.updateLastCalculated(f.totalPrice,"Vouchery")}catch(f){alert("B\u0142\u0105d: "+f.message)}},i.onclick=()=>{if(l&&c){let d=c.sides==="single"?"Jednostronne":"Dwustronne",k=c.satin?", Satyna":"",f=c.express?", EXPRESS":"";t.cart.addItem({id:`vouchery-${Date.now()}`,category:"Vouchery",name:`Vouchery A4 ${d}`,quantity:c.qty,unit:"szt",unitPrice:l.totalPrice/c.qty,isExpress:c.express,totalPrice:l.totalPrice,optionsHint:`${c.qty} szt${k}${f}`,payload:l})}}}};var ie=[{qty:1,price:20},{qty:2,price:30},{qty:3,price:32},{qty:4,price:34},{qty:5,price:35},{qty:6,price:35},{qty:7,price:36},{qty:8,price:37},{qty:9,price:39},{qty:10,price:40},{qty:15,price:45},{qty:20,price:49},{qty:30,price:58},{qty:40,price:65},{qty:50,price:75},{qty:100,price:120}];function vt(e){let t=ie[0];for(let r of ie)if(e>=r.qty)t=r;else break;return t.price}function ne(e){let t=vt(e.qty),r=0;e.isSatin&&(r+=.12),e.express&&(r+=.2);let o=t*r,n=t+o;return{basePrice:t,modifiersTotal:o,totalPrice:Math.round(n*100)/100}}var se={id:"dyplomy",name:"Dyplomy",async mount(e,t){let r=await fetch("categories/dyplomy.html");e.innerHTML=await r.text();let o=e.querySelector("#dypSides"),n=e.querySelector("#dypQty"),i=e.querySelector("#dypSatin"),m=e.querySelector("#calcBtn"),p=e.querySelector("#addToCartBtn"),u=e.querySelector("#dypResult"),s=()=>{let a={qty:parseInt(n.value)||1,sides:parseInt(o.value)||1,isSatin:i.checked,express:t.expressMode},l=ne(a);return u.style.display="block",e.querySelector("#resUnitPrice").textContent=x(l.totalPrice/a.qty),e.querySelector("#resTotalPrice").textContent=x(l.totalPrice),e.querySelector("#resDiscountHint").style.display=l.appliedModifiers.includes("bulk-discount")?"block":"none",e.querySelector("#resExpressHint").style.display=a.express?"block":"none",e.querySelector("#resSatinHint").style.display=a.isSatin?"block":"none",t.updateLastCalculated(l.totalPrice,"Dyplomy"),{options:a,result:l}};m.addEventListener("click",()=>s()),p.addEventListener("click",()=>{let{options:a,result:l}=s();t.cart.addItem({id:`dyp-${Date.now()}`,category:"Dyplomy",name:`Dyplomy DL ${a.sides===1?"1-str":"2-str"}`,quantity:a.qty,unit:"szt",unitPrice:l.totalPrice/a.qty,isExpress:a.express,totalPrice:l.totalPrice,optionsHint:`${a.qty} szt, ${a.isSatin?"Satyna":"Kreda"}`,payload:a})}),s()}};function le(e){return(Math.round((Number(e)||0)*100)/100).toFixed(2)}function U(e,t){return e.find(r=>t>=r.from&&t<=r.to)||null}function ce(e,t){let r=Object.keys(e||{}).map(Number).filter(Number.isFinite).sort((n,i)=>n-i);if(!r.length)return null;let o=r.find(n=>t<=n);return o==null?null:o}var A={print:{bw:{A4:[{from:1,to:5,unit:.9},{from:6,to:20,unit:.6},{from:21,to:100,unit:.35},{from:101,to:500,unit:.3},{from:501,to:999,unit:.23},{from:1e3,to:4999,unit:.19},{from:5e3,to:99999,unit:.15}],A3:[{from:1,to:5,unit:1.7},{from:6,to:20,unit:1.1},{from:21,to:100,unit:.7},{from:101,to:500,unit:.6},{from:501,to:999,unit:.45},{from:1e3,to:99999,unit:.33}]},color:{A4:[{from:1,to:10,unit:2.4},{from:11,to:40,unit:2.2},{from:41,to:100,unit:2},{from:101,to:250,unit:1.8},{from:251,to:500,unit:1.6},{from:501,to:999,unit:1.4},{from:1e3,to:99999,unit:1.1}],A3:[{from:1,to:10,unit:4.8},{from:11,to:40,unit:4.2},{from:41,to:100,unit:3.8},{from:101,to:250,unit:3},{from:251,to:500,unit:2.5},{from:501,to:999,unit:1.9},{from:1e3,to:99999,unit:1.6}]}},scan:{auto:[{from:1,to:9,unit:1},{from:10,to:49,unit:.5},{from:50,to:99,unit:.4},{from:100,to:999999999,unit:.25}],manual:[{from:1,to:4,unit:2},{from:5,to:999999999,unit:1}]},email_price:1},me={color:{formatowe:{A0p:26,A0:24,A1:12,A2:8.5,A3:5.3},mb:{A0p:21,A0:20,A1:14.5,A2:13.9,A3:12,R1067:30}},bw:{formatowe:{A0p:12.5,A0:11,A1:6,A2:4,A3:2.5},mb:{A0p:10,A0:9,A1:5,A2:4.5,A3:3.5,R1067:12.5}}},pe={A0p:{w:914,l:1292,label:"A0+"},A0:{w:841,l:1189,label:"A0"},A1:{w:594,l:841,label:"A1"},A2:{w:420,l:594,label:"A2"},A3:{w:297,l:420,label:"A3"},R1067:{w:1067,l:0,label:"Roll 1067"}},ue=.5,de={A0p:4,A0:3,A1:2,A2:1.5,A3:1,A3L:.7},ye=.08,Et="razdwa_prices";function fe(){try{if(typeof localStorage=="undefined")return{};let e=localStorage.getItem(Et);if(!e)return{};let t=JSON.parse(e);if(t&&typeof t=="object"&&!Array.isArray(t))return t}catch{}return{}}var B={cyfrowe:{standardPrices:{"85x55":{noLam:{50:65,100:75,150:85,200:96,250:110,300:126,400:146,500:170,1e3:290},lam:{50:160,100:170,150:180,200:190,250:200,300:220,400:240,500:250,1e3:335}},"90x50":{noLam:{50:70,100:79,150:89,200:99,250:120,300:129,400:149,500:175,1e3:300},lam:{50:170,100:180,150:190,200:200,250:210,300:230,400:250,500:260,1e3:345}}},softtouchPrices:{"85x55":{noLam:{50:65,100:75,150:85,200:96,250:110,300:126,400:145,500:170,1e3:290},lam:{50:170,100:190,150:210,200:220,250:230,300:240,400:260,500:270,1e3:380}},"90x50":{noLam:{50:70,100:79,150:89,200:99,250:120,300:129,400:149,500:175,1e3:300},lam:{50:170,100:190,150:210,200:220,250:230,300:240,400:260,500:270,1e3:390}}},deluxe:{leadTime:"4\u20135 dni roboczych",options:{uv3d_softtouch:{label:"Maker UV 3D + folia SOFTTOUCH",prices:{50:280,100:320,200:395,250:479,400:655,500:778}},uv3d_gold_softtouch:{label:"Maker UV 3D + z\u0142ocenie + folia SOFTTOUCH",prices:{50:450,100:550,200:650,250:720,400:850,500:905}}}}}};function xe(e,t){return t>5e4?`${e}+`:`${e}-${t}`}function K(e,t){let r=fe();return typeof r[e]=="number"?r[e]:t}function we(e){if(e.pages<=0)return{unitPrice:0,printTotal:0,emailTotal:e.email?A.email_price:0,inkTotal:0,grandTotal:e.email?A.email_price:0};let t=A.print[e.mode][e.format],r=U(t,e.pages);if(!r)throw new Error("Brak progu cenowego dla druku.");let o=e.mode==="bw"?"bw":"kolor",n=e.format.toLowerCase(),i=`druk-${o}-${n}-${xe(r.from,r.to)}`,m=K(i,r.unit),p=e.pages*m,u=0;e.email&&(u=A.email_price);let s=0;return e.ink25&&(s=.5*m*e.ink25Qty),{unitPrice:m,printTotal:p,emailTotal:u,inkTotal:s,grandTotal:p+u+s}}function ge(e){if(e.pages<=0)return{unitPrice:0,total:0};let t=A.scan[e.type],r=U(t,e.pages);if(!r)throw new Error("Brak progu cenowego dla skanowania.");let n=`skan-${e.type==="auto"?"auto":"reczne"}-${xe(r.from,r.to)}`,i=K(n,r.unit);return{unitPrice:i,total:e.pages*i}}function be(e){let t=pe[e.format];if(!t)throw new Error("Nieznany format CAD.");let o=Math.abs(e.lengthMm-t.l)<=ue?"formatowe":"mb",n=me[e.mode][o][e.format];if(n==null)throw new Error("Brak stawki w cenniku dla CAD.");let i=e.mode==="bw"?"bw":"kolor",m=o==="formatowe"?"fmt":"mb",p=e.format.toLowerCase().replace("0p","0plus").replace("r1067","mb1067"),u=`druk-cad-${i}-${m}-${p}`,s=K(u,n),a=0;if(o==="formatowe")a=e.qty*s;else{let l=e.lengthMm/1e3;a=e.qty*l*s}return{detectedType:o,rate:s,total:parseFloat(le(a))}}function ke(e){let t=de[e.format];if(t==null)throw new Error("Brak stawki sk\u0142adania.");return{unit:t,total:e.qty*t}}function he(e){let t=Math.round(e.lengthMm/10),r=t*ye;return{cmRounded:t,unitPrice:r,total:e.qty*r}}function Se(e){let t;e.family==="deluxe"?t=B.cyfrowe.deluxe.options[e.deluxeOpt].prices:t=(e.finish==="softtouch"?B.cyfrowe.softtouchPrices:B.cyfrowe.standardPrices)[e.size][e.lam];let r=ce(t,e.qty);if(r==null)throw new Error("Brak progu cenowego dla takiej ilo\u015Bci.");let o=t[r];return{qtyBilled:r,total:o}}function ve(e){let t=e.family||"standard",r=e.format||"85x55",o=e.folia==="none"?"noLam":"lam",n=e.finish||"mat",i=Se({family:t,size:r,lam:o,finish:n,deluxeOpt:e.deluxeOpt,qty:e.qty}),m=i.total;return e.express&&(m=i.total*1.2),{totalPrice:parseFloat(m.toFixed(2)),basePrice:i.total,effectiveQuantity:e.qty,tierPrice:i.total/i.qtyBilled,modifiersTotal:e.express?i.total*.2:0,appliedModifiers:e.express?["TRYB EXPRESS"]:[],qtyBilled:i.qtyBilled}}var Ee={id:"wizytowki-druk-cyfrowy",name:"Wizyt\xF3wki - druk cyfrowy",async mount(e,t){try{let r=await fetch("categories/wizytowki-druk-cyfrowy.html");if(!r.ok)throw new Error("Failed to load template");e.innerHTML=await r.text(),this.initLogic(e,t)}catch(r){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${r}</div>`}},initLogic(e,t){let r=e.querySelector("#w-family"),o=e.querySelector("#standard-options"),n=e.querySelector("#deluxe-options"),i=e.querySelector("#w-finish"),m=e.querySelector("#w-size"),p=e.querySelector("#w-lam"),u=e.querySelector("#w-deluxe-opt"),s=e.querySelector("#w-qty"),a=e.querySelector("#w-calculate"),l=e.querySelector("#w-add-to-cart"),c=e.querySelector("#w-result-display"),d=e.querySelector("#w-total-price"),k=e.querySelector("#w-billed-qty-hint"),f=e.querySelector("#w-express-hint");r.onchange=()=>{let g=r.value==="deluxe";o.style.display=g?"none":"block",n.style.display=g?"block":"none"};let w=null,h=null;a.onclick=()=>{h={family:r.value,finish:i.value,format:m.value,folia:p.value==="lam"?"matt_gloss":"none",deluxeOpt:u.value,qty:parseInt(s.value),express:t.expressMode};try{let g=ve(h);w=g,d.innerText=x(g.totalPrice),k.innerText=`Rozliczono za: ${g.qtyBilled} szt.`,f&&(f.style.display=t.expressMode?"block":"none"),c.style.display="block",l.disabled=!1,t.updateLastCalculated(g.totalPrice,"Wizyt\xF3wki")}catch(g){alert("B\u0142\u0105d: "+g.message)}},l.onclick=()=>{if(w&&h){let g=h.family==="deluxe"?"Wizyt\xF3wki DELUXE":"Wizyt\xF3wki Standard",y=h.express?", EXPRESS":"";t.cart.addItem({id:`wizytowki-${Date.now()}`,category:"Wizyt\xF3wki",name:g,quantity:w.qtyBilled,unit:"szt",unitPrice:w.totalPrice/w.qtyBilled,isExpress:h.express,totalPrice:w.totalPrice,optionsHint:`${h.qty} szt (rozliczono ${w.qtyBilled})${y}`,payload:w})}}}};var $={name:"Roll-up Jednostronny",formats:{"85x200":{width:.85,height:2,tiers:[{min:1,max:5,price:290},{min:6,max:10,price:275}]},"100x200":{width:1,height:2,tiers:[{min:1,max:5,price:305},{min:6,max:10,price:285}]},"120x200":{width:1.2,height:2,tiers:[{min:1,max:5,price:330},{min:6,max:10,price:310}]},"150x200":{width:1.5,height:2,tiers:[{min:1,max:5,price:440},{min:6,max:10,price:425}]}},replacement:{labor:50,print_per_m2:80}};function Te(e){let t=$.formats[e.format];if(!t)throw new Error(`Unknown format: ${e.format}`);let r;if(e.isReplacement){let i=t.width*t.height*$.replacement.print_per_m2+$.replacement.labor;r={id:"roll-up-replacement",title:`Wymiana wk\u0142adu (${e.format})`,unit:"szt",pricing:"per_unit",tiers:[{min:1,max:null,price:i}],modifiers:[{id:"express",name:"EXPRESS",type:"percent",value:.2}]}}else r={id:"roll-up-full",title:`Roll-up Komplet (${e.format})`,unit:"szt",pricing:"per_unit",tiers:t.tiers,modifiers:[{id:"express",name:"EXPRESS",type:"percent",value:.2}]};let o=[];return e.express&&o.push("express"),E(r,e.qty,o)}var Pe={id:"roll-up",name:"Roll-up",async mount(e,t){let r=await fetch("categories/roll-up.html");e.innerHTML=await r.text();let o=e.querySelector("#rollUpType"),n=e.querySelector("#rollUpFormat"),i=e.querySelector("#rollUpQty"),m=e.querySelector("#calcBtn"),p=e.querySelector("#addToCartBtn"),u=e.querySelector("#rollUpResult"),s=()=>{let a={format:n.value,qty:parseInt(i.value)||1,isReplacement:o.value==="replacement",express:t.expressMode},l=Te(a);return u.style.display="block",e.querySelector("#resUnitPrice").textContent=x(l.totalPrice/a.qty),e.querySelector("#resTotalPrice").textContent=x(l.totalPrice),e.querySelector("#resExpressHint").style.display=a.express?"block":"none",t.updateLastCalculated(l.totalPrice,"Roll-up"),{options:a,result:l}};m.addEventListener("click",()=>s()),p.addEventListener("click",()=>{let{options:a,result:l}=s();t.cart.addItem({id:`rollup-${Date.now()}`,category:"Roll-up",name:`${a.isReplacement?"Wymiana wk\u0142adu":"Roll-up Komplet"} ${a.format}`,quantity:a.qty,unit:"szt",unitPrice:l.totalPrice/a.qty,isExpress:a.express,totalPrice:l.totalPrice,optionsHint:`${a.format}, ${a.qty} szt`,payload:a})}),s()}};var F={name:"Zaproszenia KREDA - druk cyfrowy",modifiers:{satin:.12,express:.2},formats:{A6:{name:"A6 (105x148mm)",single:{normal:{"10":30,"24":40,"32":45,"50":50,"75":60,"100":68,"150":79},folded:{"10":45,"24":55,"32":60,"50":71,"75":84,"100":99,"150":126}},double:{normal:{"10":35,"24":46,"32":57,"50":66,"75":79,"100":89,"150":115},folded:{"10":58,"24":66,"32":84,"50":105,"75":125,"100":149,"150":199}}},A5:{name:"A5 (148x210mm)",single:{normal:{"10":34,"24":42,"32":48,"50":55,"75":63,"100":79,"150":110},folded:{"10":55,"24":60,"32":75,"50":95,"75":125,"100":150,"150":199}},double:{normal:{"10":40,"24":49,"32":62,"50":79,"75":96,"100":119,"150":169},folded:{"10":65,"24":80,"32":115,"50":149,"75":190,"100":235,"150":325}}},DL:{name:"DL (99x210mm)",single:{normal:{"10":35,"24":50,"32":53,"50":59,"75":70,"100":81,"150":105},folded:{"10":45,"24":55,"32":63,"50":79,"75":97,"100":115,"150":149}},double:{normal:{"10":41,"24":55,"32":64,"50":74,"75":88,"100":105,"150":135},folded:{"10":65,"24":80,"32":90,"50":115,"75":150,"100":185,"150":245}}}}};function Mt(e,t,r,o){let i=F.formats[e];if(!i)throw new Error(`Unknown format: ${e}`);let m=r===1?"single":"double",p=o?"folded":"normal",u=i[m][p],s=Object.keys(u).map(Number).sort((l,c)=>l-c),a=u[String(s[0])];for(let l of s)if(t>=l)a=u[String(l)];else break;return a}function Me(e){let t=Mt(e.format,e.qty,e.sides,e.isFolded),r=1;e.isSatin&&(r+=F.modifiers.satin),e.express&&(r+=F.modifiers.express);let o=parseFloat((t*r).toFixed(2));return{basePrice:t,totalPrice:o}}var Le={id:"zaproszenia-kreda",name:"Zaproszenia KREDA",async mount(e,t){let r=await fetch("categories/zaproszenia-kreda.html");e.innerHTML=await r.text();let o=e.querySelector("#zapFormat"),n=e.querySelector("#zapSides"),i=e.querySelector("#zapFolded"),m=e.querySelector("#zapQty"),p=e.querySelector("#zapSatin"),u=e.querySelector("#calcBtn"),s=e.querySelector("#addToCartBtn"),a=e.querySelector("#zapResult"),l=()=>{let c={format:o.value,qty:parseInt(m.value)||10,sides:parseInt(n.value)||1,isFolded:i.checked,isSatin:p.checked,express:t.expressMode},d=Me(c);return a.style.display="block",e.querySelector("#resUnitPrice").textContent=x(d.totalPrice/c.qty),e.querySelector("#resTotalPrice").textContent=x(d.totalPrice),e.querySelector("#resExpressHint").style.display=c.express?"block":"none",e.querySelector("#resSatinHint").style.display=c.isSatin?"block":"none",t.updateLastCalculated(d.totalPrice,"Zaproszenia"),{options:c,result:d}};u.addEventListener("click",()=>l()),s.addEventListener("click",()=>{let{options:c,result:d}=l();t.cart.addItem({id:`zap-${Date.now()}`,category:"Zaproszenia Kreda",name:`Zaproszenia ${c.format} ${c.sides===1?"1-str":"2-str"}${c.isFolded?" sk\u0142adane":""}`,quantity:c.qty,unit:"szt",unitPrice:d.totalPrice/c.qty,isExpress:c.express,totalPrice:d.totalPrice,optionsHint:`${c.qty} szt, ${c.isSatin?"Satyna":"Kreda"}`,payload:c})}),l()}};var qe={name:"Ulotki - Cyfrowe Dwustronne",formats:{A6:{name:"A6 (105x148)",tiers:[{min:10,max:10,price:40},{min:20,max:20,price:47},{min:30,max:30,price:49},{min:40,max:40,price:55},{min:50,max:50,price:60},{min:60,max:60,price:65},{min:70,max:70,price:70},{min:80,max:80,price:75},{min:90,max:90,price:90},{min:100,max:100,price:95},{min:150,max:150,price:120},{min:200,max:200,price:140},{min:300,max:300,price:190},{min:400,max:400,price:230},{min:500,max:500,price:270},{min:700,max:700,price:355},{min:1e3,max:1e3,price:476}]},A5:{name:"A5 (148 x 210)",tiers:[{min:10,max:10,price:45},{min:20,max:20,price:55},{min:30,max:30,price:60},{min:40,max:40,price:72},{min:50,max:50,price:90},{min:60,max:60,price:99},{min:70,max:70,price:112},{min:80,max:80,price:122},{min:90,max:90,price:130},{min:100,max:100,price:140},{min:150,max:150,price:180},{min:200,max:200,price:220},{min:300,max:300,price:310},{min:400,max:400,price:390},{min:500,max:500,price:460},{min:700,max:700,price:620},{min:1e3,max:1e3,price:790}]},DL:{name:"DL (99 x 210)",tiers:[{min:10,max:10,price:40},{min:20,max:20,price:50},{min:30,max:30,price:55},{min:40,max:40,price:65},{min:50,max:50,price:70},{min:60,max:60,price:78},{min:70,max:70,price:88},{min:80,max:80,price:99},{min:90,max:90,price:109},{min:100,max:100,price:119},{min:150,max:150,price:150},{min:200,max:200,price:179},{min:300,max:300,price:235},{min:400,max:400,price:290},{min:500,max:500,price:350},{min:700,max:700,price:460},{min:1e3,max:1e3,price:590}]}}};function qt(e){let t=qe.formats[e];if(!t)throw new Error(`Invalid format: ${e}`);return{id:`ulotki-cyfrowe-dwustronne-${e.toLowerCase()}`,title:`Ulotki Cyfrowe Dwustronne ${t.name}`,unit:"szt",pricing:"flat",tiers:t.tiers,modifiers:[{id:"express",name:"TRYB EXPRESS",type:"percent",value:.2}]}}function ze(e){let t=qt(e.format),r=[];return e.express&&r.push("express"),E(t,e.qty,r)}var Ce={name:"Ulotki \u2013 cyfrowe jednostronne",formats:{A6:{name:"A6 (105x148)",tiers:[{min:10,max:10,price:30},{min:20,max:20,price:35},{min:30,max:30,price:40},{min:40,max:40,price:45},{min:50,max:50,price:55},{min:60,max:60,price:61},{min:70,max:70,price:65},{min:80,max:80,price:70},{min:90,max:90,price:75},{min:100,max:100,price:79},{min:150,max:150,price:90},{min:200,max:200,price:110},{min:300,max:300,price:145},{min:400,max:400,price:160},{min:500,max:500,price:190},{min:700,max:700,price:255},{min:1e3,max:1e3,price:320}]},A5:{name:"A5 (148 x 210)",tiers:[{min:10,max:10,price:35},{min:20,max:20,price:42},{min:30,max:30,price:50},{min:40,max:40,price:59},{min:50,max:50,price:69},{min:60,max:60,price:75},{min:70,max:70,price:82},{min:80,max:80,price:88},{min:90,max:90,price:93},{min:100,max:100,price:95},{min:150,max:150,price:130},{min:200,max:200,price:150},{min:300,max:300,price:210},{min:400,max:400,price:259},{min:500,max:500,price:300},{min:700,max:700,price:410},{min:1e3,max:1e3,price:530}]},DL:{name:"DL (99 x 210)",tiers:[{min:10,max:10,price:30},{min:20,max:20,price:35},{min:30,max:30,price:40},{min:40,max:40,price:45},{min:50,max:50,price:55},{min:60,max:60,price:60},{min:70,max:70,price:65},{min:80,max:80,price:70},{min:90,max:90,price:75},{min:100,max:100,price:83},{min:150,max:150,price:100},{min:200,max:200,price:120},{min:300,max:300,price:160},{min:400,max:400,price:199},{min:500,max:500,price:230},{min:700,max:700,price:310},{min:1e3,max:1e3,price:399}]}}};function Ct(e){let t=Ce.formats[e];if(!t)throw new Error(`Invalid format: ${e}`);return{id:`ulotki-cyfrowe-jednostronne-${e.toLowerCase()}`,title:`Ulotki Cyfrowe Jednostronne ${t.name}`,unit:"szt",pricing:"flat",tiers:t.tiers,modifiers:[{id:"express",name:"TRYB EXPRESS",type:"percent",value:.2}]}}function He(e){let t=Ct(e.format),r=[];return e.express&&r.push("express"),E(t,e.qty,r)}var Ae={id:"ulotki-cyfrowe",name:"Ulotki cyfrowe",async mount(e,t){try{let r=await fetch("categories/ulotki-cyfrowe.html");if(!r.ok)throw new Error("Failed to load template");e.innerHTML=await r.text(),this.initLogic(e,t)}catch(r){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${r}</div>`}},initLogic(e,t){let r=e.querySelector("#u-format"),o=e.querySelector("#u-qty"),n=e.querySelector("#u-calculate"),i=e.querySelector("#u-add-to-cart"),m=e.querySelector("#u-result-display"),p=e.querySelector("#u-total-price"),u=e.querySelector("#u-express-hint"),s=null,a=null;n.onclick=()=>{let l=e.querySelector('input[name="sides"]:checked').value;a={format:r.value,qty:parseInt(o.value),express:t.expressMode,sides:l};try{let c=l==="dwustronne"?ze(a):He(a);s=c,p.innerText=x(c.totalPrice),u&&(u.style.display=t.expressMode?"block":"none"),m.style.display="block",i.disabled=!1,t.updateLastCalculated(c.totalPrice,"Ulotki")}catch(c){alert("B\u0142\u0105d: "+c.message)}},i.onclick=()=>{if(s&&a){let l=a.express?", EXPRESS":"",c=a.sides==="dwustronne"?"Dwustronne":"Jednostronne";t.cart.addItem({id:`ulotki-${Date.now()}`,category:"Ulotki",name:`Ulotki ${c} ${a.format}`,quantity:a.qty,unit:"szt",unitPrice:s.totalPrice/a.qty,isExpress:a.express,totalPrice:s.totalPrice,optionsHint:`${a.qty} szt, ${c}${l}`,payload:s})}}}};var Ie={id:"banner",title:"Bannery",unit:"m2",pricing:"per_unit",materials:[{id:"powlekany",name:"Banner powlekany",tiers:[{min:1,max:25,price:53},{min:26,max:50,price:49},{min:51,max:null,price:45}]},{id:"blockout",name:"Banner Blockout",tiers:[{min:1,max:25,price:64},{min:26,max:50,price:59},{min:51,max:null,price:55}]}],modifiers:[{id:"oczkowanie",name:"Oczkowanie (+2.50 z\u0142/m2)",type:"fixed_per_unit",value:2.5},{id:"express",name:"TRYB EXPRESS (+20%)",type:"percent",value:.2}]};function De(e){let t=Ie,r=t.materials.find(i=>i.id===e.material);if(!r)throw new Error(`Unknown material: ${e.material}`);let o={id:t.id,title:t.title,unit:t.unit,pricing:t.pricing,tiers:r.tiers,modifiers:t.modifiers},n=[];return e.oczkowanie&&n.push("oczkowanie"),e.express&&n.push("express"),E(o,e.areaM2,n)}var Re={id:"banner",name:"Bannery",async mount(e,t){try{let r=await fetch("categories/banner.html");if(!r.ok)throw new Error("Failed to load template");e.innerHTML=await r.text(),this.initLogic(e,t)}catch(r){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${r}</div>`}},initLogic(e,t){let r=e.querySelector("#b-material"),o=e.querySelector("#b-area"),n=e.querySelector("#b-oczkowanie"),i=e.querySelector("#b-calculate"),m=e.querySelector("#b-add-to-cart"),p=e.querySelector("#b-result-display"),u=e.querySelector("#b-unit-price"),s=e.querySelector("#b-total-price"),a=e.querySelector("#b-express-hint"),l=null,c=null;i.onclick=()=>{c={material:r.value,areaM2:parseFloat(o.value),oczkowanie:n.checked,express:t.expressMode};try{let d=De(c);l=d,u.innerText=x(d.tierPrice),s.innerText=x(d.totalPrice),a&&(a.style.display=t.expressMode?"block":"none"),p.style.display="block",m.disabled=!1,t.updateLastCalculated(d.totalPrice,"Banner")}catch(d){alert("B\u0142\u0105d: "+d.message)}},m.onclick=()=>{if(l&&c){let d=r.options[r.selectedIndex].text,k=[`${c.areaM2} m2`,c.oczkowanie?"z oczkowaniem":"bez oczkowania",c.express?"EXPRESS":""].filter(Boolean).join(", ");t.cart.addItem({id:`banner-${Date.now()}`,category:"Bannery",name:d,quantity:c.areaM2,unit:"m2",unitPrice:l.tierPrice,isExpress:c.express,totalPrice:l.totalPrice,optionsHint:k,payload:l})}}}};var D={};j(D,{category:()=>At,default:()=>Rt,groups:()=>It,modifiers:()=>Dt});var At="Wlepki / Naklejki",It=[{id:"wlepki_obrys_folia",title:"Wlepki po obrysie (Folia Bia\u0142a/Trans)",unit:"m2",pricing:"per_unit",tiers:[{min:1,max:5,price:67},{min:6,max:25,price:60},{min:26,max:50,price:52},{min:51,max:null,price:48}],rules:[{type:"minimum",unit:"m2",value:1}]},{id:"wlepki_polipropylen",title:"Wlepki po obrysie - Polipropylen",unit:"m2",pricing:"per_unit",tiers:[{min:1,max:10,price:50},{min:11,max:null,price:42}],rules:[{type:"minimum",unit:"m2",value:1}]},{id:"wlepki_standard_folia",title:"Folia Bia\u0142a / Transparentna (standard)",unit:"m2",pricing:"per_unit",tiers:[{min:1,max:5,price:54},{min:6,max:25,price:50},{min:26,max:50,price:46},{min:51,max:null,price:42}],rules:[{type:"minimum",unit:"m2",value:1}]}],Dt=[{id:"mocny_klej",name:"Mocny klej",type:"percent",value:.12},{id:"arkusze",name:"Ci\u0119te na arkusze",type:"fixed_per_unit",value:2},{id:"pojedyncze",name:"Ci\u0119te na pojedyncze sztuki",type:"fixed_per_unit",value:10},{id:"express",name:"EXPRESS",type:"percent",value:.2}],Rt={category:At,groups:It,modifiers:Dt};function Be(e){let t=D,r=t.groups.find(i=>i.id===e.groupId);if(!r)throw new Error(`Unknown group: ${e.groupId}`);let o={id:"wlepki",title:r.title,unit:r.unit,pricing:r.pricing||"per_unit",tiers:r.tiers,modifiers:t.modifiers,rules:r.rules||[{type:"minimum",unit:"m2",value:1}]},n=[...e.modifiers];return e.express&&n.push("express"),E(o,e.area,n)}var $e={id:"wlepki-naklejki",name:"Wlepki / Naklejki",async mount(e,t){let r=D;try{let d=await fetch("categories/wlepki-naklejki.html");if(!d.ok)throw new Error("Failed to load template");e.innerHTML=await d.text()}catch(d){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania szablonu: ${d}</div>`;return}let o=e.querySelector("#wlepki-group"),n=e.querySelector("#wlepki-area"),i=e.querySelector("#btn-calculate"),m=e.querySelector("#btn-add-to-cart"),p=e.querySelector("#wlepki-result"),u=e.querySelector("#unit-price"),s=e.querySelector("#total-price"),a=null,l=null,c=()=>{let d=e.querySelectorAll(".wlepki-mod:checked"),k=Array.from(d).map(f=>f.value);l={groupId:o.value,area:parseFloat(n.value)||0,express:t.expressMode,modifiers:k};try{let f=Be(l);a=f,u.textContent=x(f.tierPrice),s.textContent=x(f.totalPrice),p.style.display="block",m.disabled=!1,t.updateLastCalculated(f.totalPrice,"Wlepki")}catch(f){alert("B\u0142\u0105d: "+f.message)}};i.addEventListener("click",c),m.addEventListener("click",()=>{if(!a||!l)return;let d=r.groups.find(f=>f.id===l.groupId),k=l.modifiers.map(f=>{let w=r.modifiers.find(h=>h.id===f);return w?w.name:f});l.express&&k.unshift("EXPRESS (+20%)"),t.cart.addItem({id:`wlepki-${Date.now()}`,category:"Wlepki / Naklejki",name:(d==null?void 0:d.title)||"Wlepki",quantity:l.area,unit:"m2",unitPrice:a.tierPrice,isExpress:!!l.express,totalPrice:a.totalPrice,optionsHint:k.join(", ")||"Standard",payload:a})})}};function Fe(e,t){let r=e.format.toUpperCase(),o=we({mode:e.mode,format:r,pages:e.printQty,email:e.email,ink25:e.surcharge,ink25Qty:e.surchargeQty}),n={total:0,unitPrice:0};e.scanType!=="none"&&e.scanQty>0&&(n=ge({type:e.scanType,pages:e.scanQty}));let i=o.grandTotal+n.total,m=i;return e.express&&(m=i*1.2),{totalPrice:parseFloat(m.toFixed(2)),unitPrintPrice:o.unitPrice,totalPrintPrice:o.printTotal,unitScanPrice:n.unitPrice,totalScanPrice:n.total,emailPrice:o.emailTotal,surchargePrice:o.inkTotal,baseTotal:i}}var L=[{id:"druk-a4-a3-skan",name:"Druk A4/A3 + skan",icon:"\u{1F5A8}\uFE0F",implemented:!0,pricing:{print_bw:[{min:1,max:5,a4:.9,a3:1.7},{min:6,max:20,a4:.6,a3:1.1},{min:21,max:100,a4:.35,a3:.7},{min:101,max:500,a4:.3,a3:.6},{min:501,max:999,a4:.23,a3:.45},{min:1e3,max:4999,a4:.19,a3:.33},{min:5e3,max:null,a4:.15,a3:.3}],print_color:[{min:1,max:10,a4:2.4,a3:4.8},{min:11,max:40,a4:2.2,a3:4.2},{min:41,max:100,a4:2,a3:3.8},{min:101,max:250,a4:1.8,a3:3},{min:251,max:500,a4:1.6,a3:2.5},{min:501,max:999,a4:1.4,a3:1.9},{min:1e3,max:null,a4:1.1,a3:1.6}],scan_auto:[{min:1,max:9,price:1},{min:10,max:49,price:.5},{min:50,max:99,price:.4},{min:100,max:null,price:.25}],scan_manual:[{min:1,max:4,price:2},{min:5,max:null,price:1}],email_cost:1,surcharge_factor:.5}},{id:"druk-cad",name:"Druk CAD wielkoformatowy",icon:"\u{1F4D0}",implemented:!0,format_prices:{bw:{A0p:{length:1292,price:12.5},A0:{length:1189,price:11},A1:{length:841,price:6},A2:{length:594,price:4},A3:{length:420,price:2.5}},color:{A0p:{length:1292,price:26},A0:{length:1189,price:24},A1:{length:841,price:12},A2:{length:594,price:8.5},A3:{length:420,price:5.3}}},meter_prices:{bw:{A0p:10,A0:9,A1:5,A2:4.5,A3:3.5},color:{A0p:21,A0:20,A1:14.5,A2:13.9,A3:12}}},{id:"laminowanie",name:"Laminowanie",icon:"\u2728",implemented:!0},{id:"plakaty",name:"Plakaty",icon:"\u{1F5BC}\uFE0F",implemented:!0},{id:"solwent-plakaty",name:"Solwent - Plakaty",icon:"\u{1F5BC}\uFE0F",implemented:!0},{id:"vouchery",name:"Vouchery",icon:"\u{1F39F}\uFE0F",implemented:!0},{id:"dyplomy",name:"Dyplomy",icon:"\u{1F4DC}",implemented:!0},{id:"wizytowki-druk-cyfrowy",name:"Wizyt\xF3wki - druk cyfrowy",icon:"\u{1F4C7}",implemented:!0},{id:"zaproszenia-kreda",name:"Zaproszenia KREDA",icon:"\u2709\uFE0F",implemented:!0},{id:"ulotki-cyfrowe",name:"Ulotki cyfrowe",icon:"\u{1F4C4}",implemented:!0},{id:"banner",name:"Bannery",icon:"\u{1F3C1}",implemented:!0},{id:"wlepki-naklejki",name:"Wlepki / Naklejki",icon:"\u{1F3F7}\uFE0F",implemented:!0},{id:"roll-up",name:"Roll-up",icon:"\u2195\uFE0F",implemented:!0},{id:"folia-szroniona",name:"Folia szroniona",icon:"\u2744\uFE0F",implemented:!0},{id:"cad-ops",name:"CAD OPS",icon:"\u{1F6E0}\uFE0F",implemented:!0},{id:"upload-kalkulator",name:"Upload Kalkulator CAD",icon:"\u{1F4D0}",implemented:!0},{id:"ustawienia",name:"Ustawienia cen",icon:"\u2699\uFE0F",implemented:!0}];var Oe={id:"druk-a4-a3-skan",name:"Druk A4/A3 + skan",async mount(e,t){try{let r=await fetch("categories/druk-a4-a3-skan.html");if(!r.ok)throw new Error("Failed to load template");e.innerHTML=await r.text(),this.initLogic(e,t)}catch(r){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${r}</div>`}},initLogic(e,t){var T;let r=(T=L.find(b=>b.id==="druk-a4-a3-skan"))==null?void 0:T.pricing;if(!r)return;let o=e.querySelector("#d-mode"),n=e.querySelector("#d-format"),i=e.querySelector("#d-print-qty"),m=e.querySelector("#d-email"),p=e.querySelector("#d-surcharge"),u=e.querySelector("#d-surcharge-qty"),s=e.querySelector("#surcharge-qty-row"),a=e.querySelector("#d-scan-type"),l=e.querySelector("#d-scan-qty"),c=e.querySelector("#scan-qty-row"),d=e.querySelector("#d-calculate"),k=e.querySelector("#d-add-to-cart"),f=e.querySelector("#d-result-display"),w=e.querySelector("#d-total-price"),h=e.querySelector("#d-express-hint");p.onchange=()=>{s.style.display=p.checked?"flex":"none"},a.onchange=()=>{c.style.display=a.value!=="none"?"flex":"none"};let g=null,y=null;d.onclick=()=>{y={mode:o.value,format:n.value,printQty:parseInt(i.value)||0,email:m.checked,surcharge:p.checked,surchargeQty:parseInt(u.value)||0,scanType:a.value,scanQty:parseInt(l.value)||0,express:t.expressMode};try{let b=Fe(y,r);g=b,w.innerText=x(b.totalPrice),h&&(h.style.display=t.expressMode?"block":"none"),f.style.display="block",k.disabled=!1,t.updateLastCalculated(b.totalPrice,"Druk A4/A3 + skan")}catch(b){alert("B\u0142\u0105d: "+b.message)}},k.onclick=()=>{if(g&&y){let b=Date.now(),v=t.expressMode?1.2:1;if(y.printQty>0||y.scanQty>0&&y.scanType!=="none"){let S=[];y.printQty>0&&S.push(`${y.printQty} str. ${y.format.toUpperCase()} (${y.mode==="bw"?"CZ-B":"KOLOR"})`),y.scanQty>0&&y.scanType!=="none"&&S.push(`Skan ${y.scanType}: ${y.scanQty} str.`),t.expressMode&&S.push("EXPRESS");let P=(g.totalPrintPrice+g.totalScanPrice)*v;t.cart.addItem({id:`druk-${b}-main`,category:"Druk A4/A3 + skan",name:`${y.format.toUpperCase()} ${y.mode==="bw"?"CZ-B":"KOLOR"}`,quantity:y.printQty||y.scanQty,unit:y.printQty>0?"str.":"skan",unitPrice:P/(y.printQty||y.scanQty),isExpress:t.expressMode,totalPrice:parseFloat(P.toFixed(2)),optionsHint:S.join(", "),payload:{...g,type:"main"}})}if(y.email){let S=g.emailPrice*v;t.cart.addItem({id:`email-${b}-email`,category:"Druk A4/A3 + skan",name:"Wysy\u0142ka e-mail",quantity:1,unit:"szt.",unitPrice:S,isExpress:t.expressMode,totalPrice:parseFloat(S.toFixed(2)),optionsHint:t.expressMode?"EXPRESS":"",payload:{price:S,type:"email"}})}if(y.surcharge&&y.surchargeQty>0){let S=g.surchargePrice*v;t.cart.addItem({id:`surcharge-${b}-surcharge`,category:"Druk A4/A3 + skan",name:"Zadruk >25% - dop\u0142ata",quantity:y.surchargeQty,unit:"str.",unitPrice:S/y.surchargeQty,isExpress:t.expressMode,totalPrice:parseFloat(S.toFixed(2)),optionsHint:`${y.surchargeQty} str. (+50%), ${t.expressMode?"EXPRESS":""}`,payload:{price:S,type:"surcharge"}})}}}}};function Ve(e,t){let r=be({mode:e.mode,format:e.format,lengthMm:e.lengthMm,qty:e.qty||1}),o=r.total;return e.express&&(o=r.total*1.2),{totalPrice:parseFloat(o.toFixed(2)),basePrice:r.total,detectedType:r.detectedType,isMeter:r.detectedType==="mb",rate:r.rate}}var _e={id:"druk-cad",name:"Druk CAD wielkoformatowy",async mount(e,t){try{let r=await fetch("categories/druk-cad.html");if(!r.ok)throw new Error("Failed to load template");e.innerHTML=await r.text(),this.initLogic(e,t)}catch(r){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${r}</div>`}},initLogic(e,t){let r=L.find(y=>y.id==="druk-cad");if(!r)return;let o=e.querySelector("#cad-mode"),n=e.querySelector("#cad-format"),i=e.querySelector("#cad-length"),m=e.querySelector("#qty-sheets"),p=e.querySelector("#qty-sheets-group"),u=e.querySelector("#cad-use-base"),s=e.querySelector("#cad-base-info"),a=e.querySelector("#cad-calculate"),l=e.querySelector("#cad-add-to-cart"),c=e.querySelector("#cad-result-display"),d=e.querySelector("#cad-price-type"),k=e.querySelector("#cad-total-price"),f=e.querySelector("#cad-express-hint"),w=()=>{let y=n.value,T=o.value,b=r.format_prices[T][y].length;s.innerText=`Wymiar bazowy: ${b} mm`;let v=parseInt(i.value)||0,S=Math.abs(v-b)<=.5;return p.style.display=S?"grid":"none",b};n.onchange=w,o.onchange=w,i.oninput=w,u.onclick=()=>{i.value=w().toString(),w()},w();let h=null,g=null;a.onclick=()=>{g={mode:o.value,format:n.value,lengthMm:parseInt(i.value)||0,qty:parseInt(m.value)||1,express:t.expressMode};try{let y=Ve(g,r);h=y,d.innerText=y.isMeter?"Cena metrowa:":"Cena formatowa:",k.innerText=x(y.totalPrice),f&&(f.style.display=t.expressMode?"block":"none"),c.style.display="block",l.disabled=!1,t.updateLastCalculated(y.totalPrice,"Druk CAD")}catch(y){alert("B\u0142\u0105d: "+y.message)}},l.onclick=()=>{if(h&&g){let y=h.isMeter?"":`${g.qty} szt, `,T=[`${g.format} (${g.mode==="bw"?"CZ-B":"KOLOR"})`,`${y}${g.lengthMm} mm`,t.expressMode?"EXPRESS":""].filter(Boolean).join(", ");t.cart.addItem({id:`cad-${Date.now()}`,category:"Druk CAD wielkoformatowy",name:`${g.format} ${g.mode==="bw"?"CZ-B":"KOLOR"}`,quantity:g.lengthMm,unit:"mm",unitPrice:h.basePrice/g.lengthMm,isExpress:t.expressMode,totalPrice:h.totalPrice,optionsHint:T,payload:h})}}}};var Ne={formats:{A3:[{min:1,max:50,price:7},{min:51,max:100,price:6},{min:101,max:200,price:5}],A4:[{min:1,max:50,price:5},{min:51,max:100,price:4.5},{min:101,max:200,price:4}],A5:[{min:1,max:50,price:4},{min:51,max:100,price:3.5},{min:101,max:200,price:3}],A6:[{min:1,max:50,price:3},{min:51,max:100,price:2.5},{min:101,max:200,price:2}]}};function Ft(e){let t=Ne.formats[e];if(!t)throw new Error(`Invalid format: ${e}`);return{id:`laminowanie-${e.toLowerCase()}`,title:`Laminowanie ${e}`,unit:"szt",pricing:"per_unit",tiers:t,modifiers:[{id:"express",name:"TRYB EXPRESS",type:"percent",value:.2}]}}function je(e){let t=Ft(e.format),r=[];return e.express&&r.push("express"),E(t,e.qty,r)}var Ue={id:"laminowanie",name:"Laminowanie",async mount(e,t){try{let r=await fetch("categories/laminowanie.html");if(!r.ok)throw new Error("Failed to load template");e.innerHTML=await r.text(),this.initLogic(e,t)}catch(r){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${r}</div>`}},initLogic(e,t){let r=e.querySelector("#lam-format"),o=e.querySelector("#lam-qty"),n=e.querySelector("#lam-calculate"),i=e.querySelector("#lam-add-to-cart"),m=e.querySelector("#lam-result-display"),p=e.querySelector("#lam-total-price"),u=e.querySelector("#lam-express-hint"),s=null,a=null,l=()=>{let c=parseInt(o.value);if(!(isNaN(c)||c<=0)){a={format:r.value,qty:c,express:t.expressMode};try{let d=je(a);s=d,p.innerText=x(d.totalPrice),u&&(u.style.display=t.expressMode?"block":"none"),m.style.display="block",i.disabled=!1,t.updateLastCalculated(d.totalPrice,"Laminowanie")}catch(d){console.error(d)}}};n.onclick=l,i.onclick=()=>{if(s&&a){let c=a.express?", EXPRESS":"";t.cart.addItem({id:`laminowanie-${Date.now()}`,category:"Laminowanie",name:`Laminowanie ${a.format}`,quantity:a.qty,unit:"szt",unitPrice:s.totalPrice/a.qty,isExpress:a.express,totalPrice:s.totalPrice,optionsHint:`${a.qty} szt, Format ${a.format}${c}`,payload:s})}},[r,o].forEach(c=>{c.addEventListener("change",l)}),o.addEventListener("input",l)}};var Ke={id:"folia-szroniona",title:"Folia szroniona",unit:"m2",pricing:"per_unit",rules:[{type:"minimum",unit:"m2",value:1}],materials:[{id:"material-only",name:"Tylko wydruk",tiers:[{min:1,max:5,price:65},{min:6,max:25,price:60},{min:26,max:50,price:56},{min:51,max:null,price:51}]},{id:"full-service",name:"Wydruk z oklejaniem",tiers:[{min:1,max:5,price:140},{min:6,max:10,price:130},{min:11,max:20,price:120},{min:21,max:null,price:0}]}],modifiers:[{id:"express",name:"EXPRESS (+20%)",type:"percent",value:.2}]};function We(e){let t=Ke,r=t.materials.find(u=>u.id===e.serviceId);if(!r)throw new Error(`Unknown service: ${e.serviceId}`);let o=e.widthMm*e.heightMm/1e6,n={id:t.id,title:t.title,unit:t.unit,pricing:t.pricing,rules:t.rules,tiers:r.tiers,modifiers:t.modifiers},i=[];e.express&&i.push("express");let m=E(n,o,i),p=e.serviceId==="full-service"&&o>20;return{...m,isCustom:p}}var Qe={id:"folia-szroniona",name:"Folia szroniona",async mount(e,t){try{let r=await fetch("categories/folia-szroniona.html");if(!r.ok)throw new Error("Failed to load template");e.innerHTML=await r.text(),this.initLogic(e,t)}catch(r){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${r}</div>`}},initLogic(e,t){let r=e.querySelector("#fs-service"),o=e.querySelector("#fs-width"),n=e.querySelector("#fs-height"),i=e.querySelector("#fs-calculate"),m=e.querySelector("#fs-add-to-cart"),p=e.querySelector("#fs-result-display"),u=e.querySelector("#fs-normal-result"),s=e.querySelector("#fs-custom-quote"),a=e.querySelector("#fs-area-val"),l=e.querySelector("#fs-unit-price"),c=e.querySelector("#fs-total-price"),d=e.querySelector("#fs-express-hint"),k=null,f=null;i.onclick=()=>{f={serviceId:r.value,widthMm:parseInt(o.value)||0,heightMm:parseInt(n.value)||0,express:t.expressMode};try{let w=We(f);if(k=w,w.isCustom)u.style.display="none",s.style.display="block",m.disabled=!0,t.updateLastCalculated(0,"Folia szroniona (wycena ind.)");else{u.style.display="block",s.style.display="none";let h=f.widthMm*f.heightMm/1e6;a.innerText=`${h.toFixed(2)} m2${w.effectiveQuantity>h?" (min. 1m2)":""}`,l.innerText=x(w.tierPrice),c.innerText=x(w.totalPrice),m.disabled=!1,t.updateLastCalculated(w.totalPrice,"Folia szroniona")}d&&(d.style.display=t.expressMode?"block":"none"),p.style.display="block"}catch(w){alert("B\u0142\u0105d: "+w.message)}},m.onclick=()=>{if(k&&f){let w=r.options[r.selectedIndex].text,h=f.widthMm*f.heightMm/1e6,g=[`${f.widthMm}x${f.heightMm} mm`,`${h.toFixed(2)} m2`,t.expressMode?"EXPRESS":""].filter(Boolean).join(", ");t.cart.addItem({id:`fs-${Date.now()}`,category:"Folia szroniona",name:w,quantity:h,unit:"m2",unitPrice:k.tierPrice,isExpress:t.expressMode,totalPrice:k.totalPrice,optionsHint:g,payload:k})}}}};function Xe(e){return ke(e)}function Ze(e){return he(e)}var Je={id:"cad-ops",name:"CAD: sk\u0142adanie / skan",async mount(e,t){try{let r=await fetch("categories/cad-ops.html");if(!r.ok)throw new Error("Failed to load template");e.innerHTML=await r.text(),this.initLogic(e,t)}catch(r){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${r}</div>`}},initLogic(e,t){let r=e.querySelector("#fold-format"),o=e.querySelector("#fold-qty"),n=e.querySelector("#fold-add");n.onclick=()=>{let u=parseInt(o.value);if(!(isNaN(u)||u<=0))try{let s=Xe({format:r.value,qty:u}),a=r.value==="A0p"?"A0+":r.value==="A3L"?"A3-poprzeczne":r.value;t.cart.addItem({id:`cad-fold-${Date.now()}`,category:"CAD",name:`Sk\u0142adanie (${a})`,quantity:u,unit:"szt",unitPrice:s.unit,totalPrice:s.total,optionsHint:`${u} szt.`,payload:s}),t.updateLastCalculated(s.total,"Sk\u0142adanie CAD")}catch(s){alert(s.message)}};let i=e.querySelector("#wf-scan-mm"),m=e.querySelector("#wf-scan-qty"),p=e.querySelector("#wf-scan-add");p.onclick=()=>{let u=parseInt(i.value),s=parseInt(m.value);if(!(isNaN(u)||u<=0||isNaN(s)||s<=0))try{let a=Ze({lengthMm:u,qty:s});t.cart.addItem({id:`cad-wf-scan-${Date.now()}`,category:"CAD",name:"Skanowanie wielkoformatowe",quantity:s,unit:"szt",unitPrice:a.unitPrice,totalPrice:a.total,optionsHint:`${s} szt, ${u} mm`,payload:a}),t.updateLastCalculated(a.total,"Skanowanie WF")}catch(a){alert(a.message)}}}};var V="razdwa_prices",et={"druk-bw-a4-1-5":.9,"druk-bw-a4-6-20":.6,"druk-bw-a4-21-100":.35,"druk-bw-a4-101-500":.3,"druk-bw-a4-501-999":.23,"druk-bw-a4-1000-4999":.19,"druk-bw-a4-5000+":.15,"druk-bw-a3-1-5":1.7,"druk-bw-a3-6-20":1.1,"druk-bw-a3-21-100":.7,"druk-bw-a3-101-500":.6,"druk-bw-a3-501-999":.45,"druk-bw-a3-1000-4999":.33,"druk-bw-a3-5000+":.3,"druk-kolor-a4-1-10":2.4,"druk-kolor-a4-11-40":2.2,"druk-kolor-a4-41-100":2,"druk-kolor-a4-101-250":1.8,"druk-kolor-a4-251-500":1.6,"druk-kolor-a4-501-999":1.4,"druk-kolor-a4-1000+":1.1,"druk-kolor-a3-1-10":4.8,"druk-kolor-a3-11-40":4.2,"druk-kolor-a3-41-100":3.8,"druk-kolor-a3-101-250":3,"druk-kolor-a3-251-500":2.5,"druk-kolor-a3-501-999":1.9,"druk-kolor-a3-1000+":1.6,"skan-auto-1-9":1,"skan-auto-10-49":.5,"skan-auto-50-99":.4,"skan-auto-100+":.25,"skan-reczne-1-4":2,"skan-reczne-5+":1,"druk-email":1,"modifier-druk-zadruk25":.5,"druk-cad-kolor-fmt-a3":5.3,"druk-cad-kolor-fmt-a2":8.5,"druk-cad-kolor-fmt-a1":12,"druk-cad-kolor-fmt-a0":24,"druk-cad-kolor-fmt-a0plus":26,"druk-cad-kolor-mb-a3":12,"druk-cad-kolor-mb-a2":13.9,"druk-cad-kolor-mb-a1":14.5,"druk-cad-kolor-mb-a0":20,"druk-cad-kolor-mb-a0plus":21,"druk-cad-kolor-mb-mb1067":30,"druk-cad-bw-fmt-a3":2.5,"druk-cad-bw-fmt-a2":4,"druk-cad-bw-fmt-a1":6,"druk-cad-bw-fmt-a0":11,"druk-cad-bw-fmt-a0plus":12.5,"druk-cad-bw-mb-a3":3.5,"druk-cad-bw-mb-a2":4.5,"druk-cad-bw-mb-a1":5,"druk-cad-bw-mb-a0":9,"druk-cad-bw-mb-a0plus":10,"druk-cad-bw-mb-mb1067":12.5,"laminowanie-a3-1-50":7,"laminowanie-a3-51-100":6,"laminowanie-a3-101-200":5,"laminowanie-a4-1-50":5,"laminowanie-a4-51-100":4.5,"laminowanie-a4-101-200":4,"laminowanie-a5-1-50":4,"laminowanie-a5-51-100":3.5,"laminowanie-a5-101-200":3,"laminowanie-a6-1-50":3,"laminowanie-a6-51-100":2.5,"laminowanie-a6-101-200":2,"solwent-150g-1-3":65,"solwent-150g-4-9":60,"solwent-150g-10-20":55,"solwent-150g-21-40":50,"solwent-150g-41+":42,"solwent-200g-1-3":70,"solwent-200g-4-9":65,"solwent-200g-10-20":59,"solwent-200g-21-40":53,"solwent-200g-41+":45,"vouchery-a4-base":2.5,"banner-powlekany-1-25":53,"banner-powlekany-26-50":49,"banner-powlekany-51+":45,"banner-blockout-1-25":64,"banner-blockout-26-50":59,"banner-blockout-51+":55,"banner-oczkowanie":2.5,"rollup-85x200-1-5":290,"rollup-85x200-6-10":275,"rollup-100x200-1-5":305,"rollup-100x200-6-10":285,"rollup-120x200-1-5":330,"rollup-120x200-6-10":310,"rollup-150x200-1-5":440,"rollup-150x200-6-10":425,"rollup-wymiana-labor":50,"rollup-wymiana-m2":80,"folia-szroniona-wydruk-1-5":65,"folia-szroniona-wydruk-6-25":60,"folia-szroniona-wydruk-26-50":56,"folia-szroniona-wydruk-51+":51,"folia-szroniona-oklejanie-1-5":140,"folia-szroniona-oklejanie-6-10":130,"folia-szroniona-oklejanie-11-20":120,"wlepki-obrys-folia-1-5":67,"wlepki-obrys-folia-6-25":60,"wlepki-obrys-folia-26-50":52,"wlepki-obrys-folia-51+":48,"wlepki-polipropylen-1-10":50,"wlepki-polipropylen-11+":42,"wlepki-standard-folia-1-5":54,"wlepki-standard-folia-6-25":50,"wlepki-standard-folia-26-50":46,"wlepki-standard-folia-51+":42,"wlepki-modifier-arkusze":2,"wlepki-modifier-pojedyncze":10,"wlepki-modifier-mocny-klej":.12,"wizytowki-85x55-none-50szt":65,"wizytowki-85x55-none-100szt":75,"wizytowki-85x55-none-250szt":110,"wizytowki-85x55-none-500szt":170,"wizytowki-85x55-none-1000szt":290,"wizytowki-85x55-matt_gloss-50szt":160,"wizytowki-85x55-matt_gloss-100szt":170,"wizytowki-85x55-matt_gloss-250szt":200,"wizytowki-85x55-matt_gloss-500szt":250,"wizytowki-85x55-matt_gloss-1000szt":335,"wizytowki-90x50-none-50szt":70,"wizytowki-90x50-none-100szt":79,"wizytowki-90x50-none-250szt":120,"wizytowki-90x50-none-500szt":175,"wizytowki-90x50-none-1000szt":300,"wizytowki-90x50-matt_gloss-50szt":170,"wizytowki-90x50-matt_gloss-100szt":180,"wizytowki-90x50-matt_gloss-250szt":210,"wizytowki-90x50-matt_gloss-500szt":260,"wizytowki-90x50-matt_gloss-1000szt":345,"modifier-satyna":.12,"modifier-express":.2,"modifier-express-vouchery":.3,"modifier-vouchery-dwustronne":.8,"modifier-vouchery-300g":.25},q=null;function Ye(){try{let e=localStorage.getItem(V);if(e){let t=JSON.parse(e);if(t&&typeof t=="object"&&!Array.isArray(t)){let r={};for(let[o,n]of Object.entries(t))o&&typeof n=="number"&&isFinite(n)&&(r[o]=n);if(Object.keys(r).length>0)return r}}}catch{}return{...et}}function Ge(e){localStorage.setItem(V,JSON.stringify(e))}var tt={id:"ustawienia",name:"Ustawienia cen",mount(e,t){q&&(q(),q=null);let r=Ye();function o(){var p,u,s;let i=Object.keys(r).sort(),m=i.map(a=>`
        <tr data-key="${W(a)}" style="border-bottom: 1px solid rgba(255,255,255,0.08);">
          <td style="padding:4px 8px;">
            <input data-field="key" value="${W(a)}"
              style="background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.15);border-radius:4px;color:inherit;padding:4px 6px;width:100%;font-size:12px;font-family:monospace;">
          </td>
          <td style="padding:4px 8px;">
            <input data-field="unitPrice" type="number" step="0.01" min="0" value="${Number(r[a]).toFixed(2)}"
              style="background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.15);border-radius:4px;color:inherit;padding:4px 6px;width:90px;font-size:13px;text-align:right;">
          </td>
          <td style="padding:4px; text-align:center;">
            <button data-action="delete" data-key="${W(a)}"
              style="background:rgba(220,50,50,0.7);border:none;border-radius:4px;color:#fff;cursor:pointer;padding:3px 8px;font-size:13px;">\u2715</button>
          </td>
        </tr>
      `).join("");e.innerHTML=`
        <div style="padding: 20px;">
          <h2 style="margin: 0 0 8px; font-size: 20px;">\u2699\uFE0F Ustawienia \u2013 Cennik</h2>
          <p style="margin: 0 0 16px; font-size: 13px; color: rgba(255,255,255,0.6);">
            Ceny wszystkich zakres\xF3w/produkt\xF3w zapisywane w przegl\u0105darce (<code>razdwa_prices</code>).
            Klucz: <code>kategoria-zakres</code> (np. <code>druk-bw-a4-1-5</code>). \u0141\u0105cznie: <strong>${i.length}</strong> pozycji.
          </p>

          <table id="prices-table" style="width:100%; border-collapse:collapse; font-size:14px; margin-bottom:16px;">
            <thead>
              <tr style="border-bottom: 1px solid rgba(255,255,255,0.2);">
                <th style="text-align:left; padding:6px 8px;">Klucz (kategoria-zakres)</th>
                <th style="text-align:right; padding:6px 8px; width:120px;">Cena jedn. (z\u0142)</th>
                <th style="padding:4px; width:60px;"></th>
              </tr>
            </thead>
            <tbody>
              ${m}
            </tbody>
          </table>

          <div style="display:flex; gap:8px; flex-wrap:wrap;">
            <button id="btn-add-row"
              style="background:rgba(60,130,60,0.8);border:none;border-radius:6px;color:#fff;cursor:pointer;padding:8px 16px;font-size:14px;">
              + Dodaj pozycj\u0119
            </button>
            <button id="btn-save"
              style="background:rgba(40,100,200,0.85);border:none;border-radius:6px;color:#fff;cursor:pointer;padding:8px 16px;font-size:14px;">
              \u{1F4BE} Zapisz i od\u015Bwie\u017C
            </button>
            <button id="btn-reset"
              style="background:rgba(100,100,100,0.7);border:none;border-radius:6px;color:#fff;cursor:pointer;padding:8px 16px;font-size:14px;">
              \u{1F504} Przywr\xF3\u0107 domy\u015Blne
            </button>
          </div>

          <div id="save-msg" style="display:none; margin-top:12px; padding:8px 12px; background:rgba(50,180,50,0.25); border-radius:6px; font-size:13px;">
            \u2713 Zapisano. Inne karty zostan\u0105 od\u015Bwie\u017Cone automatycznie.
          </div>
        </div>
      `,e.querySelectorAll("[data-action='delete']").forEach(a=>{a.addEventListener("click",()=>{var c;let l=(c=a.dataset.key)!=null?c:"";l&&(delete r[l],o())})}),(p=e.querySelector("#btn-add-row"))==null||p.addEventListener("click",()=>{var c,d;let a="nowa-pozycja-"+Date.now();r[a]=0,o();let l=e.querySelectorAll("tbody tr input[data-field='key']");(c=l[l.length-1])==null||c.focus(),(d=l[l.length-1])==null||d.select()}),(u=e.querySelector("#btn-save"))==null||u.addEventListener("click",()=>{let a={};e.querySelectorAll("tbody tr[data-key]").forEach(c=>{var w,h;let d=c.querySelector("input[data-field='key']"),k=c.querySelector("input[data-field='unitPrice']"),f=(w=d==null?void 0:d.value.trim())!=null?w:"";f&&(a[f]=parseFloat((h=k==null?void 0:k.value)!=null?h:"0")||0)}),r=a,Ge(r),window.dispatchEvent(new StorageEvent("storage",{key:V}));let l=e.querySelector("#save-msg");l&&(l.style.display="block",setTimeout(()=>{l.style.display="none"},3e3))}),(s=e.querySelector("#btn-reset"))==null||s.addEventListener("click",()=>{confirm("Przywr\xF3ci\u0107 domy\u015Blne ceny? Twoje zmiany zostan\u0105 utracone.")&&(r={...et},Ge(r),o())})}o();let n=i=>{i.key===V&&(r=Ye(),o())};window.addEventListener("storage",n),q=()=>window.removeEventListener("storage",n)},unmount(){q&&(q(),q=null)}};function W(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}var _=class{constructor(){this.items=[];this.storageKey="razdwa-cart-v1";this.load()}load(){try{let t=localStorage.getItem(this.storageKey);t&&(this.items=JSON.parse(t))}catch(t){console.error("Failed to load cart from localStorage",t),this.items=[]}}save(){try{localStorage.setItem(this.storageKey,JSON.stringify(this.items))}catch(t){console.error("Failed to save cart to localStorage",t)}}addItem(t){this.items.push(t),this.save()}removeItem(t){t>=0&&t<this.items.length&&(this.items.splice(t,1),this.save())}clear(){this.items=[],this.save()}getItems(){return[...this.items]}getGrandTotal(){return this.items.reduce((t,r)=>t+r.totalPrice,0)}isEmpty(){return this.items.length===0}};function rt(e,t){if(typeof XLSX=="undefined"){console.error("XLSX library not loaded from CDN"),alert("B\u0142\u0105d: Biblioteka Excel nie zosta\u0142a wczytana.");return}let r=e.map(p=>({Kategoria:p.category,Nazwa:p.name,Ilo\u015B\u0107:p.quantity,Jednostka:p.unit,"Cena jedn.":p.unitPrice,"Express (+20%)":p.isExpress?"TAK":"NIE","Cena ca\u0142kowita":p.totalPrice,Klient:t.name,Telefon:t.phone,Email:t.email,Priorytet:t.priority})),o=XLSX.utils.json_to_sheet(r),n=XLSX.utils.book_new();XLSX.utils.book_append_sheet(n,o,"Zam\xF3wienie");let i=new Date().toISOString().slice(0,10),m=`Zamowienie_${t.name.replace(/\s+/g,"_")}_${i}.xlsx`;XLSX.writeFile(n,m)}var z=new _;function Vt(e){let t=document.createElement("div");t.className="toast",t.innerText=e,document.body.appendChild(t),setTimeout(()=>{t.style.opacity="0",setTimeout(()=>t.remove(),300)},2e3)}function N(){let e=document.getElementById("basketList"),t=document.getElementById("basketTotal"),r=document.getElementById("basketDebug");if(!e||!t||!r)return;let o=z.getItems();o.length===0?e.innerHTML=`
      <div class="basketItem">
        <div>
          <div class="basketTitle">Brak pozycji</div>
          <div class="basketMeta">Kliknij \u201EDodaj\u201D, aby zbudowa\u0107 list\u0119.</div>
        </div>
        <div class="basketPrice">\u2014</div>
      </div>
    `:e.innerHTML=o.map((i,m)=>`
      <div class="basketItem">
        <div style="min-width:0;">
          <div class="basketTitle">${i.category}: ${i.name}</div>
          <div class="basketMeta">${i.optionsHint} (${i.quantity} ${i.unit})</div>
        </div>
        <div style="display:flex; gap:10px; align-items:center;">
          <div class="basketPrice">${x(i.totalPrice)}</div>
          <button class="iconBtn" onclick="window.removeItem(${m})" title="Usu\u0144">\xD7</button>
        </div>
      </div>
    `).join("");let n=z.getGrandTotal();t.innerText=x(n),r.innerText=JSON.stringify(o.map(i=>i.payload),null,2)}window.removeItem=e=>{z.removeItem(e),N()};document.addEventListener("DOMContentLoaded",()=>{var m,p,u;let e=document.getElementById("viewContainer"),t=document.getElementById("categorySelector"),r=document.getElementById("categorySearch"),o=document.getElementById("globalExpress");if(!e||!t||!o||!r)return;let n=()=>({cart:{addItem:s=>{z.addItem(s),N(),Vt("\u2713 Dodano do listy")}},expressMode:o.checked,updateLastCalculated:(s,a)=>{let l=document.getElementById("currentPrice"),c=document.getElementById("currentHint");l&&(l.innerText=x(s)),c&&(c.innerText=a?`(${a})`:"")}}),i=new R(e,n);i.setCategories(L),i.addRoute(te),i.addRoute(Oe),i.addRoute(_e),i.addRoute(Y),i.addRoute(oe),i.addRoute(se),i.addRoute(Ee),i.addRoute(Pe),i.addRoute(Le),i.addRoute(Ae),i.addRoute(Re),i.addRoute($e),i.addRoute(Ue),i.addRoute(Qe),i.addRoute(Je),i.addRoute(tt),L.forEach(s=>{let a=document.createElement("option");a.value=s.id,a.innerText=`${s.icon} ${s.name}`,s.implemented||(a.disabled=!0,a.innerText+=" (wkr\xF3tce)"),t.appendChild(a)}),t.addEventListener("change",()=>{let s=t.value;s?window.location.hash=`#/${s}`:window.location.hash="#/"}),r.addEventListener("input",()=>{let s=r.value.toLowerCase();Array.from(t.options).forEach((l,c)=>{if(c===0)return;let d=l.text.toLowerCase();l.hidden=!d.includes(s)})}),r.addEventListener("keydown",s=>{if(s.key==="Enter"){let a=r.value.toLowerCase(),l=Array.from(t.options).find((c,d)=>d>0&&!c.hidden&&!c.disabled);l&&(t.value=l.value,window.location.hash=`#/${l.value}`,r.value="")}}),window.addEventListener("hashchange",()=>{let a=(window.location.hash||"#/").slice(2);t.value=a}),o.addEventListener("change",()=>{let s=document.getElementById("orderSummary");s&&s.classList.toggle("is-express",o.checked);let a=window.location.hash;window.location.hash="",window.location.hash=a}),(m=document.getElementById("copyBtn"))==null||m.addEventListener("click",()=>{var l;let s=document.getElementById("basketTotal"),a=s?`Suma: ${s.innerText}`:"Brak pozycji";(l=navigator.clipboard)==null||l.writeText(a)}),(p=document.getElementById("clearBtn"))==null||p.addEventListener("click",()=>{z.clear(),N()}),(u=document.getElementById("sendBtn"))==null||u.addEventListener("click",()=>{let s={name:document.getElementById("custName").value||"Anonim",phone:document.getElementById("custPhone").value||"-",email:document.getElementById("custEmail").value||"-",priority:document.getElementById("custPriority").value};if(z.isEmpty()){alert("Lista jest pusta!");return}rt(z.getItems(),s)}),N(),i.start()});"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./sw.js").then(e=>console.log("SW registered",e)).catch(e=>console.error("SW failed",e))});})();
