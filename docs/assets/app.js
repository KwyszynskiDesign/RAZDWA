var Se=Object.defineProperty;var A=(e,t)=>{for(var i in t)Se(e,i,{get:t[i],enumerable:!0})};var H=class{routes=new Map;currentView=null;container;getCtx;categories=[];constructor(t,i){this.container=t,this.getCtx=i,window.addEventListener("hashchange",()=>this.handleRoute())}setCategories(t){this.categories=t}addRoute(t){this.routes.set(t.id,t)}handleRoute(){let i=(window.location.hash||"#/").slice(2);this.currentView&&this.currentView.unmount&&this.currentView.unmount(),this.container.innerHTML="";let o=this.routes.get(i);o?(this.currentView=o,o.mount(this.container,this.getCtx())):this.renderHome()}renderHome(){this.container.innerHTML=`
      <div class="category-grid">
        ${this.categories.map(t=>`
          <div class="category-card ${t.implemented?"":"coming-soon"}"
               ${t.implemented?`onclick="window.location.hash='#/${t.id}'"`:""}>
            <div class="category-icon">${t.icon}</div>
            <div class="category-name">${t.name}</div>
            ${t.implemented?"":'<div class="badge">Wkr\xF3tce</div>'}
          </div>
        `).join("")}
      </div>
    `}start(){this.handleRoute()}};function C(e,t){let i=[...e].sort((a,s)=>a.min-s.min),o=i.find(a=>t>=a.min&&(a.max===null||t<=a.max));if(o)return o;let l=i.find(a=>a.min>=t);return l||i[i.length-1]}function ve(e,t){if(!t)return e;let i=t.find(o=>o.type==="minimum"&&o.unit==="m2");return i&&e<i.value?i.value:e}function b(e,t,i=[]){let o=ve(t,e.rules),l=C(e.tiers,o),a=0;e.pricing==="per_unit"?a=o*l.price:a=l.price;let s=0,m=[];if(e.modifiers)for(let r of i){let n=e.modifiers.find(c=>c.id===r);n&&(m.push(n.name),n.type==="percent"?s+=a*n.value:n.type==="fixed_per_unit"?s+=n.value*o:s+=n.value)}let d=a+s,p=e.rules?.find(r=>r.type==="minimum"&&r.unit==="pln");return p&&d<p.value&&(d=p.value),{basePrice:a,effectiveQuantity:o,tierPrice:l.price,modifiersTotal:s,totalPrice:parseFloat(d.toFixed(2)),appliedModifiers:m}}var M={};A(M,{default:()=>Ce,id:()=>Ee,materials:()=>He,modifiers:()=>Pe,pricing:()=>qe,rules:()=>Me,title:()=>Le,unit:()=>Te});var Ee="solwent-plakaty",Le="SOLWENT - PLAKATY",Te="m2",qe="per_unit",Me=[{type:"minimum",unit:"m2",value:1}],Pe=[{id:"express",name:"EXPRESS",type:"percent",value:.2}],He=[{name:"Papier 150g p\xF3\u0142mat",tiers:[{min:1,max:3,price:65},{min:4,max:9,price:60},{min:10,max:20,price:55},{min:21,max:40,price:50},{min:41,max:null,price:42}]},{name:"Papier 200g po\u0142ysk",tiers:[{min:1,max:3,price:70},{min:4,max:9,price:65},{min:10,max:20,price:59},{min:21,max:40,price:53},{min:41,max:null,price:45}]},{name:"Papier 115g matowy",tiers:[{min:1,max:3,price:45},{min:4,max:19,price:40},{min:20,max:null,price:35}]}],Ce={id:Ee,title:Le,unit:Te,pricing:qe,rules:Me,modifiers:Pe,materials:He};function F(e){let t=M,i=t.materials.find(a=>a.name===e.material);if(!i)throw new Error(`Unknown material: ${e.material}`);let o={id:t.id,title:t.title,unit:t.unit,pricing:t.pricing,tiers:i.tiers,rules:t.rules,modifiers:t.modifiers},l=[];return e.express&&l.push("express"),b(o,e.areaM2,l)}function f(e){return new Intl.NumberFormat("pl-PL",{style:"currency",currency:"PLN"}).format(e)}var O={id:"solwent-plakaty",name:"Solwent - Plakaty",mount(e,t){let o=M.materials;e.innerHTML=`
      <h2>Solwent - Plakaty</h2>
      <div class="form">
        <div class="row">
          <label for="material">Materia\u0142:</label>
          <select id="material">
            ${o.map(c=>`<option value="${c.name}">${c.name}</option>`).join("")}
          </select>
        </div>

        <div class="row">
          <label for="area">Powierzchnia (m2):</label>
          <input type="number" id="area" value="1" min="0.1" step="0.1">
          <div class="hint">MINIMALKA 1m2!</div>
        </div>

        <div class="actions">
          <button id="calculate" class="primary">Oblicz</button>
          <button id="add-to-cart" class="success" disabled>Dodaj do listy</button>
        </div>

        <div id="result-display" style="display: none; margin-top: 20px; padding: 14px; background: rgba(34, 197, 94, 0.1); border: 1px solid rgba(34, 197, 94, 0.3); border-radius: 12px;">
          <div style="display: flex; justify-content: space-between;">
            <span>Cena jednostkowa:</span>
            <span id="unit-price" style="font-weight: 900;">-</span>
          </div>
          <div style="display: flex; justify-content: space-between;">
            <span style="font-weight: 800;">Cena ca\u0142kowita:</span>
            <span id="total-price" style="font-size: 18px; font-weight: 950; color: #22c55e;">-</span>
          </div>
        </div>
      </div>
    `;let l=e.querySelector("#material"),a=e.querySelector("#area"),s=e.querySelector("#calculate"),m=e.querySelector("#add-to-cart"),d=e.querySelector("#result-display"),p=e.querySelector("#unit-price"),r=e.querySelector("#total-price"),n=null;s.onclick=()=>{let c={material:l.value,areaM2:parseFloat(a.value),express:t.expressMode};try{let u=F(c);n=u,p.innerText=f(u.tierPrice),r.innerText=f(u.totalPrice),d.style.display="block",m.disabled=!1,t.updateLastCalculated(u.totalPrice,"Solwent - Plakaty")}catch(u){alert("B\u0142\u0105d: "+u.message)}},m.onclick=()=>{n&&t.cart.addItem({id:`solwent-${Date.now()}`,category:"Solwent - Plakaty",name:l.value,quantity:parseFloat(a.value),unit:"m2",unitPrice:n.tierPrice,isExpress:t.expressMode,totalPrice:n.totalPrice,optionsHint:`${a.value}m2${t.expressMode?", EXPRESS":""}`,payload:n})}}};var _=[{qty:1,single:20,double:25},{qty:2,single:29,double:32},{qty:3,single:30,double:37},{qty:4,single:32,double:39},{qty:5,single:35,double:43},{qty:6,single:39,double:45},{qty:7,single:41,double:48},{qty:8,single:45,double:50},{qty:9,single:48,double:52},{qty:10,single:52,double:58},{qty:15,single:60,double:70},{qty:20,single:67,double:82},{qty:25,single:74,double:100},{qty:30,single:84,double:120}];function j(e){let t=_,i=t.find(m=>m.qty===e.qty);i||(i=t.find(m=>m.qty>=e.qty)),i||(i=t[t.length-1]);let o=i[e.sides],l=0;e.satin&&(l+=.12),e.express&&(l+=.2);let a=o*l,s=o+a;return{basePrice:o,modifiersTotal:parseFloat(a.toFixed(2)),totalPrice:parseFloat(s.toFixed(2))}}var U={id:"vouchery",name:"Vouchery",mount(e,t){e.innerHTML=`
      <h2>Vouchery A4</h2>
      <div class="form">
        <div class="row">
          <label for="v-qty">Ilo\u015B\u0107 (szt):</label>
          <input type="number" id="v-qty" value="1" min="1" max="30" step="1">
          <div class="hint">Zakres 1-30 szt.</div>
        </div>

        <div class="row">
          <label>Zadruk:</label>
          <div class="radio-group" style="display: flex; gap: 20px; margin-top: 8px;">
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
              <input type="radio" name="v-sides" value="single" checked> Jednostronne
            </label>
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
              <input type="radio" name="v-sides" value="double"> Dwustronne
            </label>
          </div>
        </div>

        <div class="row">
          <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
            <input type="checkbox" id="v-satin"> Papier satynowy (+12%)
          </label>
        </div>

        <div class="actions">
          <button id="v-calculate" class="primary">Oblicz</button>
          <button id="v-add-to-cart" class="success" disabled>Dodaj do listy</button>
        </div>

        <div id="v-result-display" style="display: none; margin-top: 20px; padding: 14px; background: rgba(34, 197, 94, 0.1); border: 1px solid rgba(34, 197, 94, 0.3); border-radius: 12px;">
          <div style="display: flex; justify-content: space-between;">
            <span>Cena bazowa:</span>
            <span id="v-base-price" style="font-weight: 900;">-</span>
          </div>
          <div id="v-modifiers-row" style="display: none; justify-content: space-between; font-size: 0.9em; opacity: 0.8;">
            <span>Dop\u0142aty:</span>
            <span id="v-modifiers-total">-</span>
          </div>
          <div style="display: flex; justify-content: space-between; margin-top: 8px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 8px;">
            <span style="font-weight: 800;">Cena ca\u0142kowita:</span>
            <span id="v-total-price" style="font-size: 18px; font-weight: 950; color: #22c55e;">-</span>
          </div>
        </div>
      </div>
    `;let i=e.querySelector("#v-qty"),o=e.querySelector("#v-satin"),l=e.querySelector("#v-calculate"),a=e.querySelector("#v-add-to-cart"),s=e.querySelector("#v-result-display"),m=e.querySelector("#v-base-price"),d=e.querySelector("#v-modifiers-row"),p=e.querySelector("#v-modifiers-total"),r=e.querySelector("#v-total-price"),n=null,c=null;l.onclick=()=>{let u=e.querySelector('input[name="v-sides"]:checked'),h=u?u.value:"single";c={qty:parseInt(i.value),sides:h,satin:o.checked,express:t.expressMode};try{let y=j(c);n=y,m.innerText=f(y.basePrice),y.modifiersTotal>0?(d.style.display="flex",p.innerText="+"+f(y.modifiersTotal)):d.style.display="none",r.innerText=f(y.totalPrice),s.style.display="block",a.disabled=!1,t.updateLastCalculated(y.totalPrice,"Vouchery")}catch(y){alert("B\u0142\u0105d: "+y.message)}},a.onclick=()=>{if(n&&c){let u=c.sides==="single"?"Jednostronne":"Dwustronne",h=c.satin?", Satyna":"",y=c.express?", EXPRESS":"";t.cart.addItem({id:`vouchery-${Date.now()}`,category:"Vouchery",name:`Vouchery A4 ${u}`,quantity:c.qty,unit:"szt",unitPrice:n.totalPrice/c.qty,isExpress:c.express,totalPrice:n.totalPrice,optionsHint:`${c.qty} szt${h}${y}`,payload:n})}}}};var L={name:"DYPLOMY - druk cyfrowy",modifiers:{satin:.12,express:.2,bulkDiscount:.12,bulkDiscountThreshold:6},formats:{DL:{name:"DL (99x210mm)",single:{"1":20,"2":30,"3":32,"4":34,"5":35,"6":35,"7":36,"8":37,"9":39,"10":40,"15":45,"20":49,"30":58,"40":65,"50":75,"100":120},double:{"1":20,"2":30,"3":32,"4":34,"5":35,"6":35,"7":36,"8":37,"9":39,"10":40,"15":45,"20":49,"30":58,"40":65,"50":75,"100":120}}}};function Q(e){let{qty:t,sides:i,isSatin:o,express:l}=e,m=L.formats.DL[i===1?"single":"double"],d=Object.keys(m).map(Number).sort((y,w)=>y-w),p=d[0];for(let y of d)t>=y&&(p=y);let r=m[p.toString()],n=[];t>=L.modifiers.bulkDiscountThreshold&&n.push({id:"bulk-discount",name:`Rabat -${L.modifiers.bulkDiscount*100}% (od ${L.modifiers.bulkDiscountThreshold} szt)`,type:"percentage",value:-L.modifiers.bulkDiscount}),o&&n.push({id:"satin",name:"Papier satynowy (+12%)",type:"percentage",value:L.modifiers.satin}),l&&n.push({id:"express",name:"EXPRESS (+20%)",type:"percentage",value:L.modifiers.express});let c=0,u=[];for(let y of n)(y.type==="percent"||y.type==="percentage")&&(c+=r*y.value,u.push(y.name));let h=r+c;return{basePrice:r,effectiveQuantity:t,tierPrice:r/t,modifiersTotal:c,totalPrice:Math.round(h*100)/100,appliedModifiers:u}}var W={id:"dyplomy",name:"Dyplomy",async mount(e,t){let i=await fetch("categories/dyplomy.html");e.innerHTML=await i.text();let o=e.querySelector("#dypSides"),l=e.querySelector("#dypQty"),a=e.querySelector("#dypSatin"),s=e.querySelector("#calcBtn"),m=e.querySelector("#addToCartBtn"),d=e.querySelector("#dypResult"),p=()=>{let r={qty:parseInt(l.value)||1,sides:parseInt(o.value)||1,isSatin:a.checked,express:t.expressMode},n=Q(r);return d.style.display="block",e.querySelector("#resUnitPrice").textContent=f(n.totalPrice/r.qty),e.querySelector("#resTotalPrice").textContent=f(n.totalPrice),e.querySelector("#resDiscountHint").style.display=n.appliedModifiers.includes("bulk-discount")?"block":"none",e.querySelector("#resExpressHint").style.display=r.express?"block":"none",e.querySelector("#resSatinHint").style.display=r.isSatin?"block":"none",t.updateLastCalculated(n.totalPrice,"Dyplomy"),{options:r,result:n}};s.addEventListener("click",()=>p()),m.addEventListener("click",()=>{let{options:r,result:n}=p();t.cart.addItem({id:`dyp-${Date.now()}`,category:"Dyplomy",name:`Dyplomy DL ${r.sides===1?"1-str":"2-str"}`,quantity:r.qty,unit:"szt",unitPrice:n.totalPrice/r.qty,isExpress:r.express,totalPrice:n.totalPrice,optionsHint:`${r.qty} szt, ${r.isSatin?"Satyna":"Kreda"}`,payload:r})}),p()}};var X={"85x55":{none:[{qty:50,price:65},{qty:100,price:75},{qty:150,price:85},{qty:200,price:96},{qty:250,price:110},{qty:300,price:126},{qty:400,price:146},{qty:500,price:170},{qty:1e3,price:290}],matt_gloss:[{qty:50,price:160},{qty:100,price:170},{qty:150,price:180},{qty:200,price:190},{qty:250,price:200},{qty:300,price:220},{qty:400,price:240},{qty:500,price:250},{qty:1e3,price:335}]},"90x50":{none:[{qty:50,price:70},{qty:100,price:79},{qty:150,price:89},{qty:200,price:99},{qty:250,price:120},{qty:300,price:129},{qty:400,price:149},{qty:500,price:175},{qty:1e3,price:300}],matt_gloss:[{qty:50,price:170},{qty:100,price:180},{qty:150,price:190},{qty:200,price:200},{qty:250,price:210},{qty:300,price:230},{qty:400,price:250},{qty:500,price:260},{qty:1e3,price:345}]}};function Be(e,t){let o=X[e][t],l=o.map((a,s)=>({min:(s===0?0:o[s-1].qty)+1,max:a.qty,price:a.price}));return{id:`wizytowki-${e}-${t}`,title:`Wizyt\xF3wki ${e} ${t==="none"?"(bez foliowania)":"(foliowane)"}`,unit:"szt",pricing:"flat",tiers:l,modifiers:[{id:"express",name:"TRYB EXPRESS",type:"percent",value:.2}]}}function N(e){let t=Be(e.format,e.folia),i=[];return e.express&&i.push("express"),b(t,e.qty,i)}var K={id:"wizytowki-druk-cyfrowy",name:"Wizyt\xF3wki - druk cyfrowy",mount(e,t){e.innerHTML=`
      <h2>Wizyt\xF3wki - druk cyfrowy</h2>
      <div class="form">
        <div class="row">
          <label for="w-format">Format:</label>
          <select id="w-format">
            <option value="85x55">85x55 mm</option>
            <option value="90x50">90x50 mm</option>
          </select>
        </div>

        <div class="row">
          <label for="w-folia">Foliowanie:</label>
          <select id="w-folia">
            <option value="none">Bez foliowania</option>
            <option value="matt_gloss">Folia mat / b\u0142ysk</option>
          </select>
        </div>

        <div class="row">
          <label for="w-qty">Ilo\u015B\u0107 (szt):</label>
          <select id="w-qty">
            <option value="50">50 szt</option>
            <option value="100">100 szt</option>
            <option value="150">150 szt</option>
            <option value="200">200 szt</option>
            <option value="250">250 szt</option>
            <option value="300">300 szt</option>
            <option value="400">400 szt</option>
            <option value="500">500 szt</option>
            <option value="1000">1000 szt</option>
          </select>
        </div>

        <div class="actions">
          <button id="w-calculate" class="primary">Oblicz</button>
          <button id="w-add-to-cart" class="success" disabled>Dodaj do koszyka</button>
        </div>

        <div id="w-result-display" style="display: none; margin-top: 20px; padding: 14px; background: rgba(34, 197, 94, 0.1); border: 1px solid rgba(34, 197, 94, 0.3); border-radius: 12px;">
          <div style="display: flex; justify-content: space-between;">
            <span>Cena brutto:</span>
            <span id="w-total-price" style="font-size: 18px; font-weight: 950; color: #22c55e;">-</span>
          </div>
          <div id="w-express-hint" style="display: none; font-size: 0.8em; color: var(--ok); margin-top: 4px;">
            W tym dop\u0142ata EXPRESS +20%
          </div>
        </div>
      </div>
    `;let i=e.querySelector("#w-format"),o=e.querySelector("#w-folia"),l=e.querySelector("#w-qty"),a=e.querySelector("#w-calculate"),s=e.querySelector("#w-add-to-cart"),m=e.querySelector("#w-result-display"),d=e.querySelector("#w-total-price"),p=e.querySelector("#w-express-hint"),r=null,n=null;a.onclick=()=>{n={format:i.value,folia:o.value,qty:parseInt(l.value),express:t.expressMode};try{let c=N(n);r=c,d.innerText=f(c.totalPrice),p.style.display=t.expressMode?"block":"none",m.style.display="block",s.disabled=!1,t.updateLastCalculated(c.totalPrice,"Wizyt\xF3wki")}catch(c){alert("B\u0142\u0105d: "+c.message)}},s.onclick=()=>{if(r&&n){let c=n.folia==="none"?"Bez folii":"Folia",u=n.express?", EXPRESS":"";t.cart.addItem({id:`wizytowki-${Date.now()}`,category:"Wizyt\xF3wki",name:`Wizyt\xF3wki ${n.format}`,quantity:n.qty,unit:"szt",unitPrice:r.totalPrice/n.qty,isExpress:n.express,totalPrice:r.totalPrice,optionsHint:`${n.qty} szt, ${c}${u}`,payload:r})}}}};var D={name:"Roll-up Jednostronny",formats:{"85x200":{width:.85,height:2,tiers:[{min:1,max:5,price:290},{min:6,max:10,price:275}]},"100x200":{width:1,height:2,tiers:[{min:1,max:5,price:305},{min:6,max:10,price:285}]},"120x200":{width:1.2,height:2,tiers:[{min:1,max:5,price:330},{min:6,max:10,price:310}]},"150x200":{width:1.5,height:2,tiers:[{min:1,max:5,price:440},{min:6,max:10,price:425}]}},replacement:{labor:50,print_per_m2:80}};function Z(e){let t=D.formats[e.format];if(!t)throw new Error(`Unknown format: ${e.format}`);let i;if(e.isReplacement){let a=t.width*t.height*D.replacement.print_per_m2+D.replacement.labor;i={id:"roll-up-replacement",title:`Wymiana wk\u0142adu (${e.format})`,unit:"szt",pricing:"per_unit",tiers:[{min:1,max:null,price:a}],modifiers:[{id:"express",name:"EXPRESS",type:"percent",value:.2}]}}else i={id:"roll-up-full",title:`Roll-up Komplet (${e.format})`,unit:"szt",pricing:"per_unit",tiers:t.tiers,modifiers:[{id:"express",name:"EXPRESS",type:"percent",value:.2}]};let o=[];return e.express&&o.push("express"),b(i,e.qty,o)}var J={id:"roll-up",name:"Roll-up",async mount(e,t){let i=await fetch("categories/roll-up.html");e.innerHTML=await i.text();let o=e.querySelector("#rollUpType"),l=e.querySelector("#rollUpFormat"),a=e.querySelector("#rollUpQty"),s=e.querySelector("#calcBtn"),m=e.querySelector("#addToCartBtn"),d=e.querySelector("#rollUpResult"),p=()=>{let r={format:l.value,qty:parseInt(a.value)||1,isReplacement:o.value==="replacement",express:t.expressMode},n=Z(r);return d.style.display="block",e.querySelector("#resUnitPrice").textContent=f(n.totalPrice/r.qty),e.querySelector("#resTotalPrice").textContent=f(n.totalPrice),e.querySelector("#resExpressHint").style.display=r.express?"block":"none",t.updateLastCalculated(n.totalPrice,"Roll-up"),{options:r,result:n}};s.addEventListener("click",()=>p()),m.addEventListener("click",()=>{let{options:r,result:n}=p();t.cart.addItem({id:`rollup-${Date.now()}`,category:"Roll-up",name:`${r.isReplacement?"Wymiana wk\u0142adu":"Roll-up Komplet"} ${r.format}`,quantity:r.qty,unit:"szt",unitPrice:n.totalPrice/r.qty,isExpress:r.express,totalPrice:n.totalPrice,optionsHint:`${r.format}, ${r.qty} szt`,payload:r})}),p()}};var z={name:"Zaproszenia KREDA - druk cyfrowy",modifiers:{satin:.12,express:.2},formats:{A6:{name:"A6 (105x148mm)",single:{normal:{"10":30,"24":40,"32":45,"50":50,"75":60,"100":68,"150":79},folded:{"10":45,"24":55,"32":60,"50":71,"75":84,"100":99,"150":126}},double:{normal:{"10":35,"24":46,"32":57,"50":66,"75":79,"100":89,"150":115},folded:{"10":58,"24":66,"32":84,"50":105,"75":125,"100":149,"150":199}}},A5:{name:"A5 (148x210mm)",single:{normal:{"10":34,"24":42,"32":48,"50":55,"75":63,"100":79,"150":110},folded:{"10":55,"24":60,"32":75,"50":95,"75":125,"100":150,"150":199}},double:{normal:{"10":40,"24":49,"32":62,"50":79,"75":96,"100":119,"150":169},folded:{"10":65,"24":80,"32":115,"50":149,"75":190,"100":235,"150":325}}},DL:{name:"DL (99x210mm)",single:{normal:{"10":35,"24":50,"32":53,"50":59,"75":70,"100":81,"150":105},folded:{"10":45,"24":55,"32":63,"50":79,"75":97,"100":115,"150":149}},double:{normal:{"10":41,"24":55,"32":64,"50":74,"75":88,"100":105,"150":135},folded:{"10":65,"24":80,"32":90,"50":115,"75":150,"100":185,"150":245}}}}};function Y(e){let{format:t,qty:i,sides:o,isFolded:l,isSatin:a,express:s}=e,m=z.formats[t];if(!m)throw new Error(`Invalid format: ${t}`);let d=o===1?"single":"double",p=l?"folded":"normal",r=m[d][p],n=Object.keys(r).map(Number).sort((g,x)=>g-x),c=n[0];for(let g of n)i>=g&&(c=g);let u=r[c.toString()],h=[];a&&h.push({id:"satin",name:"Papier satynowy (+12%)",type:"percentage",value:z.modifiers.satin}),s&&h.push({id:"express",name:"EXPRESS (+20%)",type:"percentage",value:z.modifiers.express});let y=0,w=[];for(let g of h)(g.type==="percent"||g.type==="percentage")&&(y+=u*g.value,w.push(g.name));let k=u+y;return{basePrice:u,effectiveQuantity:i,tierPrice:u/i,modifiersTotal:y,totalPrice:Math.round(k*100)/100,appliedModifiers:w}}var G={id:"zaproszenia-kreda",name:"Zaproszenia KREDA",async mount(e,t){let i=await fetch("categories/zaproszenia-kreda.html");e.innerHTML=await i.text();let o=e.querySelector("#zapFormat"),l=e.querySelector("#zapSides"),a=e.querySelector("#zapFolded"),s=e.querySelector("#zapQty"),m=e.querySelector("#zapSatin"),d=e.querySelector("#calcBtn"),p=e.querySelector("#addToCartBtn"),r=e.querySelector("#zapResult"),n=()=>{let c={format:o.value,qty:parseInt(s.value)||10,sides:parseInt(l.value)||1,isFolded:a.checked,isSatin:m.checked,express:t.expressMode},u=Y(c);return r.style.display="block",e.querySelector("#resUnitPrice").textContent=f(u.totalPrice/c.qty),e.querySelector("#resTotalPrice").textContent=f(u.totalPrice),e.querySelector("#resExpressHint").style.display=c.express?"block":"none",e.querySelector("#resSatinHint").style.display=c.isSatin?"block":"none",t.updateLastCalculated(u.totalPrice,"Zaproszenia"),{options:c,result:u}};d.addEventListener("click",()=>n()),p.addEventListener("click",()=>{let{options:c,result:u}=n();t.cart.addItem({id:`zap-${Date.now()}`,category:"Zaproszenia Kreda",name:`Zaproszenia ${c.format} ${c.sides===1?"1-str":"2-str"}${c.isFolded?" sk\u0142adane":""}`,quantity:c.qty,unit:"szt",unitPrice:u.totalPrice/c.qty,isExpress:c.express,totalPrice:u.totalPrice,optionsHint:`${c.qty} szt, ${c.isSatin?"Satyna":"Kreda"}`,payload:c})}),n()}};var ee={name:"Ulotki - Cyfrowe Dwustronne",formats:{A6:{name:"A6 (105x148)",tiers:[{min:10,max:10,price:40},{min:20,max:20,price:47},{min:30,max:30,price:49},{min:40,max:40,price:55},{min:50,max:50,price:60},{min:60,max:60,price:65},{min:70,max:70,price:70},{min:80,max:80,price:75},{min:90,max:90,price:90},{min:100,max:100,price:95},{min:150,max:150,price:120},{min:200,max:200,price:140},{min:300,max:300,price:190},{min:400,max:400,price:230},{min:500,max:500,price:270},{min:700,max:700,price:355},{min:1e3,max:1e3,price:476}]},A5:{name:"A5 (148 x 210)",tiers:[{min:10,max:10,price:45},{min:20,max:20,price:55},{min:30,max:30,price:60},{min:40,max:40,price:72},{min:50,max:50,price:90},{min:60,max:60,price:99},{min:70,max:70,price:112},{min:80,max:80,price:122},{min:90,max:90,price:130},{min:100,max:100,price:140},{min:150,max:150,price:180},{min:200,max:200,price:220},{min:300,max:300,price:310},{min:400,max:400,price:390},{min:500,max:500,price:460},{min:700,max:700,price:620},{min:1e3,max:1e3,price:790}]},DL:{name:"DL (99 x 210)",tiers:[{min:10,max:10,price:40},{min:20,max:20,price:50},{min:30,max:30,price:55},{min:40,max:40,price:65},{min:50,max:50,price:70},{min:60,max:60,price:78},{min:70,max:70,price:88},{min:80,max:80,price:99},{min:90,max:90,price:109},{min:100,max:100,price:119},{min:150,max:150,price:150},{min:200,max:200,price:179},{min:300,max:300,price:235},{min:400,max:400,price:290},{min:500,max:500,price:350},{min:700,max:700,price:460},{min:1e3,max:1e3,price:590}]}}};function Ae(e){let t=ee.formats[e];if(!t)throw new Error(`Invalid format: ${e}`);return{id:`ulotki-cyfrowe-dwustronne-${e.toLowerCase()}`,title:`Ulotki Cyfrowe Dwustronne ${t.name}`,unit:"szt",pricing:"flat",tiers:t.tiers,modifiers:[{id:"express",name:"TRYB EXPRESS",type:"percent",value:.2}]}}function te(e){let t=Ae(e.format),i=[];return e.express&&i.push("express"),b(t,e.qty,i)}var ie={id:"ulotki-cyfrowe-dwustronne",name:"Ulotki - Cyfrowe Dwustronne",async mount(e,t){try{let i=await fetch("categories/ulotki-cyfrowe-dwustronne.html");if(!i.ok)throw new Error("Failed to load template");e.innerHTML=await i.text(),this.initLogic(e,t)}catch(i){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${i}</div>`}},initLogic(e,t){let i=e.querySelector("#u-format"),o=e.querySelector("#u-qty"),l=e.querySelector("#u-calculate"),a=e.querySelector("#u-add-to-cart"),s=e.querySelector("#u-result-display"),m=e.querySelector("#u-total-price"),d=e.querySelector("#u-express-hint"),p=null,r=null;l.onclick=()=>{r={format:i.value,qty:parseInt(o.value),express:t.expressMode};try{let n=te(r);p=n,m.innerText=f(n.totalPrice),d&&(d.style.display=t.expressMode?"block":"none"),s.style.display="block",a.disabled=!1,t.updateLastCalculated(n.totalPrice,"Ulotki")}catch(n){alert("B\u0142\u0105d: "+n.message)}},a.onclick=()=>{if(p&&r){let n=r.express?", EXPRESS":"";t.cart.addItem({id:`ulotki-dwustronne-${Date.now()}`,category:"Ulotki",name:`Ulotki Dwustronne ${r.format}`,quantity:r.qty,unit:"szt",unitPrice:p.totalPrice/r.qty,isExpress:r.express,totalPrice:p.totalPrice,optionsHint:`${r.qty} szt, Dwustronne${n}`,payload:p})}}}};var re={name:"Ulotki - Cyfrowe Jednostronne",formats:{A6:{name:"A6 (105x148)",tiers:[{min:10,max:10,price:30},{min:20,max:20,price:35},{min:30,max:30,price:40},{min:40,max:40,price:45},{min:50,max:50,price:55},{min:60,max:60,price:61},{min:70,max:70,price:65},{min:80,max:80,price:70},{min:90,max:90,price:75},{min:100,max:100,price:79},{min:150,max:150,price:90},{min:200,max:200,price:110},{min:300,max:300,price:145},{min:400,max:400,price:160},{min:500,max:500,price:190},{min:700,max:700,price:255},{min:1e3,max:1e3,price:320}]},A5:{name:"A5 (148 x 210)",tiers:[{min:10,max:10,price:35},{min:20,max:20,price:42},{min:30,max:30,price:50},{min:40,max:40,price:59},{min:50,max:50,price:69},{min:60,max:60,price:75},{min:70,max:70,price:82},{min:80,max:80,price:88},{min:90,max:90,price:93},{min:100,max:100,price:95},{min:150,max:150,price:130},{min:200,max:200,price:150},{min:300,max:300,price:210},{min:400,max:400,price:259},{min:500,max:500,price:300},{min:700,max:700,price:410},{min:1e3,max:1e3,price:530}]},DL:{name:"DL (99 x 210)",tiers:[{min:10,max:10,price:30},{min:20,max:20,price:35},{min:30,max:30,price:40},{min:40,max:40,price:45},{min:50,max:50,price:55},{min:60,max:60,price:60},{min:70,max:70,price:65},{min:80,max:80,price:70},{min:90,max:90,price:75},{min:100,max:100,price:83},{min:150,max:150,price:100},{min:200,max:200,price:120},{min:300,max:300,price:160},{min:400,max:400,price:199},{min:500,max:500,price:230},{min:700,max:700,price:310},{min:1e3,max:1e3,price:399}]}}};function Oe(e){let t=re.formats[e];if(!t)throw new Error(`Invalid format: ${e}`);return{id:`ulotki-cyfrowe-jednostronne-${e.toLowerCase()}`,title:`Ulotki Cyfrowe Jednostronne ${t.name}`,unit:"szt",pricing:"flat",tiers:t.tiers,modifiers:[{id:"express",name:"TRYB EXPRESS",type:"percent",value:.2}]}}function ae(e){let t=Oe(e.format),i=[];return e.express&&i.push("express"),b(t,e.qty,i)}var ne={id:"ulotki-cyfrowe-jednostronne",name:"Ulotki - Cyfrowe Jednostronne",async mount(e,t){try{let i=await fetch("categories/ulotki-cyfrowe-jednostronne.html");if(!i.ok)throw new Error("Failed to load template");e.innerHTML=await i.text(),this.initLogic(e,t)}catch(i){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${i}</div>`}},initLogic(e,t){let i=e.querySelector("#uj-format"),o=e.querySelector("#uj-qty"),l=e.querySelector("#uj-calculate"),a=e.querySelector("#uj-add-to-cart"),s=e.querySelector("#uj-result-display"),m=e.querySelector("#uj-total-price"),d=e.querySelector("#uj-express-hint"),p=null,r=null;l.onclick=()=>{r={format:i.value,qty:parseInt(o.value),express:t.expressMode};try{let n=ae(r);p=n,m.innerText=f(n.totalPrice),d&&(d.style.display=t.expressMode?"block":"none"),s.style.display="block",a.disabled=!1,t.updateLastCalculated(n.totalPrice,"Ulotki")}catch(n){alert("B\u0142\u0105d: "+n.message)}},a.onclick=()=>{if(p&&r){let n=r.express?", EXPRESS":"";t.cart.addItem({id:`ulotki-jednostronne-${Date.now()}`,category:"Ulotki",name:`Ulotki Jednostronne ${r.format}`,quantity:r.qty,unit:"szt",unitPrice:p.totalPrice/r.qty,isExpress:r.express,totalPrice:p.totalPrice,optionsHint:`${r.qty} szt, Jednostronne${n}`,payload:p})}}}};var oe={id:"banner",title:"Bannery",unit:"m2",pricing:"per_unit",materials:[{id:"powlekany",name:"Banner powlekany",tiers:[{min:1,max:25,price:53},{min:26,max:50,price:49},{min:51,max:null,price:45}]},{id:"blockout",name:"Banner Blockout",tiers:[{min:1,max:25,price:64},{min:26,max:50,price:59},{min:51,max:null,price:55}]}],modifiers:[{id:"oczkowanie",name:"Oczkowanie (+2.50 z\u0142/m2)",type:"fixed_per_unit",value:2.5},{id:"express",name:"TRYB EXPRESS (+20%)",type:"percent",value:.2}]};function se(e){let t=oe,i=t.materials.find(a=>a.id===e.material);if(!i)throw new Error(`Unknown material: ${e.material}`);let o={id:t.id,title:t.title,unit:t.unit,pricing:t.pricing,tiers:i.tiers,modifiers:t.modifiers},l=[];return e.oczkowanie&&l.push("oczkowanie"),e.express&&l.push("express"),b(o,e.areaM2,l)}var le={id:"banner",name:"Bannery",async mount(e,t){try{let i=await fetch("categories/banner.html");if(!i.ok)throw new Error("Failed to load template");e.innerHTML=await i.text(),this.initLogic(e,t)}catch(i){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${i}</div>`}},initLogic(e,t){let i=e.querySelector("#b-material"),o=e.querySelector("#b-area"),l=e.querySelector("#b-oczkowanie"),a=e.querySelector("#b-calculate"),s=e.querySelector("#b-add-to-cart"),m=e.querySelector("#b-result-display"),d=e.querySelector("#b-unit-price"),p=e.querySelector("#b-total-price"),r=e.querySelector("#b-express-hint"),n=null,c=null;a.onclick=()=>{c={material:i.value,areaM2:parseFloat(o.value),oczkowanie:l.checked,express:t.expressMode};try{let u=se(c);n=u,d.innerText=f(u.tierPrice),p.innerText=f(u.totalPrice),r&&(r.style.display=t.expressMode?"block":"none"),m.style.display="block",s.disabled=!1,t.updateLastCalculated(u.totalPrice,"Banner")}catch(u){alert("B\u0142\u0105d: "+u.message)}},s.onclick=()=>{if(n&&c){let u=i.options[i.selectedIndex].text,h=[`${c.areaM2} m2`,c.oczkowanie?"z oczkowaniem":"bez oczkowania",c.express?"EXPRESS":""].filter(Boolean).join(", ");t.cart.addItem({id:`banner-${Date.now()}`,category:"Bannery",name:u,quantity:c.areaM2,unit:"m2",unitPrice:n.tierPrice,isExpress:c.express,totalPrice:n.totalPrice,optionsHint:h,payload:n})}}}};var P={};A(P,{category:()=>je,default:()=>We,groups:()=>Ue,modifiers:()=>Qe});var je="Wlepki / Naklejki",Ue=[{id:"wlepki_obrys_folia",title:"Wlepki po obrysie (Folia Bia\u0142a/Trans)",unit:"m2",pricing:"per_unit",tiers:[{min:1,max:5,price:67},{min:6,max:25,price:60},{min:26,max:50,price:52},{min:51,max:null,price:48}],rules:[{type:"minimum",unit:"m2",value:1}]},{id:"wlepki_polipropylen",title:"Wlepki po obrysie - Polipropylen",unit:"m2",pricing:"per_unit",tiers:[{min:1,max:10,price:50},{min:11,max:null,price:42}],rules:[{type:"minimum",unit:"m2",value:1}]},{id:"wlepki_standard_folia",title:"Folia Bia\u0142a / Transparentna (standard)",unit:"m2",pricing:"per_unit",tiers:[{min:1,max:5,price:54},{min:6,max:25,price:50},{min:26,max:50,price:46},{min:51,max:null,price:42}],rules:[{type:"minimum",unit:"m2",value:1}]}],Qe=[{id:"mocny_klej",name:"Mocny klej",type:"percent",value:.12},{id:"arkusze",name:"Ci\u0119te na arkusze",type:"fixed_per_unit",value:2},{id:"pojedyncze",name:"Ci\u0119te na pojedyncze sztuki",type:"fixed_per_unit",value:10},{id:"express",name:"EXPRESS",type:"percent",value:.2}],We={category:je,groups:Ue,modifiers:Qe};function ce(e){let t=P,i=t.groups.find(a=>a.id===e.groupId);if(!i)throw new Error(`Unknown group: ${e.groupId}`);let o={id:"wlepki",title:i.title,unit:i.unit,pricing:i.pricing||"per_unit",tiers:i.tiers,modifiers:t.modifiers,rules:i.rules||[{type:"minimum",unit:"m2",value:1}]},l=[...e.modifiers];return e.express&&l.push("express"),b(o,e.area,l)}var me={id:"wlepki-naklejki",name:"Wlepki / Naklejki",async mount(e,t){let i=P;try{let u=await fetch("categories/wlepki-naklejki.html");if(!u.ok)throw new Error("Failed to load template");e.innerHTML=await u.text()}catch(u){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania szablonu: ${u}</div>`;return}let o=e.querySelector("#wlepki-group"),l=e.querySelector("#wlepki-area"),a=e.querySelector("#btn-calculate"),s=e.querySelector("#btn-add-to-cart"),m=e.querySelector("#wlepki-result"),d=e.querySelector("#unit-price"),p=e.querySelector("#total-price"),r=null,n=null,c=()=>{let u=e.querySelectorAll(".wlepki-mod:checked"),h=Array.from(u).map(y=>y.value);n={groupId:o.value,area:parseFloat(l.value)||0,express:t.expressMode,modifiers:h};try{let y=ce(n);r=y,d.textContent=f(y.tierPrice),p.textContent=f(y.totalPrice),m.style.display="block",s.disabled=!1,t.updateLastCalculated(y.totalPrice,"Wlepki")}catch(y){alert("B\u0142\u0105d: "+y.message)}};a.addEventListener("click",c),s.addEventListener("click",()=>{if(!r||!n)return;let u=i.groups.find(y=>y.id===n.groupId),h=n.modifiers.map(y=>{let w=i.modifiers.find(k=>k.id===y);return w?w.name:y});n.express&&h.unshift("EXPRESS (+20%)"),t.cart.addItem({id:`wlepki-${Date.now()}`,category:"Wlepki / Naklejki",name:u?.title||"Wlepki",quantity:n.area,unit:"m2",unitPrice:r.tierPrice,isExpress:!!n.express,totalPrice:r.totalPrice,optionsHint:h.join(", ")||"Standard",payload:r})})}};function pe(e,t){let i=0,o=0;if(e.printQty>0){let r=e.mode==="bw"?t.print_bw:t.print_color,n=C(r,e.printQty);o=e.format==="a4"?n.a4:n.a3,i=e.printQty*o}let l=0,a=0;if(e.scanQty>0&&e.scanType!=="none"){let r=e.scanType==="auto"?t.scan_auto:t.scan_manual;a=C(r,e.scanQty).price,l=e.scanQty*a}let s=e.email?t.email_cost:0,m=0;e.surcharge&&e.surchargeQty>0&&(m=e.surchargeQty*o*t.surcharge_factor);let d=i+l+s+m,p=d;return e.express&&(p=d*1.2),{totalPrice:parseFloat(p.toFixed(2)),unitPrintPrice:o,totalPrintPrice:i,unitScanPrice:a,totalScanPrice:l,emailPrice:s,surchargePrice:m,baseTotal:d}}var T=[{id:"solwent-plakaty",name:"Solwent - Plakaty",icon:"\u{1F5BC}\uFE0F",implemented:!0},{id:"vouchery",name:"Vouchery",icon:"\u{1F39F}\uFE0F",implemented:!0},{id:"dyplomy",name:"Dyplomy",icon:"\u{1F4DC}",implemented:!0},{id:"wizytowki-druk-cyfrowy",name:"Wizyt\xF3wki - druk cyfrowy",icon:"\u{1F4C7}",implemented:!0},{id:"zaproszenia-kreda",name:"Zaproszenia KREDA",icon:"\u2709\uFE0F",implemented:!0},{id:"ulotki-cyfrowe-dwustronne",name:"Ulotki - Cyfrowe Dwustronne",icon:"\u{1F4C4}",implemented:!0},{id:"ulotki-cyfrowe-jednostronne",name:"Ulotki - Cyfrowe Jednostronne",icon:"\u{1F4C4}",implemented:!0},{id:"banner",name:"Bannery",icon:"\u{1F3C1}",implemented:!0},{id:"wlepki-naklejki",name:"Wlepki / Naklejki",icon:"\u{1F3F7}\uFE0F",implemented:!0},{id:"roll-up",name:"Roll-up",icon:"\u2195\uFE0F",implemented:!0},{id:"druk-a4-a3-skan",name:"Druk A4/A3 + skan",icon:"\u{1F5A8}\uFE0F",implemented:!0,pricing:{print_bw:[{min:1,max:5,a4:.9,a3:1.7},{min:6,max:20,a4:.6,a3:1.1},{min:21,max:100,a4:.35,a3:.7},{min:101,max:500,a4:.3,a3:.6},{min:501,max:999,a4:.23,a3:.45},{min:1e3,max:4999,a4:.19,a3:.33},{min:5e3,max:null,a4:.15,a3:.3}],print_color:[{min:1,max:10,a4:2.4,a3:4.8},{min:11,max:40,a4:2.2,a3:4.2},{min:41,max:100,a4:2,a3:3.8},{min:101,max:null,a4:1.8,a3:3.4}],scan_auto:[{min:1,max:9,price:1},{min:10,max:49,price:.5},{min:50,max:99,price:.4},{min:100,max:null,price:.25}],scan_manual:[{min:1,max:4,price:2},{min:5,max:null,price:1}],email_cost:1,surcharge_factor:.5}},{id:"druk-cad",name:"Druk CAD wielkoformatowy",icon:"\u{1F4D0}",implemented:!0,format_prices:{bw:{"A0+":{length:1292,price:12.5},A0:{length:1189,price:11},A1:{length:841,price:6},A2:{length:594,price:4},A3:{length:420,price:2.5}},color:{"A0+":{length:1292,price:26},A0:{length:1189,price:24},A1:{length:841,price:12},A2:{length:594,price:8.5},A3:{length:420,price:5.3}}},meter_prices:{bw:{"A0+":10,A0:9,A1:5,A2:4.5,A3:3.5},color:{"A0+":21,A0:20,A1:14.5,A2:13.9,A3:12}}},{id:"folia-szroniona",name:"Folia szroniona",icon:"\u2744\uFE0F",implemented:!0},{id:"laminowanie",name:"Laminowanie",icon:"\u2728",implemented:!0}];var ue={id:"druk-a4-a3-skan",name:"Druk A4/A3 + skan",async mount(e,t){try{let i=await fetch("categories/druk-a4-a3-skan.html");if(!i.ok)throw new Error("Failed to load template");e.innerHTML=await i.text(),this.initLogic(e,t)}catch(i){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${i}</div>`}},initLogic(e,t){let i=T.find(v=>v.id==="druk-a4-a3-skan")?.pricing;if(!i)return;let o=e.querySelector("#d-mode"),l=e.querySelector("#d-format"),a=e.querySelector("#d-print-qty"),s=e.querySelector("#d-email"),m=e.querySelector("#d-surcharge"),d=e.querySelector("#d-surcharge-qty"),p=e.querySelector("#surcharge-qty-row"),r=e.querySelector("#d-scan-type"),n=e.querySelector("#d-scan-qty"),c=e.querySelector("#scan-qty-row"),u=e.querySelector("#d-calculate"),h=e.querySelector("#d-add-to-cart"),y=e.querySelector("#d-result-display"),w=e.querySelector("#d-total-price"),k=e.querySelector("#d-express-hint");m.onchange=()=>{p.style.display=m.checked?"flex":"none"},r.onchange=()=>{c.style.display=r.value!=="none"?"flex":"none"};let g=null,x=null;u.onclick=()=>{x={mode:o.value,format:l.value,printQty:parseInt(a.value)||0,email:s.checked,surcharge:m.checked,surchargeQty:parseInt(d.value)||0,scanType:r.value,scanQty:parseInt(n.value)||0,express:t.expressMode};try{let v=pe(x,i);g=v,w.innerText=f(v.totalPrice),k&&(k.style.display=t.expressMode?"block":"none"),y.style.display="block",h.disabled=!1,t.updateLastCalculated(v.totalPrice,"Druk A4/A3 + skan")}catch(v){alert("B\u0142\u0105d: "+v.message)}},h.onclick=()=>{if(g&&x){let v=Date.now(),$=t.expressMode?1.2:1;if(x.printQty>0||x.scanQty>0&&x.scanType!=="none"){let S=[];x.printQty>0&&S.push(`${x.printQty} str. ${x.format.toUpperCase()} (${x.mode==="bw"?"CZ-B":"KOLOR"})`),x.scanQty>0&&x.scanType!=="none"&&S.push(`Skan ${x.scanType}: ${x.scanQty} str.`),t.expressMode&&S.push("EXPRESS");let V=(g.totalPrintPrice+g.totalScanPrice)*$;t.cart.addItem({id:`druk-${v}-main`,category:"Druk A4/A3 + skan",name:`${x.format.toUpperCase()} ${x.mode==="bw"?"CZ-B":"KOLOR"}`,quantity:x.printQty||x.scanQty,unit:x.printQty>0?"str.":"skan",unitPrice:V/(x.printQty||x.scanQty),isExpress:t.expressMode,totalPrice:parseFloat(V.toFixed(2)),optionsHint:S.join(", "),payload:{...g,type:"main"}})}if(x.email){let S=g.emailPrice*$;t.cart.addItem({id:`email-${v}-email`,category:"Druk A4/A3 + skan",name:"Wysy\u0142ka e-mail",quantity:1,unit:"szt.",unitPrice:S,isExpress:t.expressMode,totalPrice:parseFloat(S.toFixed(2)),optionsHint:t.expressMode?"EXPRESS":"",payload:{price:S,type:"email"}})}if(x.surcharge&&x.surchargeQty>0){let S=g.surchargePrice*$;t.cart.addItem({id:`surcharge-${v}-surcharge`,category:"Druk A4/A3 + skan",name:"Zadruk >25% - dop\u0142ata",quantity:x.surchargeQty,unit:"str.",unitPrice:S/x.surchargeQty,isExpress:t.expressMode,totalPrice:parseFloat(S.toFixed(2)),optionsHint:`${x.surchargeQty} str. (+50%), ${t.expressMode?"EXPRESS":""}`,payload:{price:S,type:"surcharge"}})}}}}};function de(e,t){let i=t.format_prices[e.mode][e.format],o=t.meter_prices[e.mode][e.format],l=0,a=!1;e.lengthMm===i.length?l=i.price:(l=e.lengthMm/1e3*o,a=!0);let s=l;return e.express&&(s=l*1.2),{totalPrice:parseFloat(s.toFixed(2)),basePrice:l,isMeter:a,formatLength:i.length,meterPrice:a?o:null}}var ye={id:"druk-cad",name:"Druk CAD wielkoformatowy",async mount(e,t){try{let i=await fetch("categories/druk-cad.html");if(!i.ok)throw new Error("Failed to load template");e.innerHTML=await i.text(),this.initLogic(e,t)}catch(i){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${i}</div>`}},initLogic(e,t){let i=T.find(k=>k.id==="druk-cad");if(!i)return;let o=e.querySelector("#cad-mode"),l=e.querySelector("#cad-format"),a=e.querySelector("#cad-length"),s=e.querySelector("#cad-use-base"),m=e.querySelector("#cad-base-info"),d=e.querySelector("#cad-calculate"),p=e.querySelector("#cad-add-to-cart"),r=e.querySelector("#cad-result-display"),n=e.querySelector("#cad-price-type"),c=e.querySelector("#cad-total-price"),u=e.querySelector("#cad-express-hint"),h=()=>{let k=l.value,g=o.value,x=i.format_prices[g][k].length;return m.innerText=`Wymiar bazowy: ${x} mm`,x};l.onchange=h,o.onchange=h,s.onclick=()=>{a.value=h().toString()};let y=null,w=null;d.onclick=()=>{w={mode:o.value,format:l.value,lengthMm:parseInt(a.value)||0,express:t.expressMode};try{let k=de(w,i);y=k,n.innerText=k.isMeter?"Cena metrowa:":"Cena formatowa:",c.innerText=f(k.totalPrice),u&&(u.style.display=t.expressMode?"block":"none"),r.style.display="block",p.disabled=!1,t.updateLastCalculated(k.totalPrice,"Druk CAD")}catch(k){alert("B\u0142\u0105d: "+k.message)}},p.onclick=()=>{if(y&&w){let k=[`${w.format} (${w.mode==="bw"?"CZ-B":"KOLOR"})`,`${w.lengthMm} mm`,t.expressMode?"EXPRESS":""].filter(Boolean).join(", ");t.cart.addItem({id:`cad-${Date.now()}`,category:"Druk CAD wielkoformatowy",name:`${w.format} ${w.mode==="bw"?"CZ-B":"KOLOR"}`,quantity:w.lengthMm,unit:"mm",unitPrice:y.basePrice/w.lengthMm,isExpress:t.expressMode,totalPrice:y.totalPrice,optionsHint:k,payload:y})}}}};var fe={id:"folia-szroniona",title:"Folia szroniona",unit:"m2",pricing:"per_unit",rules:[{type:"minimum",unit:"m2",value:1}],materials:[{id:"material-only",name:"Tylko wydruk",tiers:[{min:1,max:5,price:65},{min:6,max:25,price:60},{min:26,max:50,price:56},{min:51,max:null,price:51}]},{id:"full-service",name:"Wydruk z oklejaniem",tiers:[{min:1,max:5,price:140},{min:6,max:10,price:130},{min:11,max:20,price:120},{min:21,max:null,price:0}]}],modifiers:[{id:"express",name:"EXPRESS (+20%)",type:"percent",value:.2}]};function xe(e){let t=fe,i=t.materials.find(d=>d.id===e.serviceId);if(!i)throw new Error(`Unknown service: ${e.serviceId}`);let o=e.widthMm*e.heightMm/1e6,l={id:t.id,title:t.title,unit:t.unit,pricing:t.pricing,rules:t.rules,tiers:i.tiers,modifiers:t.modifiers},a=[];e.express&&a.push("express");let s=b(l,o,a),m=e.serviceId==="full-service"&&o>20;return{...s,isCustom:m}}var we={id:"folia-szroniona",name:"Folia szroniona",async mount(e,t){try{let i=await fetch("categories/folia-szroniona.html");if(!i.ok)throw new Error("Failed to load template");e.innerHTML=await i.text(),this.initLogic(e,t)}catch(i){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${i}</div>`}},initLogic(e,t){let i=e.querySelector("#fs-service"),o=e.querySelector("#fs-width"),l=e.querySelector("#fs-height"),a=e.querySelector("#fs-calculate"),s=e.querySelector("#fs-add-to-cart"),m=e.querySelector("#fs-result-display"),d=e.querySelector("#fs-normal-result"),p=e.querySelector("#fs-custom-quote"),r=e.querySelector("#fs-area-val"),n=e.querySelector("#fs-unit-price"),c=e.querySelector("#fs-total-price"),u=e.querySelector("#fs-express-hint"),h=null,y=null;a.onclick=()=>{y={serviceId:i.value,widthMm:parseInt(o.value)||0,heightMm:parseInt(l.value)||0,express:t.expressMode};try{let w=xe(y);if(h=w,w.isCustom)d.style.display="none",p.style.display="block",s.disabled=!0,t.updateLastCalculated(0,"Folia szroniona (wycena ind.)");else{d.style.display="block",p.style.display="none";let k=y.widthMm*y.heightMm/1e6;r.innerText=`${k.toFixed(2)} m2${w.effectiveQuantity>k?" (min. 1m2)":""}`,n.innerText=f(w.tierPrice),c.innerText=f(w.totalPrice),s.disabled=!1,t.updateLastCalculated(w.totalPrice,"Folia szroniona")}u&&(u.style.display=t.expressMode?"block":"none"),m.style.display="block"}catch(w){alert("B\u0142\u0105d: "+w.message)}},s.onclick=()=>{if(h&&y){let w=i.options[i.selectedIndex].text,k=y.widthMm*y.heightMm/1e6,g=[`${y.widthMm}x${y.heightMm} mm`,`${k.toFixed(2)} m2`,t.expressMode?"EXPRESS":""].filter(Boolean).join(", ");t.cart.addItem({id:`fs-${Date.now()}`,category:"Folia szroniona",name:w,quantity:k,unit:"m2",unitPrice:h.tierPrice,isExpress:t.expressMode,totalPrice:h.totalPrice,optionsHint:g,payload:h})}}}};var he={formats:{A3:[{min:1,max:50,price:7},{min:51,max:100,price:6},{min:101,max:200,price:5}],A4:[{min:1,max:50,price:5},{min:51,max:100,price:4.5},{min:101,max:200,price:4}],A5:[{min:1,max:50,price:4},{min:51,max:100,price:3.5},{min:101,max:200,price:3}],A6:[{min:1,max:50,price:3},{min:51,max:100,price:2.5},{min:101,max:200,price:2}]}};function Ze(e){let t=he.formats[e];if(!t)throw new Error(`Invalid format: ${e}`);return{id:`laminowanie-${e.toLowerCase()}`,title:`Laminowanie ${e}`,unit:"szt",pricing:"per_unit",tiers:t,modifiers:[{id:"express",name:"TRYB EXPRESS",type:"percent",value:.2}]}}function ke(e){let t=Ze(e.format),i=[];return e.express&&i.push("express"),b(t,e.qty,i)}var ge={id:"laminowanie",name:"Laminowanie",async mount(e,t){try{let i=await fetch("categories/laminowanie.html");if(!i.ok)throw new Error("Failed to load template");e.innerHTML=await i.text(),this.initLogic(e,t)}catch(i){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${i}</div>`}},initLogic(e,t){let i=e.querySelector("#lam-format"),o=e.querySelector("#lam-qty"),l=e.querySelector("#lam-calculate"),a=e.querySelector("#lam-add-to-cart"),s=e.querySelector("#lam-result-display"),m=e.querySelector("#lam-total-price"),d=e.querySelector("#lam-express-hint"),p=null,r=null,n=()=>{let c=parseInt(o.value);if(!(isNaN(c)||c<=0)){r={format:i.value,qty:c,express:t.expressMode};try{let u=ke(r);p=u,m.innerText=f(u.totalPrice),d&&(d.style.display=t.expressMode?"block":"none"),s.style.display="block",a.disabled=!1,t.updateLastCalculated(u.totalPrice,"Laminowanie")}catch(u){console.error(u)}}};l.onclick=n,a.onclick=()=>{if(p&&r){let c=r.express?", EXPRESS":"";t.cart.addItem({id:`laminowanie-${Date.now()}`,category:"Laminowanie",name:`Laminowanie ${r.format}`,quantity:r.qty,unit:"szt",unitPrice:p.totalPrice/r.qty,isExpress:r.express,totalPrice:p.totalPrice,optionsHint:`${r.qty} szt, Format ${r.format}${c}`,payload:p})}},[i,o].forEach(c=>{c.addEventListener("change",n)}),o.addEventListener("input",n)}};var B=class{items=[];storageKey="razdwa-cart-v1";constructor(){this.load()}load(){try{let t=localStorage.getItem(this.storageKey);t&&(this.items=JSON.parse(t))}catch(t){console.error("Failed to load cart from localStorage",t),this.items=[]}}save(){try{localStorage.setItem(this.storageKey,JSON.stringify(this.items))}catch(t){console.error("Failed to save cart to localStorage",t)}}addItem(t){this.items.push(t),this.save()}removeItem(t){t>=0&&t<this.items.length&&(this.items.splice(t,1),this.save())}clear(){this.items=[],this.save()}getItems(){return[...this.items]}getGrandTotal(){return this.items.reduce((t,i)=>t+i.totalPrice,0)}isEmpty(){return this.items.length===0}};function be(e,t){if(typeof XLSX>"u"){console.error("XLSX library not loaded from CDN"),alert("B\u0142\u0105d: Biblioteka Excel nie zosta\u0142a wczytana.");return}let i=e.map(m=>({Kategoria:m.category,Nazwa:m.name,Ilo\u015B\u0107:m.quantity,Jednostka:m.unit,"Cena jedn.":m.unitPrice,"Express (+20%)":m.isExpress?"TAK":"NIE","Cena ca\u0142kowita":m.totalPrice,Klient:t.name,Telefon:t.phone,Email:t.email,Priorytet:t.priority})),o=XLSX.utils.json_to_sheet(i),l=XLSX.utils.book_new();XLSX.utils.book_append_sheet(l,o,"Zam\xF3wienie");let a=new Date().toISOString().slice(0,10),s=`Zamowienie_${t.name.replace(/\s+/g,"_")}_${a}.xlsx`;XLSX.writeFile(l,s)}var q=new B;function R(){let e=document.getElementById("basketList"),t=document.getElementById("basketTotal"),i=document.getElementById("basketDebug");if(!e||!t||!i)return;let o=q.getItems();o.length===0?e.innerHTML=`
      <div class="basketItem">
        <div>
          <div class="basketTitle">Brak pozycji</div>
          <div class="basketMeta">Kliknij \u201EDodaj\u201D, aby zbudowa\u0107 list\u0119.</div>
        </div>
        <div class="basketPrice">\u2014</div>
      </div>
    `:e.innerHTML=o.map((a,s)=>`
      <div class="basketItem">
        <div style="min-width:0;">
          <div class="basketTitle">${a.category}: ${a.name}</div>
          <div class="basketMeta">${a.optionsHint} (${a.quantity} ${a.unit})</div>
        </div>
        <div style="display:flex; gap:10px; align-items:center;">
          <div class="basketPrice">${f(a.totalPrice)}</div>
          <button class="iconBtn" onclick="window.removeItem(${s})" title="Usu\u0144">\xD7</button>
        </div>
      </div>
    `).join("");let l=q.getGrandTotal();t.innerText=f(l),i.innerText=JSON.stringify(o.map(a=>a.payload),null,2)}window.removeItem=e=>{q.removeItem(e),R()};document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("viewContainer"),t=document.getElementById("categorySelector"),i=document.getElementById("categorySearch"),o=document.getElementById("globalExpress");if(!e||!t||!o||!i)return;let l=()=>({cart:{addItem:s=>{q.addItem(s),R()}},expressMode:o.checked,updateLastCalculated:(s,m)=>{let d=document.getElementById("currentPrice"),p=document.getElementById("currentHint");d&&(d.innerText=f(s)),p&&(p.innerText=m?`(${m})`:"")}}),a=new H(e,l);a.setCategories(T),a.addRoute(O),a.addRoute(U),a.addRoute(W),a.addRoute(K),a.addRoute(J),a.addRoute(G),a.addRoute(ie),a.addRoute(ne),a.addRoute(le),a.addRoute(me),a.addRoute(ue),a.addRoute(ye),a.addRoute(we),a.addRoute(ge),T.forEach(s=>{let m=document.createElement("option");m.value=s.id,m.innerText=`${s.icon} ${s.name}`,s.implemented||(m.disabled=!0,m.innerText+=" (wkr\xF3tce)"),t.appendChild(m)}),t.addEventListener("change",()=>{let s=t.value;s?window.location.hash=`#/${s}`:window.location.hash="#/"}),i.addEventListener("input",()=>{let s=i.value.toLowerCase();Array.from(t.options).forEach((d,p)=>{if(p===0)return;let r=d.text.toLowerCase();d.hidden=!r.includes(s)})}),i.addEventListener("keydown",s=>{if(s.key==="Enter"){let m=i.value.toLowerCase(),d=Array.from(t.options).find((p,r)=>r>0&&!p.hidden&&!p.disabled);d&&(t.value=d.value,window.location.hash=`#/${d.value}`,i.value="")}}),window.addEventListener("hashchange",()=>{let m=(window.location.hash||"#/").slice(2);t.value=m}),o.addEventListener("change",()=>{let s=window.location.hash;window.location.hash="",window.location.hash=s}),document.getElementById("clearBtn")?.addEventListener("click",()=>{q.clear(),R()}),document.getElementById("sendBtn")?.addEventListener("click",()=>{let s={name:document.getElementById("custName").value||"Anonim",phone:document.getElementById("custPhone").value||"-",email:document.getElementById("custEmail").value||"-",priority:document.getElementById("custPriority").value};if(q.isEmpty()){alert("Lista jest pusta!");return}be(q.getItems(),s)}),R(),a.start()});"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./sw.js").then(e=>console.log("SW registered",e)).catch(e=>console.error("SW failed",e))});
