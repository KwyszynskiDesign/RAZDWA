var he=Object.defineProperty;var A=(e,t)=>{for(var r in t)he(e,r,{get:t[r],enumerable:!0})};var H=class{routes=new Map;currentView=null;container;getCtx;categories=[];constructor(t,r){this.container=t,this.getCtx=r,window.addEventListener("hashchange",()=>this.handleRoute())}setCategories(t){this.categories=t}addRoute(t){this.routes.set(t.id,t)}handleRoute(){let r=(window.location.hash||"#/").slice(2);this.currentView&&this.currentView.unmount&&this.currentView.unmount(),this.container.innerHTML="";let o=this.routes.get(r);o?(this.currentView=o,o.mount(this.container,this.getCtx())):this.renderHome()}renderHome(){this.container.innerHTML=`
      <div class="category-grid">
        ${this.categories.map(t=>`
          <div class="category-card ${t.implemented?"":"coming-soon"}"
               ${t.implemented?`onclick="window.location.hash='#/${t.id}'"`:""}>
            <div class="category-icon">${t.icon}</div>
            <div class="category-name">${t.name}</div>
            ${t.implemented?"":'<div class="badge">Wkr\xF3tce</div>'}
          </div>
        `).join("")}
      </div>
    `}start(){this.handleRoute()}};function C(e,t){let r=[...e].sort((a,s)=>a.min-s.min),o=r.find(a=>t>=a.min&&(a.max===null||t<=a.max));if(o)return o;let l=r.find(a=>a.min>=t);return l||r[r.length-1]}function ge(e,t){if(!t)return e;let r=t.find(o=>o.type==="minimum"&&o.unit==="m2");return r&&e<r.value?r.value:e}function b(e,t,r=[]){let o=ge(t,e.rules),l=C(e.tiers,o),a=0;e.pricing==="per_unit"?a=o*l.price:a=l.price;let s=0,c=[];if(e.modifiers)for(let n of r){let i=e.modifiers.find(m=>m.id===n);i&&(c.push(i.name),i.type==="percent"?s+=a*i.value:i.type==="fixed_per_unit"?s+=i.value*o:s+=i.value)}let y=a+s,p=e.rules?.find(n=>n.type==="minimum"&&n.unit==="pln");return p&&y<p.value&&(y=p.value),{basePrice:a,effectiveQuantity:o,tierPrice:l.price,modifiersTotal:s,totalPrice:parseFloat(y.toFixed(2)),appliedModifiers:c}}var M={};A(M,{default:()=>Me,id:()=>be,materials:()=>qe,modifiers:()=>Le,pricing:()=>Ee,rules:()=>Te,title:()=>ve,unit:()=>Se});var be="solwent-plakaty",ve="SOLWENT - PLAKATY",Se="m2",Ee="per_unit",Te=[{type:"minimum",unit:"m2",value:1}],Le=[{id:"express",name:"EXPRESS",type:"percent",value:.2}],qe=[{name:"Papier 150g p\xF3\u0142mat",tiers:[{min:1,max:3,price:65},{min:4,max:9,price:60},{min:10,max:20,price:55},{min:21,max:40,price:50},{min:41,max:null,price:42}]},{name:"Papier 200g po\u0142ysk",tiers:[{min:1,max:3,price:70},{min:4,max:9,price:65},{min:10,max:20,price:59},{min:21,max:40,price:53},{min:41,max:null,price:45}]},{name:"Papier 115g matowy",tiers:[{min:1,max:3,price:45},{min:4,max:19,price:40},{min:20,max:null,price:35}]}],Me={id:be,title:ve,unit:Se,pricing:Ee,rules:Te,modifiers:Le,materials:qe};function F(e){let t=M,r=t.materials.find(a=>a.name===e.material);if(!r)throw new Error(`Unknown material: ${e.material}`);let o={id:t.id,title:t.title,unit:t.unit,pricing:t.pricing,tiers:r.tiers,rules:t.rules,modifiers:t.modifiers},l=[];return e.express&&l.push("express"),b(o,e.areaM2,l)}function f(e){return new Intl.NumberFormat("pl-PL",{style:"currency",currency:"PLN"}).format(e)}var O={id:"solwent-plakaty",name:"Solwent - Plakaty",mount(e,t){let o=M.materials;e.innerHTML=`
      <h2>Solwent - Plakaty</h2>
      <div class="form">
        <div class="row">
          <label for="material">Materia\u0142:</label>
          <select id="material">
            ${o.map(m=>`<option value="${m.name}">${m.name}</option>`).join("")}
          </select>
        </div>

        <div class="row">
          <label for="area">Powierzchnia (m2):</label>
          <input type="number" id="area" value="1" min="0.1" step="0.1">
          <div class="hint">MINIMALKA 1m2!</div>
        </div>

        <div class="actions">
          <button id="calculate" class="primary">Oblicz</button>
          <button id="add-to-cart" class="success" disabled>Dodaj do listy</button>
        </div>

        <div id="result-display" style="display: none; margin-top: 20px; padding: 14px; background: rgba(34, 197, 94, 0.1); border: 1px solid rgba(34, 197, 94, 0.3); border-radius: 12px;">
          <div style="display: flex; justify-content: space-between;">
            <span>Cena jednostkowa:</span>
            <span id="unit-price" style="font-weight: 900;">-</span>
          </div>
          <div style="display: flex; justify-content: space-between;">
            <span style="font-weight: 800;">Cena ca\u0142kowita:</span>
            <span id="total-price" style="font-size: 18px; font-weight: 950; color: #22c55e;">-</span>
          </div>
        </div>
      </div>
    `;let l=e.querySelector("#material"),a=e.querySelector("#area"),s=e.querySelector("#calculate"),c=e.querySelector("#add-to-cart"),y=e.querySelector("#result-display"),p=e.querySelector("#unit-price"),n=e.querySelector("#total-price"),i=null;s.onclick=()=>{let m={material:l.value,areaM2:parseFloat(a.value),express:t.expressMode};try{let d=F(m);i=d,p.innerText=f(d.tierPrice),n.innerText=f(d.totalPrice),y.style.display="block",c.disabled=!1,t.updateLastCalculated(d.totalPrice,"Solwent - Plakaty")}catch(d){alert("B\u0142\u0105d: "+d.message)}},c.onclick=()=>{i&&t.cart.addItem({id:`solwent-${Date.now()}`,category:"Solwent - Plakaty",name:l.value,quantity:parseFloat(a.value),unit:"m2",unitPrice:i.tierPrice,isExpress:t.expressMode,totalPrice:i.totalPrice,optionsHint:`${a.value}m2${t.expressMode?", EXPRESS":""}`,payload:i})}}};var _=[{qty:1,single:20,double:25},{qty:2,single:29,double:32},{qty:3,single:30,double:37},{qty:4,single:32,double:39},{qty:5,single:35,double:43},{qty:6,single:39,double:45},{qty:7,single:41,double:48},{qty:8,single:45,double:50},{qty:9,single:48,double:52},{qty:10,single:52,double:58},{qty:15,single:60,double:70},{qty:20,single:67,double:82},{qty:25,single:74,double:100},{qty:30,single:84,double:120}];function j(e){let t=_,r=t.find(c=>c.qty===e.qty);r||(r=t.find(c=>c.qty>=e.qty)),r||(r=t[t.length-1]);let o=r[e.sides],l=0;e.satin&&(l+=.12),e.express&&(l+=.2);let a=o*(e.satin?.12:0),s=o*(1+l);return{basePrice:o,modifiersTotal:parseFloat(a.toFixed(2)),totalPrice:parseFloat(s.toFixed(2))}}var U={id:"vouchery",name:"Vouchery",mount(e,t){e.innerHTML=`
      <h2>Vouchery A4</h2>
      <div class="form">
        <div class="row">
          <label for="v-qty">Ilo\u015B\u0107 (szt):</label>
          <input type="number" id="v-qty" value="1" min="1" max="30" step="1">
          <div class="hint">Zakres 1-30 szt.</div>
        </div>

        <div class="row">
          <label>Zadruk:</label>
          <div class="radio-group" style="display: flex; gap: 20px; margin-top: 8px;">
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
              <input type="radio" name="v-sides" value="single" checked> Jednostronne
            </label>
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
              <input type="radio" name="v-sides" value="double"> Dwustronne
            </label>
          </div>
        </div>

        <div class="row">
          <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
            <input type="checkbox" id="v-satin"> Papier satynowy (+12%)
          </label>
        </div>

        <div class="actions">
          <button id="v-calculate" class="primary">Oblicz</button>
          <button id="v-add-to-cart" class="success" disabled>Dodaj do listy</button>
        </div>

        <div id="v-result-display" style="display: none; margin-top: 20px; padding: 14px; background: rgba(34, 197, 94, 0.1); border: 1px solid rgba(34, 197, 94, 0.3); border-radius: 12px;">
          <div style="display: flex; justify-content: space-between;">
            <span>Cena bazowa:</span>
            <span id="v-base-price" style="font-weight: 900;">-</span>
          </div>
          <div id="v-modifiers-row" style="display: none; justify-content: space-between; font-size: 0.9em; opacity: 0.8;">
            <span>Dop\u0142aty:</span>
            <span id="v-modifiers-total">-</span>
          </div>
          <div style="display: flex; justify-content: space-between; margin-top: 8px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 8px;">
            <span style="font-weight: 800;">Cena ca\u0142kowita:</span>
            <span id="v-total-price" style="font-size: 18px; font-weight: 950; color: #22c55e;">-</span>
          </div>
        </div>
      </div>
    `;let r=e.querySelector("#v-qty"),o=e.querySelector("#v-satin"),l=e.querySelector("#v-calculate"),a=e.querySelector("#v-add-to-cart"),s=e.querySelector("#v-result-display"),c=e.querySelector("#v-base-price"),y=e.querySelector("#v-modifiers-row"),p=e.querySelector("#v-modifiers-total"),n=e.querySelector("#v-total-price"),i=null,m=null;l.onclick=()=>{let d=e.querySelector('input[name="v-sides"]:checked'),k=d?d.value:"single";m={qty:parseInt(r.value),sides:k,satin:o.checked,express:t.expressMode};try{let u=j(m);i=u,c.innerText=f(u.basePrice),u.modifiersTotal>0?(y.style.display="flex",p.innerText="+"+f(u.modifiersTotal)):y.style.display="none",n.innerText=f(u.totalPrice),s.style.display="block",a.disabled=!1,t.updateLastCalculated(u.totalPrice,"Vouchery")}catch(u){alert("B\u0142\u0105d: "+u.message)}},a.onclick=()=>{if(i&&m){let d=m.sides==="single"?"Jednostronne":"Dwustronne",k=m.satin?", Satyna":"",u=m.express?", EXPRESS":"";t.cart.addItem({id:`vouchery-${Date.now()}`,category:"Vouchery",name:`Vouchery A4 ${d}`,quantity:m.qty,unit:"szt",unitPrice:i.totalPrice/m.qty,isExpress:m.express,totalPrice:i.totalPrice,optionsHint:`${m.qty} szt${k}${u}`,payload:i})}}}};var T={name:"DYPLOMY - druk cyfrowy",modifiers:{satin:.12,express:.2,bulkDiscount:.12,bulkDiscountThreshold:6},formats:{DL:{name:"DL (99x210mm)",single:{"1":20,"2":30,"3":32,"4":34,"5":35,"6":35,"7":36,"8":37,"9":39,"10":40,"15":45,"20":49,"30":58,"40":65,"50":75,"100":120},double:{"1":20,"2":30,"3":32,"4":34,"5":35,"6":35,"7":36,"8":37,"9":39,"10":40,"15":45,"20":49,"30":58,"40":65,"50":75,"100":120}}}};function Q(e){let{qty:t,sides:r,isSatin:o,express:l}=e,c=T.formats.DL[r===1?"single":"double"],y=Object.keys(c).map(Number).sort((u,w)=>u-w),p=y[0];for(let u of y)t>=u&&(p=u);let n=c[p.toString()],i=[];t>=T.modifiers.bulkDiscountThreshold&&i.push({id:"bulk-discount",name:`Rabat -${T.modifiers.bulkDiscount*100}% (od ${T.modifiers.bulkDiscountThreshold} szt)`,type:"percentage",value:-T.modifiers.bulkDiscount}),o&&i.push({id:"satin",name:"Papier satynowy (+12%)",type:"percentage",value:T.modifiers.satin}),l&&i.push({id:"express",name:"EXPRESS (+20%)",type:"percentage",value:T.modifiers.express});let m=0,d=[];for(let u of i)(u.type==="percent"||u.type==="percentage")&&(m+=n*u.value,d.push(u.name));let k=n+m;return{basePrice:n,effectiveQuantity:t,tierPrice:n/t,modifiersTotal:m,totalPrice:Math.round(k*100)/100,appliedModifiers:d}}var W={id:"dyplomy",name:"Dyplomy",async mount(e,t){let r=await fetch("categories/dyplomy.html");e.innerHTML=await r.text();let o=e.querySelector("#dypSides"),l=e.querySelector("#dypQty"),a=e.querySelector("#dypSatin"),s=e.querySelector("#calcBtn"),c=e.querySelector("#addToCartBtn"),y=e.querySelector("#dypResult"),p=()=>{let n={qty:parseInt(l.value)||1,sides:parseInt(o.value)||1,isSatin:a.checked,express:t.expressMode},i=Q(n);return y.style.display="block",e.querySelector("#resUnitPrice").textContent=f(i.totalPrice/n.qty),e.querySelector("#resTotalPrice").textContent=f(i.totalPrice),e.querySelector("#resDiscountHint").style.display=i.appliedModifiers.includes("bulk-discount")?"block":"none",e.querySelector("#resExpressHint").style.display=n.express?"block":"none",e.querySelector("#resSatinHint").style.display=n.isSatin?"block":"none",t.updateLastCalculated(i.totalPrice,"Dyplomy"),{options:n,result:i}};s.addEventListener("click",()=>p()),c.addEventListener("click",()=>{let{options:n,result:i}=p();t.cart.addItem({id:`dyp-${Date.now()}`,category:"Dyplomy",name:`Dyplomy DL ${n.sides===1?"1-str":"2-str"}`,quantity:n.qty,unit:"szt",unitPrice:i.totalPrice/n.qty,isExpress:n.express,totalPrice:i.totalPrice,optionsHint:`${n.qty} szt, ${n.isSatin?"Satyna":"Kreda"}`,payload:n})}),p()}};var X={"85x55":{none:[{qty:50,price:65},{qty:100,price:75},{qty:150,price:85},{qty:200,price:96},{qty:250,price:110},{qty:300,price:126},{qty:400,price:146},{qty:500,price:170},{qty:1e3,price:290}],matt_gloss:[{qty:50,price:160},{qty:100,price:170},{qty:150,price:180},{qty:200,price:190},{qty:250,price:200},{qty:300,price:220},{qty:400,price:240},{qty:500,price:250},{qty:1e3,price:335}]},"90x50":{none:[{qty:50,price:70},{qty:100,price:79},{qty:150,price:89},{qty:200,price:99},{qty:250,price:120},{qty:300,price:129},{qty:400,price:149},{qty:500,price:175},{qty:1e3,price:300}],matt_gloss:[{qty:50,price:170},{qty:100,price:180},{qty:150,price:190},{qty:200,price:200},{qty:250,price:210},{qty:300,price:230},{qty:400,price:250},{qty:500,price:260},{qty:1e3,price:345}]}};function De(e,t){let o=X[e][t],l=o.map((a,s)=>({min:(s===0?0:o[s-1].qty)+1,max:a.qty,price:a.price}));return{id:`wizytowki-${e}-${t}`,title:`Wizyt\xF3wki ${e} ${t==="none"?"(bez foliowania)":"(foliowane)"}`,unit:"szt",pricing:"flat",tiers:l,modifiers:[{id:"express",name:"TRYB EXPRESS",type:"percent",value:.2}]}}function N(e){let t=De(e.format,e.folia),r=[];return e.express&&r.push("express"),b(t,e.qty,r)}var K={id:"wizytowki-druk-cyfrowy",name:"Wizyt\xF3wki - druk cyfrowy",mount(e,t){e.innerHTML=`
      <h2>Wizyt\xF3wki - druk cyfrowy</h2>
      <div class="form">
        <div class="row">
          <label for="w-format">Format:</label>
          <select id="w-format">
            <option value="85x55">85x55 mm</option>
            <option value="90x50">90x50 mm</option>
          </select>
        </div>

        <div class="row">
          <label for="w-folia">Foliowanie:</label>
          <select id="w-folia">
            <option value="none">Bez foliowania</option>
            <option value="matt_gloss">Folia mat / b\u0142ysk</option>
          </select>
        </div>

        <div class="row">
          <label for="w-qty">Ilo\u015B\u0107 (szt):</label>
          <select id="w-qty">
            <option value="50">50 szt</option>
            <option value="100">100 szt</option>
            <option value="150">150 szt</option>
            <option value="200">200 szt</option>
            <option value="250">250 szt</option>
            <option value="300">300 szt</option>
            <option value="400">400 szt</option>
            <option value="500">500 szt</option>
            <option value="1000">1000 szt</option>
          </select>
        </div>

        <div class="actions">
          <button id="w-calculate" class="primary">Oblicz</button>
          <button id="w-add-to-cart" class="success" disabled>Dodaj do koszyka</button>
        </div>

        <div id="w-result-display" style="display: none; margin-top: 20px; padding: 14px; background: rgba(34, 197, 94, 0.1); border: 1px solid rgba(34, 197, 94, 0.3); border-radius: 12px;">
          <div style="display: flex; justify-content: space-between;">
            <span>Cena brutto:</span>
            <span id="w-total-price" style="font-size: 18px; font-weight: 950; color: #22c55e;">-</span>
          </div>
          <div id="w-express-hint" style="display: none; font-size: 0.8em; color: var(--ok); margin-top: 4px;">
            W tym dop\u0142ata EXPRESS +20%
          </div>
        </div>
      </div>
    `;let r=e.querySelector("#w-format"),o=e.querySelector("#w-folia"),l=e.querySelector("#w-qty"),a=e.querySelector("#w-calculate"),s=e.querySelector("#w-add-to-cart"),c=e.querySelector("#w-result-display"),y=e.querySelector("#w-total-price"),p=e.querySelector("#w-express-hint"),n=null,i=null;a.onclick=()=>{i={format:r.value,folia:o.value,qty:parseInt(l.value),express:t.expressMode};try{let m=N(i);n=m,y.innerText=f(m.totalPrice),p.style.display=t.expressMode?"block":"none",c.style.display="block",s.disabled=!1,t.updateLastCalculated(m.totalPrice,"Wizyt\xF3wki")}catch(m){alert("B\u0142\u0105d: "+m.message)}},s.onclick=()=>{if(n&&i){let m=i.folia==="none"?"Bez folii":"Folia",d=i.express?", EXPRESS":"";t.cart.addItem({id:`wizytowki-${Date.now()}`,category:"Wizyt\xF3wki",name:`Wizyt\xF3wki ${i.format}`,quantity:i.qty,unit:"szt",unitPrice:n.totalPrice/i.qty,isExpress:i.express,totalPrice:n.totalPrice,optionsHint:`${i.qty} szt, ${m}${d}`,payload:n})}}}};var D={name:"Roll-up Jednostronny",formats:{"85x200":{width:.85,height:2,tiers:[{min:1,max:5,price:290},{min:6,max:10,price:275}]},"100x200":{width:1,height:2,tiers:[{min:1,max:5,price:305},{min:6,max:10,price:285}]},"120x200":{width:1.2,height:2,tiers:[{min:1,max:5,price:330},{min:6,max:10,price:310}]},"150x200":{width:1.5,height:2,tiers:[{min:1,max:5,price:440},{min:6,max:10,price:425}]}},replacement:{labor:50,print_per_m2:80}};function Z(e){let t=D.formats[e.format];if(!t)throw new Error(`Unknown format: ${e.format}`);let r;if(e.isReplacement){let a=t.width*t.height*D.replacement.print_per_m2+D.replacement.labor;r={id:"roll-up-replacement",title:`Wymiana wk\u0142adu (${e.format})`,unit:"szt",pricing:"per_unit",tiers:[{min:1,max:null,price:a}],modifiers:[{id:"express",name:"EXPRESS",type:"percent",value:.2}]}}else r={id:"roll-up-full",title:`Roll-up Komplet (${e.format})`,unit:"szt",pricing:"per_unit",tiers:t.tiers,modifiers:[{id:"express",name:"EXPRESS",type:"percent",value:.2}]};let o=[];return e.express&&o.push("express"),b(r,e.qty,o)}var J={id:"roll-up",name:"Roll-up",async mount(e,t){let r=await fetch("categories/roll-up.html");e.innerHTML=await r.text();let o=e.querySelector("#rollUpType"),l=e.querySelector("#rollUpFormat"),a=e.querySelector("#rollUpQty"),s=e.querySelector("#calcBtn"),c=e.querySelector("#addToCartBtn"),y=e.querySelector("#rollUpResult"),p=()=>{let n={format:l.value,qty:parseInt(a.value)||1,isReplacement:o.value==="replacement",express:t.expressMode},i=Z(n);return y.style.display="block",e.querySelector("#resUnitPrice").textContent=f(i.totalPrice/n.qty),e.querySelector("#resTotalPrice").textContent=f(i.totalPrice),e.querySelector("#resExpressHint").style.display=n.express?"block":"none",t.updateLastCalculated(i.totalPrice,"Roll-up"),{options:n,result:i}};s.addEventListener("click",()=>p()),c.addEventListener("click",()=>{let{options:n,result:i}=p();t.cart.addItem({id:`rollup-${Date.now()}`,category:"Roll-up",name:`${n.isReplacement?"Wymiana wk\u0142adu":"Roll-up Komplet"} ${n.format}`,quantity:n.qty,unit:"szt",unitPrice:i.totalPrice/n.qty,isExpress:n.express,totalPrice:i.totalPrice,optionsHint:`${n.format}, ${n.qty} szt`,payload:n})}),p()}};var z={name:"Zaproszenia KREDA - druk cyfrowy",modifiers:{satin:.12,express:.2},formats:{A6:{name:"A6 (105x148mm)",single:{normal:{"10":30,"24":40,"32":45,"50":50,"75":60,"100":68,"150":79},folded:{"10":45,"24":55,"32":60,"50":71,"75":84,"100":99,"150":126}},double:{normal:{"10":35,"24":46,"32":57,"50":66,"75":79,"100":89,"150":115},folded:{"10":58,"24":66,"32":84,"50":105,"75":125,"100":149,"150":199}}},A5:{name:"A5 (148x210mm)",single:{normal:{"10":34,"24":42,"32":48,"50":55,"75":63,"100":79,"150":110},folded:{"10":55,"24":60,"32":75,"50":95,"75":125,"100":150,"150":199}},double:{normal:{"10":40,"24":49,"32":62,"50":79,"75":96,"100":119,"150":169},folded:{"10":65,"24":80,"32":115,"50":149,"75":190,"100":235,"150":325}}},DL:{name:"DL (99x210mm)",single:{normal:{"10":35,"24":50,"32":53,"50":59,"75":70,"100":81,"150":105},folded:{"10":45,"24":55,"32":63,"50":79,"75":97,"100":115,"150":149}},double:{normal:{"10":41,"24":55,"32":64,"50":74,"75":88,"100":105,"150":135},folded:{"10":65,"24":80,"32":90,"50":115,"75":150,"100":185,"150":245}}}}};function Y(e){let{format:t,qty:r,sides:o,isFolded:l,isSatin:a,express:s}=e,c=z.formats[t];if(!c)throw new Error(`Invalid format: ${t}`);let y=o===1?"single":"double",p=l?"folded":"normal",n=c[y][p],i=Object.keys(n).map(Number).sort((g,x)=>g-x),m=i[0];for(let g of i)r>=g&&(m=g);let d=n[m.toString()],k=[];a&&k.push({id:"satin",name:"Papier satynowy (+12%)",type:"percentage",value:z.modifiers.satin}),s&&k.push({id:"express",name:"EXPRESS (+20%)",type:"percentage",value:z.modifiers.express});let u=0,w=[];for(let g of k)(g.type==="percent"||g.type==="percentage")&&(u+=d*g.value,w.push(g.name));let h=d+u;return{basePrice:d,effectiveQuantity:r,tierPrice:d/r,modifiersTotal:u,totalPrice:Math.round(h*100)/100,appliedModifiers:w}}var G={id:"zaproszenia-kreda",name:"Zaproszenia KREDA",async mount(e,t){let r=await fetch("categories/zaproszenia-kreda.html");e.innerHTML=await r.text();let o=e.querySelector("#zapFormat"),l=e.querySelector("#zapSides"),a=e.querySelector("#zapFolded"),s=e.querySelector("#zapQty"),c=e.querySelector("#zapSatin"),y=e.querySelector("#calcBtn"),p=e.querySelector("#addToCartBtn"),n=e.querySelector("#zapResult"),i=()=>{let m={format:o.value,qty:parseInt(s.value)||10,sides:parseInt(l.value)||1,isFolded:a.checked,isSatin:c.checked,express:t.expressMode},d=Y(m);return n.style.display="block",e.querySelector("#resUnitPrice").textContent=f(d.totalPrice/m.qty),e.querySelector("#resTotalPrice").textContent=f(d.totalPrice),e.querySelector("#resExpressHint").style.display=m.express?"block":"none",e.querySelector("#resSatinHint").style.display=m.isSatin?"block":"none",t.updateLastCalculated(d.totalPrice,"Zaproszenia"),{options:m,result:d}};y.addEventListener("click",()=>i()),p.addEventListener("click",()=>{let{options:m,result:d}=i();t.cart.addItem({id:`zap-${Date.now()}`,category:"Zaproszenia Kreda",name:`Zaproszenia ${m.format} ${m.sides===1?"1-str":"2-str"}${m.isFolded?" sk\u0142adane":""}`,quantity:m.qty,unit:"szt",unitPrice:d.totalPrice/m.qty,isExpress:m.express,totalPrice:d.totalPrice,optionsHint:`${m.qty} szt, ${m.isSatin?"Satyna":"Kreda"}`,payload:m})}),i()}};var ee={name:"Ulotki - Cyfrowe Dwustronne",formats:{A6:{name:"A6 (105x148)",tiers:[{min:10,max:10,price:40},{min:20,max:20,price:47},{min:30,max:30,price:49},{min:40,max:40,price:55},{min:50,max:50,price:60},{min:60,max:60,price:65},{min:70,max:70,price:70},{min:80,max:80,price:75},{min:90,max:90,price:90},{min:100,max:100,price:95},{min:150,max:150,price:120},{min:200,max:200,price:140},{min:300,max:300,price:190},{min:400,max:400,price:230},{min:500,max:500,price:270},{min:700,max:700,price:355},{min:1e3,max:1e3,price:476}]},A5:{name:"A5 (148 x 210)",tiers:[{min:10,max:10,price:45},{min:20,max:20,price:55},{min:30,max:30,price:60},{min:40,max:40,price:72},{min:50,max:50,price:90},{min:60,max:60,price:99},{min:70,max:70,price:112},{min:80,max:80,price:122},{min:90,max:90,price:130},{min:100,max:100,price:140},{min:150,max:150,price:180},{min:200,max:200,price:220},{min:300,max:300,price:310},{min:400,max:400,price:390},{min:500,max:500,price:460},{min:700,max:700,price:620},{min:1e3,max:1e3,price:790}]},DL:{name:"DL (99 x 210)",tiers:[{min:10,max:10,price:40},{min:20,max:20,price:50},{min:30,max:30,price:55},{min:40,max:40,price:65},{min:50,max:50,price:70},{min:60,max:60,price:78},{min:70,max:70,price:88},{min:80,max:80,price:99},{min:90,max:90,price:109},{min:100,max:100,price:119},{min:150,max:150,price:150},{min:200,max:200,price:179},{min:300,max:300,price:235},{min:400,max:400,price:290},{min:500,max:500,price:350},{min:700,max:700,price:460},{min:1e3,max:1e3,price:590}]}}};function Re(e){let t=ee.formats[e];if(!t)throw new Error(`Invalid format: ${e}`);return{id:`ulotki-cyfrowe-dwustronne-${e.toLowerCase()}`,title:`Ulotki Cyfrowe Dwustronne ${t.name}`,unit:"szt",pricing:"flat",tiers:t.tiers,modifiers:[{id:"express",name:"TRYB EXPRESS",type:"percent",value:.2}]}}function te(e){let t=Re(e.format),r=[];return e.express&&r.push("express"),b(t,e.qty,r)}var re={id:"ulotki-cyfrowe-dwustronne",name:"Ulotki - Cyfrowe Dwustronne",async mount(e,t){try{let r=await fetch("categories/ulotki-cyfrowe-dwustronne.html");if(!r.ok)throw new Error("Failed to load template");e.innerHTML=await r.text(),this.initLogic(e,t)}catch(r){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${r}</div>`}},initLogic(e,t){let r=e.querySelector("#u-format"),o=e.querySelector("#u-qty"),l=e.querySelector("#u-calculate"),a=e.querySelector("#u-add-to-cart"),s=e.querySelector("#u-result-display"),c=e.querySelector("#u-total-price"),y=e.querySelector("#u-express-hint"),p=null,n=null;l.onclick=()=>{n={format:r.value,qty:parseInt(o.value),express:t.expressMode};try{let i=te(n);p=i,c.innerText=f(i.totalPrice),y&&(y.style.display=t.expressMode?"block":"none"),s.style.display="block",a.disabled=!1,t.updateLastCalculated(i.totalPrice,"Ulotki")}catch(i){alert("B\u0142\u0105d: "+i.message)}},a.onclick=()=>{if(p&&n){let i=n.express?", EXPRESS":"";t.cart.addItem({id:`ulotki-dwustronne-${Date.now()}`,category:"Ulotki",name:`Ulotki Dwustronne ${n.format}`,quantity:n.qty,unit:"szt",unitPrice:p.totalPrice/n.qty,isExpress:n.express,totalPrice:p.totalPrice,optionsHint:`${n.qty} szt, Dwustronne${i}`,payload:p})}}}};var ie={name:"Ulotki - Cyfrowe Jednostronne",formats:{A6:{name:"A6 (105x148)",tiers:[{min:10,max:10,price:30},{min:20,max:20,price:35},{min:30,max:30,price:40},{min:40,max:40,price:45},{min:50,max:50,price:55},{min:60,max:60,price:61},{min:70,max:70,price:65},{min:80,max:80,price:70},{min:90,max:90,price:75},{min:100,max:100,price:79},{min:150,max:150,price:90},{min:200,max:200,price:110},{min:300,max:300,price:145},{min:400,max:400,price:160},{min:500,max:500,price:190},{min:700,max:700,price:255},{min:1e3,max:1e3,price:320}]},A5:{name:"A5 (148 x 210)",tiers:[{min:10,max:10,price:35},{min:20,max:20,price:42},{min:30,max:30,price:50},{min:40,max:40,price:59},{min:50,max:50,price:69},{min:60,max:60,price:75},{min:70,max:70,price:82},{min:80,max:80,price:88},{min:90,max:90,price:93},{min:100,max:100,price:95},{min:150,max:150,price:130},{min:200,max:200,price:150},{min:300,max:300,price:210},{min:400,max:400,price:259},{min:500,max:500,price:300},{min:700,max:700,price:410},{min:1e3,max:1e3,price:530}]},DL:{name:"DL (99 x 210)",tiers:[{min:10,max:10,price:30},{min:20,max:20,price:35},{min:30,max:30,price:40},{min:40,max:40,price:45},{min:50,max:50,price:55},{min:60,max:60,price:60},{min:70,max:70,price:65},{min:80,max:80,price:70},{min:90,max:90,price:75},{min:100,max:100,price:83},{min:150,max:150,price:100},{min:200,max:200,price:120},{min:300,max:300,price:160},{min:400,max:400,price:199},{min:500,max:500,price:230},{min:700,max:700,price:310},{min:1e3,max:1e3,price:399}]}}};function Ve(e){let t=ie.formats[e];if(!t)throw new Error(`Invalid format: ${e}`);return{id:`ulotki-cyfrowe-jednostronne-${e.toLowerCase()}`,title:`Ulotki Cyfrowe Jednostronne ${t.name}`,unit:"szt",pricing:"flat",tiers:t.tiers,modifiers:[{id:"express",name:"TRYB EXPRESS",type:"percent",value:.2}]}}function ae(e){let t=Ve(e.format),r=[];return e.express&&r.push("express"),b(t,e.qty,r)}var ne={id:"ulotki-cyfrowe-jednostronne",name:"Ulotki - Cyfrowe Jednostronne",async mount(e,t){try{let r=await fetch("categories/ulotki-cyfrowe-jednostronne.html");if(!r.ok)throw new Error("Failed to load template");e.innerHTML=await r.text(),this.initLogic(e,t)}catch(r){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${r}</div>`}},initLogic(e,t){let r=e.querySelector("#uj-format"),o=e.querySelector("#uj-qty"),l=e.querySelector("#uj-calculate"),a=e.querySelector("#uj-add-to-cart"),s=e.querySelector("#uj-result-display"),c=e.querySelector("#uj-total-price"),y=e.querySelector("#uj-express-hint"),p=null,n=null;l.onclick=()=>{n={format:r.value,qty:parseInt(o.value),express:t.expressMode};try{let i=ae(n);p=i,c.innerText=f(i.totalPrice),y&&(y.style.display=t.expressMode?"block":"none"),s.style.display="block",a.disabled=!1,t.updateLastCalculated(i.totalPrice,"Ulotki")}catch(i){alert("B\u0142\u0105d: "+i.message)}},a.onclick=()=>{if(p&&n){let i=n.express?", EXPRESS":"";t.cart.addItem({id:`ulotki-jednostronne-${Date.now()}`,category:"Ulotki",name:`Ulotki Jednostronne ${n.format}`,quantity:n.qty,unit:"szt",unitPrice:p.totalPrice/n.qty,isExpress:n.express,totalPrice:p.totalPrice,optionsHint:`${n.qty} szt, Jednostronne${i}`,payload:p})}}}};var oe={id:"banner",title:"Bannery",unit:"m2",pricing:"per_unit",materials:[{id:"powlekany",name:"Banner powlekany",tiers:[{min:1,max:25,price:53},{min:26,max:50,price:49},{min:51,max:null,price:45}]},{id:"blockout",name:"Banner Blockout",tiers:[{min:1,max:25,price:64},{min:26,max:50,price:59},{min:51,max:null,price:55}]}],modifiers:[{id:"oczkowanie",name:"Oczkowanie (+2.50 z\u0142/m2)",type:"fixed_per_unit",value:2.5},{id:"express",name:"TRYB EXPRESS (+20%)",type:"percent",value:.2}]};function se(e){let t=oe,r=t.materials.find(a=>a.id===e.material);if(!r)throw new Error(`Unknown material: ${e.material}`);let o={id:t.id,title:t.title,unit:t.unit,pricing:t.pricing,tiers:r.tiers,modifiers:t.modifiers},l=[];return e.oczkowanie&&l.push("oczkowanie"),e.express&&l.push("express"),b(o,e.areaM2,l)}var le={id:"banner",name:"Bannery",async mount(e,t){try{let r=await fetch("categories/banner.html");if(!r.ok)throw new Error("Failed to load template");e.innerHTML=await r.text(),this.initLogic(e,t)}catch(r){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${r}</div>`}},initLogic(e,t){let r=e.querySelector("#b-material"),o=e.querySelector("#b-area"),l=e.querySelector("#b-oczkowanie"),a=e.querySelector("#b-calculate"),s=e.querySelector("#b-add-to-cart"),c=e.querySelector("#b-result-display"),y=e.querySelector("#b-unit-price"),p=e.querySelector("#b-total-price"),n=e.querySelector("#b-express-hint"),i=null,m=null;a.onclick=()=>{m={material:r.value,areaM2:parseFloat(o.value),oczkowanie:l.checked,express:t.expressMode};try{let d=se(m);i=d,y.innerText=f(d.tierPrice),p.innerText=f(d.totalPrice),n&&(n.style.display=t.expressMode?"block":"none"),c.style.display="block",s.disabled=!1,t.updateLastCalculated(d.totalPrice,"Banner")}catch(d){alert("B\u0142\u0105d: "+d.message)}},s.onclick=()=>{if(i&&m){let d=r.options[r.selectedIndex].text,k=[`${m.areaM2} m2`,m.oczkowanie?"z oczkowaniem":"bez oczkowania",m.express?"EXPRESS":""].filter(Boolean).join(", ");t.cart.addItem({id:`banner-${Date.now()}`,category:"Bannery",name:d,quantity:m.areaM2,unit:"m2",unitPrice:i.tierPrice,isExpress:m.express,totalPrice:i.totalPrice,optionsHint:k,payload:i})}}}};var P={};A(P,{category:()=>Fe,default:()=>je,groups:()=>Oe,modifiers:()=>_e});var Fe="Wlepki / Naklejki",Oe=[{id:"wlepki_obrys_folia",title:"Wlepki po obrysie (Folia Bia\u0142a/Trans)",unit:"m2",pricing:"per_unit",tiers:[{min:1,max:5,price:67},{min:6,max:25,price:60},{min:26,max:50,price:52},{min:51,max:null,price:48}],rules:[{type:"minimum",unit:"m2",value:1}]},{id:"wlepki_polipropylen",title:"Wlepki po obrysie - Polipropylen",unit:"m2",pricing:"per_unit",tiers:[{min:1,max:10,price:50},{min:11,max:null,price:42}],rules:[{type:"minimum",unit:"m2",value:1}]},{id:"wlepki_standard_folia",title:"Folia Bia\u0142a / Transparentna (standard)",unit:"m2",pricing:"per_unit",tiers:[{min:1,max:5,price:54},{min:6,max:25,price:50},{min:26,max:50,price:46},{min:51,max:null,price:42}],rules:[{type:"minimum",unit:"m2",value:1}]}],_e=[{id:"mocny_klej",name:"Mocny klej",type:"percent",value:.12},{id:"arkusze",name:"Ci\u0119te na arkusze",type:"fixed_per_unit",value:2},{id:"pojedyncze",name:"Ci\u0119te na pojedyncze sztuki",type:"fixed_per_unit",value:10},{id:"express",name:"EXPRESS",type:"percent",value:.2}],je={category:Fe,groups:Oe,modifiers:_e};function ce(e){let t=P,r=t.groups.find(a=>a.id===e.groupId);if(!r)throw new Error(`Unknown group: ${e.groupId}`);let o={id:"wlepki",title:r.title,unit:r.unit,pricing:r.pricing||"per_unit",tiers:r.tiers,modifiers:t.modifiers,rules:r.rules||[{type:"minimum",unit:"m2",value:1}]},l=[...e.modifiers];return e.express&&l.push("express"),b(o,e.area,l)}var me={id:"wlepki-naklejki",name:"Wlepki / Naklejki",async mount(e,t){let r=P;try{let d=await fetch("categories/wlepki-naklejki.html");if(!d.ok)throw new Error("Failed to load template");e.innerHTML=await d.text()}catch(d){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania szablonu: ${d}</div>`;return}let o=e.querySelector("#wlepki-group"),l=e.querySelector("#wlepki-area"),a=e.querySelector("#btn-calculate"),s=e.querySelector("#btn-add-to-cart"),c=e.querySelector("#wlepki-result"),y=e.querySelector("#unit-price"),p=e.querySelector("#total-price"),n=null,i=null,m=()=>{let d=e.querySelectorAll(".wlepki-mod:checked"),k=Array.from(d).map(u=>u.value);i={groupId:o.value,area:parseFloat(l.value)||0,express:t.expressMode,modifiers:k};try{let u=ce(i);n=u,y.textContent=f(u.tierPrice),p.textContent=f(u.totalPrice),c.style.display="block",s.disabled=!1,t.updateLastCalculated(u.totalPrice,"Wlepki")}catch(u){alert("B\u0142\u0105d: "+u.message)}};a.addEventListener("click",m),s.addEventListener("click",()=>{if(!n||!i)return;let d=r.groups.find(u=>u.id===i.groupId),k=i.modifiers.map(u=>{let w=r.modifiers.find(h=>h.id===u);return w?w.name:u});i.express&&k.unshift("EXPRESS (+20%)"),t.cart.addItem({id:`wlepki-${Date.now()}`,category:"Wlepki / Naklejki",name:d?.title||"Wlepki",quantity:i.area,unit:"m2",unitPrice:n.tierPrice,isExpress:!!i.express,totalPrice:n.totalPrice,optionsHint:k.join(", ")||"Standard",payload:n})})}};function pe(e,t){let r=0,o=0;if(e.printQty>0){let n=e.mode==="bw"?t.print_bw:t.print_color,i=C(n,e.printQty);o=e.format==="a4"?i.a4:i.a3,r=e.printQty*o}let l=0,a=0;if(e.scanQty>0&&e.scanType!=="none"){let n=e.scanType==="auto"?t.scan_auto:t.scan_manual;a=C(n,e.scanQty).price,l=e.scanQty*a}let s=e.email?t.email_cost:0,c=0;e.surcharge&&e.surchargeQty>0&&(c=e.surchargeQty*o*t.surcharge_factor);let y=r+l+s+c,p=y;return e.express&&(p=y*1.2),{totalPrice:parseFloat(p.toFixed(2)),unitPrintPrice:o,totalPrintPrice:r,unitScanPrice:a,totalScanPrice:l,emailPrice:s,surchargePrice:c,baseTotal:y}}var L=[{id:"solwent-plakaty",name:"Solwent - Plakaty",icon:"\u{1F5BC}\uFE0F",implemented:!0},{id:"vouchery",name:"Vouchery",icon:"\u{1F39F}\uFE0F",implemented:!0},{id:"dyplomy",name:"Dyplomy",icon:"\u{1F4DC}",implemented:!0},{id:"wizytowki-druk-cyfrowy",name:"Wizyt\xF3wki - druk cyfrowy",icon:"\u{1F4C7}",implemented:!0},{id:"zaproszenia-kreda",name:"Zaproszenia KREDA",icon:"\u2709\uFE0F",implemented:!0},{id:"ulotki-cyfrowe-dwustronne",name:"Ulotki - Cyfrowe Dwustronne",icon:"\u{1F4C4}",implemented:!0},{id:"ulotki-cyfrowe-jednostronne",name:"Ulotki - Cyfrowe Jednostronne",icon:"\u{1F4C4}",implemented:!0},{id:"banner",name:"Bannery",icon:"\u{1F3C1}",implemented:!0},{id:"wlepki-naklejki",name:"Wlepki / Naklejki",icon:"\u{1F3F7}\uFE0F",implemented:!0},{id:"roll-up",name:"Roll-up",icon:"\u2195\uFE0F",implemented:!0},{id:"druk-a4-a3-skan",name:"Druk A4/A3 + skan",icon:"\u{1F5A8}\uFE0F",implemented:!0,pricing:{print_bw:[{min:1,max:5,a4:.9,a3:1.7},{min:6,max:20,a4:.6,a3:1.1},{min:21,max:100,a4:.35,a3:.7},{min:101,max:500,a4:.3,a3:.6},{min:501,max:999,a4:.23,a3:.45},{min:1e3,max:4999,a4:.19,a3:.33},{min:5e3,max:null,a4:.15,a3:.3}],print_color:[{min:1,max:10,a4:2.4,a3:4.8},{min:11,max:40,a4:2.2,a3:4.2},{min:41,max:100,a4:2,a3:3.8},{min:101,max:null,a4:1.8,a3:3.4}],scan_auto:[{min:1,max:9,price:1},{min:10,max:49,price:.5},{min:50,max:99,price:.4},{min:100,max:null,price:.25}],scan_manual:[{min:1,max:4,price:2},{min:5,max:null,price:1}],email_cost:1,surcharge_factor:.5}},{id:"druk-cad",name:"Druk CAD wielkoformatowy",icon:"\u{1F4D0}",implemented:!0,format_prices:{bw:{"A0+":{length:1292,price:12.5},A0:{length:1189,price:11},A1:{length:841,price:6},A2:{length:594,price:4},A3:{length:420,price:2.5}},color:{"A0+":{length:1292,price:26},A0:{length:1189,price:24},A1:{length:841,price:12},A2:{length:594,price:8.5},A3:{length:420,price:5.3}}},meter_prices:{bw:{"A0+":10,A0:9,A1:5,A2:4.5,A3:3.5},color:{"A0+":21,A0:20,A1:14.5,A2:13.9,A3:12}}},{id:"folia-szroniona",name:"Folia szroniona",icon:"\u2744\uFE0F",implemented:!0}];var ue={id:"druk-a4-a3-skan",name:"Druk A4/A3 + skan",async mount(e,t){try{let r=await fetch("categories/druk-a4-a3-skan.html");if(!r.ok)throw new Error("Failed to load template");e.innerHTML=await r.text(),this.initLogic(e,t)}catch(r){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${r}</div>`}},initLogic(e,t){let r=L.find(S=>S.id==="druk-a4-a3-skan")?.pricing;if(!r)return;let o=e.querySelector("#d-mode"),l=e.querySelector("#d-format"),a=e.querySelector("#d-print-qty"),s=e.querySelector("#d-email"),c=e.querySelector("#d-surcharge"),y=e.querySelector("#d-surcharge-qty"),p=e.querySelector("#surcharge-qty-row"),n=e.querySelector("#d-scan-type"),i=e.querySelector("#d-scan-qty"),m=e.querySelector("#scan-qty-row"),d=e.querySelector("#d-calculate"),k=e.querySelector("#d-add-to-cart"),u=e.querySelector("#d-result-display"),w=e.querySelector("#d-total-price"),h=e.querySelector("#d-express-hint");c.onchange=()=>{p.style.display=c.checked?"flex":"none"},n.onchange=()=>{m.style.display=n.value!=="none"?"flex":"none"};let g=null,x=null;d.onclick=()=>{x={mode:o.value,format:l.value,printQty:parseInt(a.value)||0,email:s.checked,surcharge:c.checked,surchargeQty:parseInt(y.value)||0,scanType:n.value,scanQty:parseInt(i.value)||0,express:t.expressMode};try{let S=pe(x,r);g=S,w.innerText=f(S.totalPrice),h&&(h.style.display=t.expressMode?"block":"none"),u.style.display="block",k.disabled=!1,t.updateLastCalculated(S.totalPrice,"Druk A4/A3 + skan")}catch(S){alert("B\u0142\u0105d: "+S.message)}},k.onclick=()=>{if(g&&x){let S=Date.now(),$=t.expressMode?1.2:1;if(x.printQty>0||x.scanQty>0&&x.scanType!=="none"){let v=[];x.printQty>0&&v.push(`${x.printQty} str. ${x.format.toUpperCase()} (${x.mode==="bw"?"CZ-B":"KOLOR"})`),x.scanQty>0&&x.scanType!=="none"&&v.push(`Skan ${x.scanType}: ${x.scanQty} str.`),t.expressMode&&v.push("EXPRESS");let V=(g.totalPrintPrice+g.totalScanPrice)*$;t.cart.addItem({id:`druk-${S}-main`,category:"Druk A4/A3 + skan",name:`${x.format.toUpperCase()} ${x.mode==="bw"?"CZ-B":"KOLOR"}`,quantity:x.printQty||x.scanQty,unit:x.printQty>0?"str.":"skan",unitPrice:V/(x.printQty||x.scanQty),isExpress:t.expressMode,totalPrice:parseFloat(V.toFixed(2)),optionsHint:v.join(", "),payload:{...g,type:"main"}})}if(x.email){let v=g.emailPrice*$;t.cart.addItem({id:`email-${S}-email`,category:"Druk A4/A3 + skan",name:"Wysy\u0142ka e-mail",quantity:1,unit:"szt.",unitPrice:v,isExpress:t.expressMode,totalPrice:parseFloat(v.toFixed(2)),optionsHint:t.expressMode?"EXPRESS":"",payload:{price:v,type:"email"}})}if(x.surcharge&&x.surchargeQty>0){let v=g.surchargePrice*$;t.cart.addItem({id:`surcharge-${S}-surcharge`,category:"Druk A4/A3 + skan",name:"Zadruk >25% - dop\u0142ata",quantity:x.surchargeQty,unit:"str.",unitPrice:v/x.surchargeQty,isExpress:t.expressMode,totalPrice:parseFloat(v.toFixed(2)),optionsHint:`${x.surchargeQty} str. (+50%), ${t.expressMode?"EXPRESS":""}`,payload:{price:v,type:"surcharge"}})}}}}};function de(e,t){let r=t.format_prices[e.mode][e.format],o=t.meter_prices[e.mode][e.format],l=0,a=!1;e.lengthMm===r.length?l=r.price:(l=e.lengthMm/1e3*o,a=!0);let s=l;return e.express&&(s=l*1.2),{totalPrice:parseFloat(s.toFixed(2)),basePrice:l,isMeter:a,formatLength:r.length,meterPrice:a?o:null}}var ye={id:"druk-cad",name:"Druk CAD wielkoformatowy",async mount(e,t){try{let r=await fetch("categories/druk-cad.html");if(!r.ok)throw new Error("Failed to load template");e.innerHTML=await r.text(),this.initLogic(e,t)}catch(r){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${r}</div>`}},initLogic(e,t){let r=L.find(h=>h.id==="druk-cad");if(!r)return;let o=e.querySelector("#cad-mode"),l=e.querySelector("#cad-format"),a=e.querySelector("#cad-length"),s=e.querySelector("#cad-use-base"),c=e.querySelector("#cad-base-info"),y=e.querySelector("#cad-calculate"),p=e.querySelector("#cad-add-to-cart"),n=e.querySelector("#cad-result-display"),i=e.querySelector("#cad-price-type"),m=e.querySelector("#cad-total-price"),d=e.querySelector("#cad-express-hint"),k=()=>{let h=l.value,g=o.value,x=r.format_prices[g][h].length;return c.innerText=`Wymiar bazowy: ${x} mm`,x};l.onchange=k,o.onchange=k,s.onclick=()=>{a.value=k().toString()};let u=null,w=null;y.onclick=()=>{w={mode:o.value,format:l.value,lengthMm:parseInt(a.value)||0,express:t.expressMode};try{let h=de(w,r);u=h,i.innerText=h.isMeter?"Cena metrowa:":"Cena formatowa:",m.innerText=f(h.totalPrice),d&&(d.style.display=t.expressMode?"block":"none"),n.style.display="block",p.disabled=!1,t.updateLastCalculated(h.totalPrice,"Druk CAD")}catch(h){alert("B\u0142\u0105d: "+h.message)}},p.onclick=()=>{if(u&&w){let h=[`${w.format} (${w.mode==="bw"?"CZ-B":"KOLOR"})`,`${w.lengthMm} mm`,t.expressMode?"EXPRESS":""].filter(Boolean).join(", ");t.cart.addItem({id:`cad-${Date.now()}`,category:"Druk CAD wielkoformatowy",name:`${w.format} ${w.mode==="bw"?"CZ-B":"KOLOR"}`,quantity:w.lengthMm,unit:"mm",unitPrice:u.basePrice/w.lengthMm,isExpress:t.expressMode,totalPrice:u.totalPrice,optionsHint:h,payload:u})}}}};var fe={id:"folia-szroniona",title:"Folia szroniona",unit:"m2",pricing:"per_unit",rules:[{type:"minimum",unit:"m2",value:1}],materials:[{id:"material-only",name:"Tylko wydruk",tiers:[{min:1,max:5,price:65},{min:6,max:25,price:60},{min:26,max:50,price:56},{min:51,max:null,price:51}]},{id:"full-service",name:"Wydruk z oklejaniem",tiers:[{min:1,max:5,price:140},{min:6,max:10,price:130},{min:11,max:20,price:120},{min:21,max:null,price:0}]}],modifiers:[{id:"express",name:"EXPRESS (+20%)",type:"percent",value:.2}]};function xe(e){let t=fe,r=t.materials.find(y=>y.id===e.serviceId);if(!r)throw new Error(`Unknown service: ${e.serviceId}`);let o=e.widthMm*e.heightMm/1e6,l={id:t.id,title:t.title,unit:t.unit,pricing:t.pricing,rules:t.rules,tiers:r.tiers,modifiers:t.modifiers},a=[];e.express&&a.push("express");let s=b(l,o,a),c=e.serviceId==="full-service"&&o>20;return{...s,isCustom:c}}var we={id:"folia-szroniona",name:"Folia szroniona",async mount(e,t){try{let r=await fetch("categories/folia-szroniona.html");if(!r.ok)throw new Error("Failed to load template");e.innerHTML=await r.text(),this.initLogic(e,t)}catch(r){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${r}</div>`}},initLogic(e,t){let r=e.querySelector("#fs-service"),o=e.querySelector("#fs-width"),l=e.querySelector("#fs-height"),a=e.querySelector("#fs-calculate"),s=e.querySelector("#fs-add-to-cart"),c=e.querySelector("#fs-result-display"),y=e.querySelector("#fs-normal-result"),p=e.querySelector("#fs-custom-quote"),n=e.querySelector("#fs-area-val"),i=e.querySelector("#fs-unit-price"),m=e.querySelector("#fs-total-price"),d=e.querySelector("#fs-express-hint"),k=null,u=null;a.onclick=()=>{u={serviceId:r.value,widthMm:parseInt(o.value)||0,heightMm:parseInt(l.value)||0,express:t.expressMode};try{let w=xe(u);if(k=w,w.isCustom)y.style.display="none",p.style.display="block",s.disabled=!0,t.updateLastCalculated(0,"Folia szroniona (wycena ind.)");else{y.style.display="block",p.style.display="none";let h=u.widthMm*u.heightMm/1e6;n.innerText=`${h.toFixed(2)} m2${w.effectiveQuantity>h?" (min. 1m2)":""}`,i.innerText=f(w.tierPrice),m.innerText=f(w.totalPrice),s.disabled=!1,t.updateLastCalculated(w.totalPrice,"Folia szroniona")}d&&(d.style.display=t.expressMode?"block":"none"),c.style.display="block"}catch(w){alert("B\u0142\u0105d: "+w.message)}},s.onclick=()=>{if(k&&u){let w=r.options[r.selectedIndex].text,h=u.widthMm*u.heightMm/1e6,g=[`${u.widthMm}x${u.heightMm} mm`,`${h.toFixed(2)} m2`,t.expressMode?"EXPRESS":""].filter(Boolean).join(", ");t.cart.addItem({id:`fs-${Date.now()}`,category:"Folia szroniona",name:w,quantity:h,unit:"m2",unitPrice:k.tierPrice,isExpress:t.expressMode,totalPrice:k.totalPrice,optionsHint:g,payload:k})}}}};var B=class{items=[];storageKey="razdwa-cart-v1";constructor(){this.load()}load(){try{let t=localStorage.getItem(this.storageKey);t&&(this.items=JSON.parse(t))}catch(t){console.error("Failed to load cart from localStorage",t),this.items=[]}}save(){try{localStorage.setItem(this.storageKey,JSON.stringify(this.items))}catch(t){console.error("Failed to save cart to localStorage",t)}}addItem(t){this.items.push(t),this.save()}removeItem(t){t>=0&&t<this.items.length&&(this.items.splice(t,1),this.save())}clear(){this.items=[],this.save()}getItems(){return[...this.items]}getGrandTotal(){return this.items.reduce((t,r)=>t+r.totalPrice,0)}isEmpty(){return this.items.length===0}};function ke(e,t){if(typeof XLSX>"u"){console.error("XLSX library not loaded from CDN"),alert("B\u0142\u0105d: Biblioteka Excel nie zosta\u0142a wczytana.");return}let r=e.map(c=>({Kategoria:c.category,Nazwa:c.name,Ilo\u015B\u0107:c.quantity,Jednostka:c.unit,"Cena jedn.":c.unitPrice,"Express (+20%)":c.isExpress?"TAK":"NIE","Cena ca\u0142kowita":c.totalPrice,Klient:t.name,Telefon:t.phone,Email:t.email,Priorytet:t.priority})),o=XLSX.utils.json_to_sheet(r),l=XLSX.utils.book_new();XLSX.utils.book_append_sheet(l,o,"Zam\xF3wienie");let a=new Date().toISOString().slice(0,10),s=`Zamowienie_${t.name.replace(/\s+/g,"_")}_${a}.xlsx`;XLSX.writeFile(l,s)}var q=new B;function R(){let e=document.getElementById("basketList"),t=document.getElementById("basketTotal"),r=document.getElementById("basketDebug");if(!e||!t||!r)return;let o=q.getItems();o.length===0?e.innerHTML=`
      <div class="basketItem">
        <div>
          <div class="basketTitle">Brak pozycji</div>
          <div class="basketMeta">Kliknij \u201EDodaj\u201D, aby zbudowa\u0107 list\u0119.</div>
        </div>
        <div class="basketPrice">\u2014</div>
      </div>
    `:e.innerHTML=o.map((a,s)=>`
      <div class="basketItem">
        <div style="min-width:0;">
          <div class="basketTitle">${a.category}: ${a.name}</div>
          <div class="basketMeta">${a.optionsHint} (${a.quantity} ${a.unit})</div>
        </div>
        <div style="display:flex; gap:10px; align-items:center;">
          <div class="basketPrice">${f(a.totalPrice)}</div>
          <button class="iconBtn" onclick="window.removeItem(${s})" title="Usu\u0144">\xD7</button>
        </div>
      </div>
    `).join("");let l=q.getGrandTotal();t.innerText=f(l),r.innerText=JSON.stringify(o.map(a=>a.payload),null,2)}window.removeItem=e=>{q.removeItem(e),R()};document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("viewContainer"),t=document.getElementById("categorySelector"),r=document.getElementById("categorySearch"),o=document.getElementById("globalExpress");if(!e||!t||!o||!r)return;let l=()=>({cart:{addItem:s=>{q.addItem(s),R()}},expressMode:o.checked,updateLastCalculated:(s,c)=>{let y=document.getElementById("currentPrice"),p=document.getElementById("currentHint");y&&(y.innerText=f(s)),p&&(p.innerText=c?`(${c})`:"")}}),a=new H(e,l);a.setCategories(L),a.addRoute(O),a.addRoute(U),a.addRoute(W),a.addRoute(K),a.addRoute(J),a.addRoute(G),a.addRoute(re),a.addRoute(ne),a.addRoute(le),a.addRoute(me),a.addRoute(ue),a.addRoute(ye),a.addRoute(we),L.forEach(s=>{let c=document.createElement("option");c.value=s.id,c.innerText=`${s.icon} ${s.name}`,s.implemented||(c.disabled=!0,c.innerText+=" (wkr\xF3tce)"),t.appendChild(c)}),t.addEventListener("change",()=>{let s=t.value;s?window.location.hash=`#/${s}`:window.location.hash="#/"}),r.addEventListener("input",()=>{let s=r.value.toLowerCase();Array.from(t.options).forEach((y,p)=>{if(p===0)return;let n=y.text.toLowerCase();y.hidden=!n.includes(s)})}),r.addEventListener("keydown",s=>{if(s.key==="Enter"){let c=r.value.toLowerCase(),y=Array.from(t.options).find((p,n)=>n>0&&!p.hidden&&!p.disabled);y&&(t.value=y.value,window.location.hash=`#/${y.value}`,r.value="")}}),window.addEventListener("hashchange",()=>{let c=(window.location.hash||"#/").slice(2);t.value=c}),o.addEventListener("change",()=>{let s=window.location.hash;window.location.hash="",window.location.hash=s}),document.getElementById("clearBtn")?.addEventListener("click",()=>{q.clear(),R()}),document.getElementById("sendBtn")?.addEventListener("click",()=>{let s={name:document.getElementById("custName").value||"Anonim",phone:document.getElementById("custPhone").value||"-",email:document.getElementById("custEmail").value||"-",priority:document.getElementById("custPriority").value};if(q.isEmpty()){alert("Lista jest pusta!");return}ke(q.getItems(),s)}),R(),a.start()});"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./sw.js").then(e=>console.log("SW registered",e)).catch(e=>console.error("SW failed",e))});
