var qe=Object.defineProperty;var _=(e,t)=>{for(var a in t)qe(e,a,{get:t[a],enumerable:!0})};var C=class{routes=new Map;currentView=null;container;getCtx;categories=[];constructor(t,a){this.container=t,this.getCtx=a,window.addEventListener("hashchange",()=>this.handleRoute())}setCategories(t){this.categories=t}addRoute(t){this.routes.set(t.id,t)}handleRoute(){let a=(window.location.hash||"#/").slice(2);this.currentView&&this.currentView.unmount&&this.currentView.unmount(),this.container.innerHTML="";let i=this.routes.get(a);i?(this.currentView=i,i.mount(this.container,this.getCtx())):this.renderHome()}renderHome(){this.container.innerHTML=`
      <div class="category-grid">
        ${this.categories.map(t=>`
          <a href="categories/${t.id}.html"
             class="cat-card ${t.implemented?"":"disabled"}"
             onclick="if(${t.implemented}) { event.preventDefault(); window.location.hash='#/${t.id}'; } else { event.preventDefault(); }">
            <div class="cat-icon">${t.icon}</div>
            <div class="cat-title">${t.name}</div>
            ${t.implemented?"":'<div class="cat-status">Wkr\xF3tce</div>'}
          </a>
        `).join("")}
      </div>
    `}start(){this.handleRoute()}};function He(e,t){let a=[...e].sort((r,s)=>r.min-s.min),i=a.find(r=>t>=r.min&&(r.max===null||t<=r.max));if(i)return i;let l=a.find(r=>r.min>=t);return l||a[a.length-1]}function Ce(e,t){if(!t)return e;let a=t.find(i=>i.type==="minimum"&&i.unit==="m2");return a&&e<a.value?a.value:e}function g(e,t,a=[]){let i=Ce(t,e.rules),l=He(e.tiers,i),r=0;e.pricing==="per_unit"?r=i*l.price:r=l.price;let s=0,m=[];if(e.modifiers)for(let n of a){let o=e.modifiers.find(c=>c.id===n);o&&(m.push(o.name),o.type==="percent"?s+=r*o.value:o.type==="fixed_per_unit"?s+=o.value*i:s+=o.value)}let d=r+s,u=e.rules?.find(n=>n.type==="minimum"&&n.unit==="pln");return u&&d<u.value&&(d=u.value),{basePrice:r,effectiveQuantity:i,tierPrice:l.price,modifiersTotal:s,totalPrice:parseFloat(d.toFixed(2)),appliedModifiers:m}}var q={};_(q,{default:()=>Ve,id:()=>De,materials:()=>$e,modifiers:()=>ze,pricing:()=>Ie,rules:()=>Re,title:()=>Be,unit:()=>Ae});var De="solwent-plakaty",Be="SOLWENT - PLAKATY",Ae="m2",Ie="per_unit",Re=[{type:"minimum",unit:"m2",value:1}],ze=[{id:"express",name:"EXPRESS",type:"percent",value:.2}],$e=[{name:"Papier 150g p\xF3\u0142mat",tiers:[{min:1,max:3,price:65},{min:4,max:9,price:60},{min:10,max:20,price:55},{min:21,max:40,price:50},{min:41,max:null,price:42}]},{name:"Papier 200g po\u0142ysk",tiers:[{min:1,max:3,price:70},{min:4,max:9,price:65},{min:10,max:20,price:59},{min:21,max:40,price:53},{min:41,max:null,price:45}]},{name:"Papier 115g matowy",tiers:[{min:1,max:3,price:45},{min:4,max:19,price:40},{min:20,max:null,price:35}]}],Ve={id:De,title:Be,unit:Ae,pricing:Ie,rules:Re,modifiers:ze,materials:$e};function F(e){let t=q,a=t.materials.find(r=>r.name===e.material);if(!a)throw new Error(`Unknown material: ${e.material}`);let i={id:t.id,title:t.title,unit:t.unit,pricing:t.pricing,tiers:a.tiers,rules:t.rules,modifiers:t.modifiers},l=[];return e.express&&l.push("express"),g(i,e.areaM2,l)}function f(e){return new Intl.NumberFormat("pl-PL",{style:"currency",currency:"PLN"}).format(e)}var U={id:"solwent-plakaty",name:"Solwent - Plakaty",mount(e,t){let i=q.materials;e.innerHTML=`
      <h2>Solwent - Plakaty</h2>
      <div class="form">
        <div class="row">
          <label for="material">Materia\u0142:</label>
          <select id="material">
            ${i.map(c=>`<option value="${c.name}">${c.name}</option>`).join("")}
          </select>
        </div>

        <div class="row">
          <label for="area">Powierzchnia (m2):</label>
          <input type="number" id="area" value="1" min="0.1" step="0.1">
          <div class="hint">MINIMALKA 1m2!</div>
        </div>

        <div class="actions">
          <button id="calculate" class="primary">Oblicz</button>
          <button id="add-to-cart" class="success" disabled>Dodaj do listy</button>
        </div>

        <div id="result-display" style="display: none; margin-top: 20px; padding: 14px; background: rgba(34, 197, 94, 0.1); border: 1px solid rgba(34, 197, 94, 0.3); border-radius: 12px;">
          <div style="display: flex; justify-content: space-between;">
            <span>Cena jednostkowa:</span>
            <span id="unit-price" style="font-weight: 900;">-</span>
          </div>
          <div style="display: flex; justify-content: space-between;">
            <span style="font-weight: 800;">Cena ca\u0142kowita:</span>
            <span id="total-price" style="font-size: 18px; font-weight: 950; color: #22c55e;">-</span>
          </div>
        </div>
      </div>
    `;let l=e.querySelector("#material"),r=e.querySelector("#area"),s=e.querySelector("#calculate"),m=e.querySelector("#add-to-cart"),d=e.querySelector("#result-display"),u=e.querySelector("#unit-price"),n=e.querySelector("#total-price"),o=null;s.onclick=()=>{let c={material:l.value,areaM2:parseFloat(r.value),express:t.expressMode};try{let p=F(c);o=p,u.innerText=f(p.tierPrice),n.innerText=f(p.totalPrice),d.style.display="block",m.disabled=!1,t.updateLastCalculated(p.totalPrice,"Solwent - Plakaty")}catch(p){alert("B\u0142\u0105d: "+p.message)}},m.onclick=()=>{o&&t.cart.addItem({id:`solwent-${Date.now()}`,category:"Solwent - Plakaty",name:l.value,quantity:parseFloat(r.value),unit:"m2",unitPrice:o.tierPrice,isExpress:t.expressMode,totalPrice:o.totalPrice,optionsHint:`${r.value}m2${t.expressMode?", EXPRESS":""}`,payload:o})}}};var j=[{qty:1,single:20,double:25},{qty:2,single:29,double:32},{qty:3,single:30,double:37},{qty:4,single:32,double:39},{qty:5,single:35,double:43},{qty:6,single:39,double:45},{qty:7,single:41,double:48},{qty:8,single:45,double:50},{qty:9,single:48,double:52},{qty:10,single:52,double:58},{qty:15,single:60,double:70},{qty:20,single:67,double:82},{qty:25,single:74,double:100},{qty:30,single:84,double:120}];function N(e){let t=j,a=t.find(m=>m.qty===e.qty);a||(a=t.find(m=>m.qty>=e.qty)),a||(a=t[t.length-1]);let i=a[e.sides],l=0;e.satin&&(l+=.12),e.express&&(l+=.2);let r=i*l,s=i+r;return{basePrice:i,modifiersTotal:parseFloat(r.toFixed(2)),totalPrice:parseFloat(s.toFixed(2))}}var W={id:"vouchery",name:"Vouchery",mount(e,t){e.innerHTML=`
      <h2>Vouchery A4</h2>
      <div class="form">
        <div class="row">
          <label for="v-qty">Ilo\u015B\u0107 (szt):</label>
          <input type="number" id="v-qty" value="1" min="1" max="30" step="1">
          <div class="hint">Zakres 1-30 szt.</div>
        </div>

        <div class="row">
          <label>Zadruk:</label>
          <div class="radio-group" style="display: flex; gap: 20px; margin-top: 8px;">
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
              <input type="radio" name="v-sides" value="single" checked> Jednostronne
            </label>
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
              <input type="radio" name="v-sides" value="double"> Dwustronne
            </label>
          </div>
        </div>

        <div class="row">
          <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
            <input type="checkbox" id="v-satin"> Papier satynowy (+12%)
          </label>
        </div>

        <div class="actions">
          <button id="v-calculate" class="primary">Oblicz</button>
          <button id="v-add-to-cart" class="success" disabled>Dodaj do listy</button>
        </div>

        <div id="v-result-display" style="display: none; margin-top: 20px; padding: 14px; background: rgba(34, 197, 94, 0.1); border: 1px solid rgba(34, 197, 94, 0.3); border-radius: 12px;">
          <div style="display: flex; justify-content: space-between;">
            <span>Cena bazowa:</span>
            <span id="v-base-price" style="font-weight: 900;">-</span>
          </div>
          <div id="v-modifiers-row" style="display: none; justify-content: space-between; font-size: 0.9em; opacity: 0.8;">
            <span>Dop\u0142aty:</span>
            <span id="v-modifiers-total">-</span>
          </div>
          <div style="display: flex; justify-content: space-between; margin-top: 8px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 8px;">
            <span style="font-weight: 800;">Cena ca\u0142kowita:</span>
            <span id="v-total-price" style="font-size: 18px; font-weight: 950; color: #22c55e;">-</span>
          </div>
        </div>
      </div>
    `;let a=e.querySelector("#v-qty"),i=e.querySelector("#v-satin"),l=e.querySelector("#v-calculate"),r=e.querySelector("#v-add-to-cart"),s=e.querySelector("#v-result-display"),m=e.querySelector("#v-base-price"),d=e.querySelector("#v-modifiers-row"),u=e.querySelector("#v-modifiers-total"),n=e.querySelector("#v-total-price"),o=null,c=null;l.onclick=()=>{let p=e.querySelector('input[name="v-sides"]:checked'),b=p?p.value:"single";c={qty:parseInt(a.value),sides:b,satin:i.checked,express:t.expressMode};try{let y=N(c);o=y,m.innerText=f(y.basePrice),y.modifiersTotal>0?(d.style.display="flex",u.innerText="+"+f(y.modifiersTotal)):d.style.display="none",n.innerText=f(y.totalPrice),s.style.display="block",r.disabled=!1,t.updateLastCalculated(y.totalPrice,"Vouchery")}catch(y){alert("B\u0142\u0105d: "+y.message)}},r.onclick=()=>{if(o&&c){let p=c.sides==="single"?"Jednostronne":"Dwustronne",b=c.satin?", Satyna":"",y=c.express?", EXPRESS":"";t.cart.addItem({id:`vouchery-${Date.now()}`,category:"Vouchery",name:`Vouchery A4 ${p}`,quantity:c.qty,unit:"szt",unitPrice:o.totalPrice/c.qty,isExpress:c.express,totalPrice:o.totalPrice,optionsHint:`${c.qty} szt${b}${y}`,payload:o})}}}};var T={name:"DYPLOMY - druk cyfrowy",modifiers:{satin:.12,express:.2,bulkDiscount:.12,bulkDiscountThreshold:6},formats:{DL:{name:"DL (99x210mm)",single:{"1":20,"2":30,"3":32,"4":34,"5":35,"6":35,"7":36,"8":37,"9":39,"10":40,"15":45,"20":49,"30":58,"40":65,"50":75,"100":120},double:{"1":20,"2":30,"3":32,"4":34,"5":35,"6":35,"7":36,"8":37,"9":39,"10":40,"15":45,"20":49,"30":58,"40":65,"50":75,"100":120}}}};function Q(e){let{qty:t,sides:a,isSatin:i,express:l}=e,m=T.formats.DL[a===1?"single":"double"],d=Object.keys(m).map(Number).sort((y,k)=>y-k),u=d[0];for(let y of d)t>=y&&(u=y);let n=m[u.toString()],o=[];t>=T.modifiers.bulkDiscountThreshold&&o.push({id:"bulk-discount",name:`Rabat -${T.modifiers.bulkDiscount*100}% (od ${T.modifiers.bulkDiscountThreshold} szt)`,type:"percentage",value:-T.modifiers.bulkDiscount}),i&&o.push({id:"satin",name:"Papier satynowy (+12%)",type:"percentage",value:T.modifiers.satin}),l&&o.push({id:"express",name:"EXPRESS (+20%)",type:"percentage",value:T.modifiers.express});let c=0,p=[];for(let y of o)(y.type==="percent"||y.type==="percentage")&&(c+=n*y.value,p.push(y.name));let b=n+c;return{basePrice:n,effectiveQuantity:t,tierPrice:n/t,modifiersTotal:c,totalPrice:Math.round(b*100)/100,appliedModifiers:p}}var X={id:"dyplomy",name:"Dyplomy",async mount(e,t){let a=await fetch("categories/dyplomy.html");e.innerHTML=await a.text();let i=e.querySelector("#dypSides"),l=e.querySelector("#dypQty"),r=e.querySelector("#dypSatin"),s=e.querySelector("#calcBtn"),m=e.querySelector("#addToCartBtn"),d=e.querySelector("#dypResult"),u=()=>{let n={qty:parseInt(l.value)||1,sides:parseInt(i.value)||1,isSatin:r.checked,express:t.expressMode},o=Q(n);return d.style.display="block",e.querySelector("#resUnitPrice").textContent=f(o.totalPrice/n.qty),e.querySelector("#resTotalPrice").textContent=f(o.totalPrice),e.querySelector("#resDiscountHint").style.display=o.appliedModifiers.includes("bulk-discount")?"block":"none",e.querySelector("#resExpressHint").style.display=n.express?"block":"none",e.querySelector("#resSatinHint").style.display=n.isSatin?"block":"none",t.updateLastCalculated(o.totalPrice,"Dyplomy"),{options:n,result:o}};s.addEventListener("click",()=>u()),m.addEventListener("click",()=>{let{options:n,result:o}=u();t.cart.addItem({id:`dyp-${Date.now()}`,category:"Dyplomy",name:`Dyplomy DL ${n.sides===1?"1-str":"2-str"}`,quantity:n.qty,unit:"szt",unitPrice:o.totalPrice/n.qty,isExpress:n.express,totalPrice:o.totalPrice,optionsHint:`${n.qty} szt, ${n.isSatin?"Satyna":"Kreda"}`,payload:n})}),u()}};function K(e){return(Math.round((Number(e)||0)*100)/100).toFixed(2)}function V(e,t){return e.find(a=>t>=a.from&&t<=a.to)||null}function Z(e,t){let a=Object.keys(e||{}).map(Number).filter(Number.isFinite).sort((l,r)=>l-r);if(!a.length)return null;let i=a.find(l=>t<=l);return i??null}var M={print:{bw:{A4:[{from:1,to:5,unit:.9},{from:6,to:20,unit:.6},{from:21,to:100,unit:.35},{from:101,to:500,unit:.3},{from:501,to:999,unit:.23},{from:1e3,to:4999,unit:.19},{from:5e3,to:99999,unit:.15}],A3:[{from:1,to:5,unit:1.7},{from:6,to:20,unit:1.1},{from:21,to:100,unit:.7},{from:101,to:500,unit:.6},{from:501,to:999,unit:.45},{from:1e3,to:99999,unit:.33}]},color:{A4:[{from:1,to:10,unit:2.4},{from:11,to:40,unit:2.2},{from:41,to:100,unit:2},{from:101,to:250,unit:1.8},{from:251,to:500,unit:1.6},{from:501,to:999,unit:1.4},{from:1e3,to:99999,unit:1.1}],A3:[{from:1,to:10,unit:4.8},{from:11,to:40,unit:4.2},{from:41,to:100,unit:3.8},{from:101,to:250,unit:3},{from:251,to:500,unit:2.5},{from:501,to:999,unit:1.9},{from:1e3,to:99999,unit:1.6}]}},scan:{auto:[{from:1,to:9,unit:1},{from:10,to:49,unit:.5},{from:50,to:99,unit:.4},{from:100,to:999999999,unit:.25}],manual:[{from:1,to:4,unit:2},{from:5,to:999999999,unit:1}]},email_price:1},J={color:{formatowe:{A0p:26,A0:24,A1:12,A2:8.5,A3:5.3},mb:{A0p:21,A0:20,A1:14.5,A2:13.9,A3:12,R1067:30}},bw:{formatowe:{A0p:12.5,A0:11,A1:6,A2:4,A3:2.5},mb:{A0p:10,A0:9,A1:5,A2:4.5,A3:3.5,R1067:12.5}}},Y={A0p:{w:914,l:1292,label:"A0+"},A0:{w:841,l:1189,label:"A0"},A1:{w:594,l:841,label:"A1"},A2:{w:420,l:594,label:"A2"},A3:{w:297,l:420,label:"A3"}},G=.5;var D={cyfrowe:{standardPrices:{"85x55":{noLam:{50:65,100:75,150:85,200:96,250:110,300:126,400:146,500:170,1e3:290},lam:{50:160,100:170,150:180,200:190,250:200,300:220,400:240,500:250,1e3:335}},"90x50":{noLam:{50:70,100:79,150:89,200:99,250:120,300:129,400:149,500:175,1e3:300},lam:{50:170,100:180,150:190,200:200,250:210,300:230,400:250,500:260,1e3:345}}},softtouchPrices:{"85x55":{noLam:{50:65,100:75,150:85,200:96,250:110,300:126,400:145,500:170,1e3:290},lam:{50:170,100:190,150:210,200:220,250:230,300:240,400:260,500:270,1e3:380}},"90x50":{noLam:{50:70,100:79,150:89,200:99,250:120,300:129,400:149,500:175,1e3:300},lam:{50:170,100:190,150:210,200:220,250:230,300:240,400:260,500:270,1e3:390}}},deluxe:{leadTime:"4\u20135 dni roboczych",options:{uv3d_softtouch:{label:"Maker UV 3D + folia SOFTTOUCH",prices:{50:280,100:320,200:395,250:479,400:655,500:778}},uv3d_gold_softtouch:{label:"Maker UV 3D + z\u0142ocenie + folia SOFTTOUCH",prices:{50:450,100:550,200:650,250:720,400:850,500:905}}}}}};function ee(e){if(e.pages<=0)return{unitPrice:0,printTotal:0,emailTotal:e.email?M.email_price:0,inkTotal:0,grandTotal:e.email?M.email_price:0};let t=M.print[e.mode][e.format],a=V(t,e.pages);if(!a)throw new Error("Brak progu cenowego dla druku.");let i=a.unit,l=e.pages*i,r=0;e.email&&(r=M.email_price);let s=0;return e.ink25&&(s=.5*i*e.ink25Qty),{unitPrice:i,printTotal:l,emailTotal:r,inkTotal:s,grandTotal:l+r+s}}function te(e){if(e.pages<=0)return{unitPrice:0,total:0};let t=M.scan[e.type],a=V(t,e.pages);if(!a)throw new Error("Brak progu cenowego dla skanowania.");let i=a.unit;return{unitPrice:i,total:e.pages*i}}function ae(e){let t=Y[e.format];if(!t)throw new Error("Nieznany format CAD.");let i=Math.abs(e.lengthMm-t.l)<=G?"formatowe":"mb",l=J[e.mode][i][e.format];if(l==null)throw new Error("Brak stawki w cenniku dla CAD.");let r=0;if(i==="formatowe")r=e.qty*l;else{let s=e.lengthMm/1e3;r=e.qty*s*l}return{detectedType:i,rate:l,total:parseFloat(K(r))}}function re(e){let t;e.family==="deluxe"?t=D.cyfrowe.deluxe.options[e.deluxeOpt].prices:t=(e.finish==="softtouch"?D.cyfrowe.softtouchPrices:D.cyfrowe.standardPrices)[e.size][e.lam];let a=Z(t,e.qty);if(a==null)throw new Error("Brak progu cenowego dla takiej ilo\u015Bci.");let i=t[a];return{qtyBilled:a,total:i}}function ie(e){let t=e.family||"standard",a=e.format||"85x55",i=e.folia==="none"?"noLam":"lam",l=e.finish||"mat",r=re({family:t,size:a,lam:i,finish:l,deluxeOpt:e.deluxeOpt,qty:e.qty}),s=r.total;return e.express&&(s=r.total*1.2),{totalPrice:parseFloat(s.toFixed(2)),basePrice:r.total,effectiveQuantity:e.qty,tierPrice:r.total/r.qtyBilled,modifiersTotal:e.express?r.total*.2:0,appliedModifiers:e.express?["TRYB EXPRESS"]:[],qtyBilled:r.qtyBilled}}var ne={id:"wizytowki-druk-cyfrowy",name:"Wizyt\xF3wki - druk cyfrowy",mount(e,t){e.innerHTML=`
      <div class="category-view">
        <div class="view-header">
            <h2>Wizyt\xF3wki - druk cyfrowy</h2>
        </div>

        <div class="calculator-form card">
            <div class="form-group">
                <label for="w-family">Rodzaj:</label>
                <select id="w-family" class="form-control">
                    <option value="standard">Standard</option>
                    <option value="deluxe">DELUXE</option>
                </select>
            </div>

            <div id="standard-options">
                <div class="form-group">
                    <label for="w-finish">Wyko\u0144czenie:</label>
                    <select id="w-finish" class="form-control">
                        <option value="mat">Mat</option>
                        <option value="blysk">B\u0142ysk</option>
                        <option value="softtouch">SoftTouch</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="w-size">Rozmiar:</label>
                    <select id="w-size" class="form-control">
                        <option value="85x55">85x55 mm</option>
                        <option value="90x50">90x50 mm</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="w-lam">Foliowanie:</label>
                    <select id="w-lam" class="form-control">
                        <option value="noLam">Bez foliowania</option>
                        <option value="lam">Foliowane</option>
                    </select>
                </div>
            </div>

            <div id="deluxe-options" style="display: none;">
                <div class="form-group">
                    <label for="w-deluxe-opt">Opcja DELUXE:</label>
                    <select id="w-deluxe-opt" class="form-control">
                        <option value="uv3d_softtouch">UV 3D + SoftTouch</option>
                        <option value="uv3d_gold_softtouch">UV 3D + Z\u0142ocenie + SoftTouch</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label for="w-qty">Ilo\u015B\u0107 (szt):</label>
                <input type="number" id="w-qty" class="form-control" value="100" min="1">
                <div class="hint">Zaokr\u0105glamy w g\xF3r\u0119 do najbli\u017Cszego progu.</div>
            </div>

            <div class="form-actions">
                <button id="w-calculate" class="btn btn-primary">Oblicz</button>
                <button id="w-add-to-cart" class="btn btn-success" disabled>Dodaj do koszyka</button>
            </div>
        </div>

        <div id="w-result-display" class="result-display card" style="display: none;">
            <div class="result-row">
                <span>Cena brutto:</span>
                <span id="w-total-price" class="price-value">-</span>
            </div>
            <div id="w-billed-qty-hint" class="hint"></div>
            <div id="w-express-hint" class="express-hint" style="display: none;">
                W tym dop\u0142ata EXPRESS +20%
            </div>
        </div>
      </div>
    `,this.initLogic(e,t)},initLogic(e,t){let a=e.querySelector("#w-family"),i=e.querySelector("#standard-options"),l=e.querySelector("#deluxe-options"),r=e.querySelector("#w-finish"),s=e.querySelector("#w-size"),m=e.querySelector("#w-lam"),d=e.querySelector("#w-deluxe-opt"),u=e.querySelector("#w-qty"),n=e.querySelector("#w-calculate"),o=e.querySelector("#w-add-to-cart"),c=e.querySelector("#w-result-display"),p=e.querySelector("#w-total-price"),b=e.querySelector("#w-billed-qty-hint"),y=e.querySelector("#w-express-hint");a.onchange=()=>{let w=a.value==="deluxe";i.style.display=w?"none":"block",l.style.display=w?"block":"none"};let k=null,h=null;n.onclick=()=>{h={family:a.value,finish:r.value,format:s.value,folia:m.value==="lam"?"matt_gloss":"none",deluxeOpt:d.value,qty:parseInt(u.value),express:t.expressMode};try{let w=ie(h);k=w,p.innerText=f(w.totalPrice),b.innerText=`Rozliczono za: ${w.qtyBilled} szt.`,y.style.display=t.expressMode?"block":"none",c.style.display="block",o.disabled=!1,t.updateLastCalculated(w.totalPrice,"Wizyt\xF3wki")}catch(w){alert("B\u0142\u0105d: "+w.message)}},o.onclick=()=>{if(k&&h){let w=h.family==="deluxe"?"Wizyt\xF3wki DELUXE":"Wizyt\xF3wki Standard",x=h.express?", EXPRESS":"";t.cart.addItem({id:`wizytowki-${Date.now()}`,category:"Wizyt\xF3wki",name:w,quantity:k.qtyBilled,unit:"szt",unitPrice:k.totalPrice/k.qtyBilled,isExpress:h.express,totalPrice:k.totalPrice,optionsHint:`${h.qty} szt (rozliczono ${k.qtyBilled})${x}`,payload:k})}}}};var B={name:"Roll-up Jednostronny",formats:{"85x200":{width:.85,height:2,tiers:[{min:1,max:5,price:290},{min:6,max:10,price:275}]},"100x200":{width:1,height:2,tiers:[{min:1,max:5,price:305},{min:6,max:10,price:285}]},"120x200":{width:1.2,height:2,tiers:[{min:1,max:5,price:330},{min:6,max:10,price:310}]},"150x200":{width:1.5,height:2,tiers:[{min:1,max:5,price:440},{min:6,max:10,price:425}]}},replacement:{labor:50,print_per_m2:80}};function oe(e){let t=B.formats[e.format];if(!t)throw new Error(`Unknown format: ${e.format}`);let a;if(e.isReplacement){let r=t.width*t.height*B.replacement.print_per_m2+B.replacement.labor;a={id:"roll-up-replacement",title:`Wymiana wk\u0142adu (${e.format})`,unit:"szt",pricing:"per_unit",tiers:[{min:1,max:null,price:r}],modifiers:[{id:"express",name:"EXPRESS",type:"percent",value:.2}]}}else a={id:"roll-up-full",title:`Roll-up Komplet (${e.format})`,unit:"szt",pricing:"per_unit",tiers:t.tiers,modifiers:[{id:"express",name:"EXPRESS",type:"percent",value:.2}]};let i=[];return e.express&&i.push("express"),g(a,e.qty,i)}var le={id:"roll-up",name:"Roll-up",async mount(e,t){let a=await fetch("categories/roll-up.html");e.innerHTML=await a.text();let i=e.querySelector("#rollUpType"),l=e.querySelector("#rollUpFormat"),r=e.querySelector("#rollUpQty"),s=e.querySelector("#calcBtn"),m=e.querySelector("#addToCartBtn"),d=e.querySelector("#rollUpResult"),u=()=>{let n={format:l.value,qty:parseInt(r.value)||1,isReplacement:i.value==="replacement",express:t.expressMode},o=oe(n);return d.style.display="block",e.querySelector("#resUnitPrice").textContent=f(o.totalPrice/n.qty),e.querySelector("#resTotalPrice").textContent=f(o.totalPrice),e.querySelector("#resExpressHint").style.display=n.express?"block":"none",t.updateLastCalculated(o.totalPrice,"Roll-up"),{options:n,result:o}};s.addEventListener("click",()=>u()),m.addEventListener("click",()=>{let{options:n,result:o}=u();t.cart.addItem({id:`rollup-${Date.now()}`,category:"Roll-up",name:`${n.isReplacement?"Wymiana wk\u0142adu":"Roll-up Komplet"} ${n.format}`,quantity:n.qty,unit:"szt",unitPrice:o.totalPrice/n.qty,isExpress:n.express,totalPrice:o.totalPrice,optionsHint:`${n.format}, ${n.qty} szt`,payload:n})}),u()}};var A={name:"Zaproszenia KREDA - druk cyfrowy",modifiers:{satin:.12,express:.2},formats:{A6:{name:"A6 (105x148mm)",single:{normal:{"10":30,"24":40,"32":45,"50":50,"75":60,"100":68,"150":79},folded:{"10":45,"24":55,"32":60,"50":71,"75":84,"100":99,"150":126}},double:{normal:{"10":35,"24":46,"32":57,"50":66,"75":79,"100":89,"150":115},folded:{"10":58,"24":66,"32":84,"50":105,"75":125,"100":149,"150":199}}},A5:{name:"A5 (148x210mm)",single:{normal:{"10":34,"24":42,"32":48,"50":55,"75":63,"100":79,"150":110},folded:{"10":55,"24":60,"32":75,"50":95,"75":125,"100":150,"150":199}},double:{normal:{"10":40,"24":49,"32":62,"50":79,"75":96,"100":119,"150":169},folded:{"10":65,"24":80,"32":115,"50":149,"75":190,"100":235,"150":325}}},DL:{name:"DL (99x210mm)",single:{normal:{"10":35,"24":50,"32":53,"50":59,"75":70,"100":81,"150":105},folded:{"10":45,"24":55,"32":63,"50":79,"75":97,"100":115,"150":149}},double:{normal:{"10":41,"24":55,"32":64,"50":74,"75":88,"100":105,"150":135},folded:{"10":65,"24":80,"32":90,"50":115,"75":150,"100":185,"150":245}}}}};function se(e){let{format:t,qty:a,sides:i,isFolded:l,isSatin:r,express:s}=e,m=A.formats[t];if(!m)throw new Error(`Invalid format: ${t}`);let d=i===1?"single":"double",u=l?"folded":"normal",n=m[d][u],o=Object.keys(n).map(Number).sort((w,x)=>w-x),c=o[0];for(let w of o)a>=w&&(c=w);let p=n[c.toString()],b=[];r&&b.push({id:"satin",name:"Papier satynowy (+12%)",type:"percentage",value:A.modifiers.satin}),s&&b.push({id:"express",name:"EXPRESS (+20%)",type:"percentage",value:A.modifiers.express});let y=0,k=[];for(let w of b)(w.type==="percent"||w.type==="percentage")&&(y+=p*w.value,k.push(w.name));let h=p+y;return{basePrice:p,effectiveQuantity:a,tierPrice:p/a,modifiersTotal:y,totalPrice:Math.round(h*100)/100,appliedModifiers:k}}var ce={id:"zaproszenia-kreda",name:"Zaproszenia KREDA",async mount(e,t){let a=await fetch("categories/zaproszenia-kreda.html");e.innerHTML=await a.text();let i=e.querySelector("#zapFormat"),l=e.querySelector("#zapSides"),r=e.querySelector("#zapFolded"),s=e.querySelector("#zapQty"),m=e.querySelector("#zapSatin"),d=e.querySelector("#calcBtn"),u=e.querySelector("#addToCartBtn"),n=e.querySelector("#zapResult"),o=()=>{let c={format:i.value,qty:parseInt(s.value)||10,sides:parseInt(l.value)||1,isFolded:r.checked,isSatin:m.checked,express:t.expressMode},p=se(c);return n.style.display="block",e.querySelector("#resUnitPrice").textContent=f(p.totalPrice/c.qty),e.querySelector("#resTotalPrice").textContent=f(p.totalPrice),e.querySelector("#resExpressHint").style.display=c.express?"block":"none",e.querySelector("#resSatinHint").style.display=c.isSatin?"block":"none",t.updateLastCalculated(p.totalPrice,"Zaproszenia"),{options:c,result:p}};d.addEventListener("click",()=>o()),u.addEventListener("click",()=>{let{options:c,result:p}=o();t.cart.addItem({id:`zap-${Date.now()}`,category:"Zaproszenia Kreda",name:`Zaproszenia ${c.format} ${c.sides===1?"1-str":"2-str"}${c.isFolded?" sk\u0142adane":""}`,quantity:c.qty,unit:"szt",unitPrice:p.totalPrice/c.qty,isExpress:c.express,totalPrice:p.totalPrice,optionsHint:`${c.qty} szt, ${c.isSatin?"Satyna":"Kreda"}`,payload:c})}),o()}};var me={name:"Ulotki - Cyfrowe Dwustronne",formats:{A6:{name:"A6 (105x148)",tiers:[{min:10,max:10,price:40},{min:20,max:20,price:47},{min:30,max:30,price:49},{min:40,max:40,price:55},{min:50,max:50,price:60},{min:60,max:60,price:65},{min:70,max:70,price:70},{min:80,max:80,price:75},{min:90,max:90,price:90},{min:100,max:100,price:95},{min:150,max:150,price:120},{min:200,max:200,price:140},{min:300,max:300,price:190},{min:400,max:400,price:230},{min:500,max:500,price:270},{min:700,max:700,price:355},{min:1e3,max:1e3,price:476}]},A5:{name:"A5 (148 x 210)",tiers:[{min:10,max:10,price:45},{min:20,max:20,price:55},{min:30,max:30,price:60},{min:40,max:40,price:72},{min:50,max:50,price:90},{min:60,max:60,price:99},{min:70,max:70,price:112},{min:80,max:80,price:122},{min:90,max:90,price:130},{min:100,max:100,price:140},{min:150,max:150,price:180},{min:200,max:200,price:220},{min:300,max:300,price:310},{min:400,max:400,price:390},{min:500,max:500,price:460},{min:700,max:700,price:620},{min:1e3,max:1e3,price:790}]},DL:{name:"DL (99 x 210)",tiers:[{min:10,max:10,price:40},{min:20,max:20,price:50},{min:30,max:30,price:55},{min:40,max:40,price:65},{min:50,max:50,price:70},{min:60,max:60,price:78},{min:70,max:70,price:88},{min:80,max:80,price:99},{min:90,max:90,price:109},{min:100,max:100,price:119},{min:150,max:150,price:150},{min:200,max:200,price:179},{min:300,max:300,price:235},{min:400,max:400,price:290},{min:500,max:500,price:350},{min:700,max:700,price:460},{min:1e3,max:1e3,price:590}]}}};function Ne(e){let t=me.formats[e];if(!t)throw new Error(`Invalid format: ${e}`);return{id:`ulotki-cyfrowe-dwustronne-${e.toLowerCase()}`,title:`Ulotki Cyfrowe Dwustronne ${t.name}`,unit:"szt",pricing:"flat",tiers:t.tiers,modifiers:[{id:"express",name:"TRYB EXPRESS",type:"percent",value:.2}]}}function ue(e){let t=Ne(e.format),a=[];return e.express&&a.push("express"),g(t,e.qty,a)}var pe={id:"ulotki-cyfrowe-dwustronne",name:"Ulotki - Cyfrowe Dwustronne",async mount(e,t){try{let a=await fetch("categories/ulotki-cyfrowe-dwustronne.html");if(!a.ok)throw new Error("Failed to load template");e.innerHTML=await a.text(),this.initLogic(e,t)}catch(a){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${a}</div>`}},initLogic(e,t){let a=e.querySelector("#u-format"),i=e.querySelector("#u-qty"),l=e.querySelector("#u-calculate"),r=e.querySelector("#u-add-to-cart"),s=e.querySelector("#u-result-display"),m=e.querySelector("#u-total-price"),d=e.querySelector("#u-express-hint"),u=null,n=null;l.onclick=()=>{n={format:a.value,qty:parseInt(i.value),express:t.expressMode};try{let o=ue(n);u=o,m.innerText=f(o.totalPrice),d&&(d.style.display=t.expressMode?"block":"none"),s.style.display="block",r.disabled=!1,t.updateLastCalculated(o.totalPrice,"Ulotki")}catch(o){alert("B\u0142\u0105d: "+o.message)}},r.onclick=()=>{if(u&&n){let o=n.express?", EXPRESS":"";t.cart.addItem({id:`ulotki-dwustronne-${Date.now()}`,category:"Ulotki",name:`Ulotki Dwustronne ${n.format}`,quantity:n.qty,unit:"szt",unitPrice:u.totalPrice/n.qty,isExpress:n.express,totalPrice:u.totalPrice,optionsHint:`${n.qty} szt, Dwustronne${o}`,payload:u})}}}};var de={name:"Ulotki - Cyfrowe Jednostronne",formats:{A6:{name:"A6 (105x148)",tiers:[{min:10,max:10,price:30},{min:20,max:20,price:35},{min:30,max:30,price:40},{min:40,max:40,price:45},{min:50,max:50,price:55},{min:60,max:60,price:61},{min:70,max:70,price:65},{min:80,max:80,price:70},{min:90,max:90,price:75},{min:100,max:100,price:79},{min:150,max:150,price:90},{min:200,max:200,price:110},{min:300,max:300,price:145},{min:400,max:400,price:160},{min:500,max:500,price:190},{min:700,max:700,price:255},{min:1e3,max:1e3,price:320}]},A5:{name:"A5 (148 x 210)",tiers:[{min:10,max:10,price:35},{min:20,max:20,price:42},{min:30,max:30,price:50},{min:40,max:40,price:59},{min:50,max:50,price:69},{min:60,max:60,price:75},{min:70,max:70,price:82},{min:80,max:80,price:88},{min:90,max:90,price:93},{min:100,max:100,price:95},{min:150,max:150,price:130},{min:200,max:200,price:150},{min:300,max:300,price:210},{min:400,max:400,price:259},{min:500,max:500,price:300},{min:700,max:700,price:410},{min:1e3,max:1e3,price:530}]},DL:{name:"DL (99 x 210)",tiers:[{min:10,max:10,price:30},{min:20,max:20,price:35},{min:30,max:30,price:40},{min:40,max:40,price:45},{min:50,max:50,price:55},{min:60,max:60,price:60},{min:70,max:70,price:65},{min:80,max:80,price:70},{min:90,max:90,price:75},{min:100,max:100,price:83},{min:150,max:150,price:100},{min:200,max:200,price:120},{min:300,max:300,price:160},{min:400,max:400,price:199},{min:500,max:500,price:230},{min:700,max:700,price:310},{min:1e3,max:1e3,price:399}]}}};function Qe(e){let t=de.formats[e];if(!t)throw new Error(`Invalid format: ${e}`);return{id:`ulotki-cyfrowe-jednostronne-${e.toLowerCase()}`,title:`Ulotki Cyfrowe Jednostronne ${t.name}`,unit:"szt",pricing:"flat",tiers:t.tiers,modifiers:[{id:"express",name:"TRYB EXPRESS",type:"percent",value:.2}]}}function ye(e){let t=Qe(e.format),a=[];return e.express&&a.push("express"),g(t,e.qty,a)}var fe={id:"ulotki-cyfrowe-jednostronne",name:"Ulotki - Cyfrowe Jednostronne",async mount(e,t){try{let a=await fetch("categories/ulotki-cyfrowe-jednostronne.html");if(!a.ok)throw new Error("Failed to load template");e.innerHTML=await a.text(),this.initLogic(e,t)}catch(a){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${a}</div>`}},initLogic(e,t){let a=e.querySelector("#uj-format"),i=e.querySelector("#uj-qty"),l=e.querySelector("#uj-calculate"),r=e.querySelector("#uj-add-to-cart"),s=e.querySelector("#uj-result-display"),m=e.querySelector("#uj-total-price"),d=e.querySelector("#uj-express-hint"),u=null,n=null;l.onclick=()=>{n={format:a.value,qty:parseInt(i.value),express:t.expressMode};try{let o=ye(n);u=o,m.innerText=f(o.totalPrice),d&&(d.style.display=t.expressMode?"block":"none"),s.style.display="block",r.disabled=!1,t.updateLastCalculated(o.totalPrice,"Ulotki")}catch(o){alert("B\u0142\u0105d: "+o.message)}},r.onclick=()=>{if(u&&n){let o=n.express?", EXPRESS":"";t.cart.addItem({id:`ulotki-jednostronne-${Date.now()}`,category:"Ulotki",name:`Ulotki Jednostronne ${n.format}`,quantity:n.qty,unit:"szt",unitPrice:u.totalPrice/n.qty,isExpress:n.express,totalPrice:u.totalPrice,optionsHint:`${n.qty} szt, Jednostronne${o}`,payload:u})}}}};var xe={id:"banner",title:"Bannery",unit:"m2",pricing:"per_unit",materials:[{id:"powlekany",name:"Banner powlekany",tiers:[{min:1,max:25,price:53},{min:26,max:50,price:49},{min:51,max:null,price:45}]},{id:"blockout",name:"Banner Blockout",tiers:[{min:1,max:25,price:64},{min:26,max:50,price:59},{min:51,max:null,price:55}]}],modifiers:[{id:"oczkowanie",name:"Oczkowanie (+2.50 z\u0142/m2)",type:"fixed_per_unit",value:2.5},{id:"express",name:"TRYB EXPRESS (+20%)",type:"percent",value:.2}]};function we(e){let t=xe,a=t.materials.find(r=>r.id===e.material);if(!a)throw new Error(`Unknown material: ${e.material}`);let i={id:t.id,title:t.title,unit:t.unit,pricing:t.pricing,tiers:a.tiers,modifiers:t.modifiers},l=[];return e.oczkowanie&&l.push("oczkowanie"),e.express&&l.push("express"),g(i,e.areaM2,l)}var ke={id:"banner",name:"Bannery",async mount(e,t){try{let a=await fetch("categories/banner.html");if(!a.ok)throw new Error("Failed to load template");e.innerHTML=await a.text(),this.initLogic(e,t)}catch(a){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${a}</div>`}},initLogic(e,t){let a=e.querySelector("#b-material"),i=e.querySelector("#b-area"),l=e.querySelector("#b-oczkowanie"),r=e.querySelector("#b-calculate"),s=e.querySelector("#b-add-to-cart"),m=e.querySelector("#b-result-display"),d=e.querySelector("#b-unit-price"),u=e.querySelector("#b-total-price"),n=e.querySelector("#b-express-hint"),o=null,c=null;r.onclick=()=>{c={material:a.value,areaM2:parseFloat(i.value),oczkowanie:l.checked,express:t.expressMode};try{let p=we(c);o=p,d.innerText=f(p.tierPrice),u.innerText=f(p.totalPrice),n&&(n.style.display=t.expressMode?"block":"none"),m.style.display="block",s.disabled=!1,t.updateLastCalculated(p.totalPrice,"Banner")}catch(p){alert("B\u0142\u0105d: "+p.message)}},s.onclick=()=>{if(o&&c){let p=a.options[a.selectedIndex].text,b=[`${c.areaM2} m2`,c.oczkowanie?"z oczkowaniem":"bez oczkowania",c.express?"EXPRESS":""].filter(Boolean).join(", ");t.cart.addItem({id:`banner-${Date.now()}`,category:"Bannery",name:p,quantity:c.areaM2,unit:"m2",unitPrice:o.tierPrice,isExpress:c.express,totalPrice:o.totalPrice,optionsHint:b,payload:o})}}}};var H={};_(H,{category:()=>Ke,default:()=>Ye,groups:()=>Ze,modifiers:()=>Je});var Ke="Wlepki / Naklejki",Ze=[{id:"wlepki_obrys_folia",title:"Wlepki po obrysie (Folia Bia\u0142a/Trans)",unit:"m2",pricing:"per_unit",tiers:[{min:1,max:5,price:67},{min:6,max:25,price:60},{min:26,max:50,price:52},{min:51,max:null,price:48}],rules:[{type:"minimum",unit:"m2",value:1}]},{id:"wlepki_polipropylen",title:"Wlepki po obrysie - Polipropylen",unit:"m2",pricing:"per_unit",tiers:[{min:1,max:10,price:50},{min:11,max:null,price:42}],rules:[{type:"minimum",unit:"m2",value:1}]},{id:"wlepki_standard_folia",title:"Folia Bia\u0142a / Transparentna (standard)",unit:"m2",pricing:"per_unit",tiers:[{min:1,max:5,price:54},{min:6,max:25,price:50},{min:26,max:50,price:46},{min:51,max:null,price:42}],rules:[{type:"minimum",unit:"m2",value:1}]}],Je=[{id:"mocny_klej",name:"Mocny klej",type:"percent",value:.12},{id:"arkusze",name:"Ci\u0119te na arkusze",type:"fixed_per_unit",value:2},{id:"pojedyncze",name:"Ci\u0119te na pojedyncze sztuki",type:"fixed_per_unit",value:10},{id:"express",name:"EXPRESS",type:"percent",value:.2}],Ye={category:Ke,groups:Ze,modifiers:Je};function he(e){let t=H,a=t.groups.find(r=>r.id===e.groupId);if(!a)throw new Error(`Unknown group: ${e.groupId}`);let i={id:"wlepki",title:a.title,unit:a.unit,pricing:a.pricing||"per_unit",tiers:a.tiers,modifiers:t.modifiers,rules:a.rules||[{type:"minimum",unit:"m2",value:1}]},l=[...e.modifiers];return e.express&&l.push("express"),g(i,e.area,l)}var be={id:"wlepki-naklejki",name:"Wlepki / Naklejki",async mount(e,t){let a=H;try{let p=await fetch("categories/wlepki-naklejki.html");if(!p.ok)throw new Error("Failed to load template");e.innerHTML=await p.text()}catch(p){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania szablonu: ${p}</div>`;return}let i=e.querySelector("#wlepki-group"),l=e.querySelector("#wlepki-area"),r=e.querySelector("#btn-calculate"),s=e.querySelector("#btn-add-to-cart"),m=e.querySelector("#wlepki-result"),d=e.querySelector("#unit-price"),u=e.querySelector("#total-price"),n=null,o=null,c=()=>{let p=e.querySelectorAll(".wlepki-mod:checked"),b=Array.from(p).map(y=>y.value);o={groupId:i.value,area:parseFloat(l.value)||0,express:t.expressMode,modifiers:b};try{let y=he(o);n=y,d.textContent=f(y.tierPrice),u.textContent=f(y.totalPrice),m.style.display="block",s.disabled=!1,t.updateLastCalculated(y.totalPrice,"Wlepki")}catch(y){alert("B\u0142\u0105d: "+y.message)}};r.addEventListener("click",c),s.addEventListener("click",()=>{if(!n||!o)return;let p=a.groups.find(y=>y.id===o.groupId),b=o.modifiers.map(y=>{let k=a.modifiers.find(h=>h.id===y);return k?k.name:y});o.express&&b.unshift("EXPRESS (+20%)"),t.cart.addItem({id:`wlepki-${Date.now()}`,category:"Wlepki / Naklejki",name:p?.title||"Wlepki",quantity:o.area,unit:"m2",unitPrice:n.tierPrice,isExpress:!!o.express,totalPrice:n.totalPrice,optionsHint:b.join(", ")||"Standard",payload:n})})}};function ge(e,t){let a=e.format.toUpperCase(),i=ee({mode:e.mode,format:a,pages:e.printQty,email:e.email,ink25:e.surcharge,ink25Qty:e.surchargeQty}),l={total:0,unitPrice:0};e.scanType!=="none"&&e.scanQty>0&&(l=te({type:e.scanType,pages:e.scanQty}));let r=i.grandTotal+l.total,s=r;return e.express&&(s=r*1.2),{totalPrice:parseFloat(s.toFixed(2)),unitPrintPrice:i.unitPrice,totalPrintPrice:i.printTotal,unitScanPrice:l.unitPrice,totalScanPrice:l.total,emailPrice:i.emailTotal,surchargePrice:i.inkTotal,baseTotal:r}}var L=[{id:"druk-a4-a3-skan",name:"Druk A4/A3 + skan",icon:"\u{1F5A8}\uFE0F",implemented:!0,pricing:{print_bw:[{min:1,max:5,a4:.9,a3:1.7},{min:6,max:20,a4:.6,a3:1.1},{min:21,max:100,a4:.35,a3:.7},{min:101,max:500,a4:.3,a3:.6},{min:501,max:999,a4:.23,a3:.45},{min:1e3,max:4999,a4:.19,a3:.33},{min:5e3,max:null,a4:.15,a3:.3}],print_color:[{min:1,max:10,a4:2.4,a3:4.8},{min:11,max:40,a4:2.2,a3:4.2},{min:41,max:100,a4:2,a3:3.8},{min:101,max:250,a4:1.8,a3:3},{min:251,max:500,a4:1.6,a3:2.5},{min:501,max:999,a4:1.4,a3:1.9},{min:1e3,max:null,a4:1.1,a3:1.6}],scan_auto:[{min:1,max:9,price:1},{min:10,max:49,price:.5},{min:50,max:99,price:.4},{min:100,max:null,price:.25}],scan_manual:[{min:1,max:4,price:2},{min:5,max:null,price:1}],email_cost:1,surcharge_factor:.5}},{id:"druk-cad",name:"Druk CAD wielkoformatowy",icon:"\u{1F4D0}",implemented:!0,format_prices:{bw:{A0p:{length:1292,price:12.5},A0:{length:1189,price:11},A1:{length:841,price:6},A2:{length:594,price:4},A3:{length:420,price:2.5}},color:{A0p:{length:1292,price:26},A0:{length:1189,price:24},A1:{length:841,price:12},A2:{length:594,price:8.5},A3:{length:420,price:5.3}}},meter_prices:{bw:{A0p:10,A0:9,A1:5,A2:4.5,A3:3.5},color:{A0p:21,A0:20,A1:14.5,A2:13.9,A3:12}}},{id:"laminowanie",name:"Laminowanie",icon:"\u2728",implemented:!0},{id:"solwent-plakaty",name:"Solwent - Plakaty",icon:"\u{1F5BC}\uFE0F",implemented:!0},{id:"vouchery",name:"Vouchery",icon:"\u{1F39F}\uFE0F",implemented:!0},{id:"dyplomy",name:"Dyplomy",icon:"\u{1F4DC}",implemented:!0},{id:"wizytowki-druk-cyfrowy",name:"Wizyt\xF3wki - druk cyfrowy",icon:"\u{1F4C7}",implemented:!0},{id:"zaproszenia-kreda",name:"Zaproszenia KREDA",icon:"\u2709\uFE0F",implemented:!0},{id:"ulotki-cyfrowe-dwustronne",name:"Ulotki - Cyfrowe Dwustronne",icon:"\u{1F4C4}",implemented:!0},{id:"ulotki-cyfrowe-jednostronne",name:"Ulotki - Cyfrowe Jednostronne",icon:"\u{1F4C4}",implemented:!0},{id:"banner",name:"Bannery",icon:"\u{1F3C1}",implemented:!0},{id:"wlepki-naklejki",name:"Wlepki / Naklejki",icon:"\u{1F3F7}\uFE0F",implemented:!0},{id:"roll-up",name:"Roll-up",icon:"\u2195\uFE0F",implemented:!0}];var ve={id:"druk-a4-a3-skan",name:"Druk A4/A3 + skan",async mount(e,t){try{let a=await fetch("categories/druk-a4-a3-skan.html");if(!a.ok)throw new Error("Failed to load template");e.innerHTML=await a.text(),this.initLogic(e,t)}catch(a){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${a}</div>`}},initLogic(e,t){let a=L.find(E=>E.id==="druk-a4-a3-skan")?.pricing;if(!a)return;let i=e.querySelector("#d-mode"),l=e.querySelector("#d-format"),r=e.querySelector("#d-print-qty"),s=e.querySelector("#d-email"),m=e.querySelector("#d-surcharge"),d=e.querySelector("#d-surcharge-qty"),u=e.querySelector("#surcharge-qty-row"),n=e.querySelector("#d-scan-type"),o=e.querySelector("#d-scan-qty"),c=e.querySelector("#scan-qty-row"),p=e.querySelector("#d-calculate"),b=e.querySelector("#d-add-to-cart"),y=e.querySelector("#d-result-display"),k=e.querySelector("#d-total-price"),h=e.querySelector("#d-express-hint");m.onchange=()=>{u.style.display=m.checked?"flex":"none"},n.onchange=()=>{c.style.display=n.value!=="none"?"flex":"none"};let w=null,x=null;p.onclick=()=>{x={mode:i.value,format:l.value,printQty:parseInt(r.value)||0,email:s.checked,surcharge:m.checked,surchargeQty:parseInt(d.value)||0,scanType:n.value,scanQty:parseInt(o.value)||0,express:t.expressMode};try{let E=ge(x,a);w=E,k.innerText=f(E.totalPrice),h&&(h.style.display=t.expressMode?"block":"none"),y.style.display="block",b.disabled=!1,t.updateLastCalculated(E.totalPrice,"Druk A4/A3 + skan")}catch(E){alert("B\u0142\u0105d: "+E.message)}},b.onclick=()=>{if(w&&x){let E=Date.now(),$=t.expressMode?1.2:1;if(x.printQty>0||x.scanQty>0&&x.scanType!=="none"){let v=[];x.printQty>0&&v.push(`${x.printQty} str. ${x.format.toUpperCase()} (${x.mode==="bw"?"CZ-B":"KOLOR"})`),x.scanQty>0&&x.scanType!=="none"&&v.push(`Skan ${x.scanType}: ${x.scanQty} str.`),t.expressMode&&v.push("EXPRESS");let O=(w.totalPrintPrice+w.totalScanPrice)*$;t.cart.addItem({id:`druk-${E}-main`,category:"Druk A4/A3 + skan",name:`${x.format.toUpperCase()} ${x.mode==="bw"?"CZ-B":"KOLOR"}`,quantity:x.printQty||x.scanQty,unit:x.printQty>0?"str.":"skan",unitPrice:O/(x.printQty||x.scanQty),isExpress:t.expressMode,totalPrice:parseFloat(O.toFixed(2)),optionsHint:v.join(", "),payload:{...w,type:"main"}})}if(x.email){let v=w.emailPrice*$;t.cart.addItem({id:`email-${E}-email`,category:"Druk A4/A3 + skan",name:"Wysy\u0142ka e-mail",quantity:1,unit:"szt.",unitPrice:v,isExpress:t.expressMode,totalPrice:parseFloat(v.toFixed(2)),optionsHint:t.expressMode?"EXPRESS":"",payload:{price:v,type:"email"}})}if(x.surcharge&&x.surchargeQty>0){let v=w.surchargePrice*$;t.cart.addItem({id:`surcharge-${E}-surcharge`,category:"Druk A4/A3 + skan",name:"Zadruk >25% - dop\u0142ata",quantity:x.surchargeQty,unit:"str.",unitPrice:v/x.surchargeQty,isExpress:t.expressMode,totalPrice:parseFloat(v.toFixed(2)),optionsHint:`${x.surchargeQty} str. (+50%), ${t.expressMode?"EXPRESS":""}`,payload:{price:v,type:"surcharge"}})}}}}};function Ee(e,t){let a=ae({mode:e.mode,format:e.format,lengthMm:e.lengthMm,qty:e.qty||1}),i=a.total;return e.express&&(i=a.total*1.2),{totalPrice:parseFloat(i.toFixed(2)),basePrice:a.total,detectedType:a.detectedType,isMeter:a.detectedType==="mb",rate:a.rate}}var Se={id:"druk-cad",name:"Druk CAD wielkoformatowy",async mount(e,t){try{let a=await fetch("categories/druk-cad.html");if(!a.ok)throw new Error("Failed to load template");e.innerHTML=await a.text(),this.initLogic(e,t)}catch(a){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${a}</div>`}},initLogic(e,t){let a=L.find(h=>h.id==="druk-cad");if(!a)return;let i=e.querySelector("#cad-mode"),l=e.querySelector("#cad-format"),r=e.querySelector("#cad-length"),s=e.querySelector("#cad-use-base"),m=e.querySelector("#cad-base-info"),d=e.querySelector("#cad-calculate"),u=e.querySelector("#cad-add-to-cart"),n=e.querySelector("#cad-result-display"),o=e.querySelector("#cad-price-type"),c=e.querySelector("#cad-total-price"),p=e.querySelector("#cad-express-hint"),b=()=>{let h=l.value,w=i.value,x=a.format_prices[w][h].length;return m.innerText=`Wymiar bazowy: ${x} mm`,x};l.onchange=b,i.onchange=b,s.onclick=()=>{r.value=b().toString()};let y=null,k=null;d.onclick=()=>{k={mode:i.value,format:l.value,lengthMm:parseInt(r.value)||0,express:t.expressMode};try{let h=Ee(k,a);y=h,o.innerText=h.isMeter?"Cena metrowa:":"Cena formatowa:",c.innerText=f(h.totalPrice),p&&(p.style.display=t.expressMode?"block":"none"),n.style.display="block",u.disabled=!1,t.updateLastCalculated(h.totalPrice,"Druk CAD")}catch(h){alert("B\u0142\u0105d: "+h.message)}},u.onclick=()=>{if(y&&k){let h=[`${k.format} (${k.mode==="bw"?"CZ-B":"KOLOR"})`,`${k.lengthMm} mm`,t.expressMode?"EXPRESS":""].filter(Boolean).join(", ");t.cart.addItem({id:`cad-${Date.now()}`,category:"Druk CAD wielkoformatowy",name:`${k.format} ${k.mode==="bw"?"CZ-B":"KOLOR"}`,quantity:k.lengthMm,unit:"mm",unitPrice:y.basePrice/k.lengthMm,isExpress:t.expressMode,totalPrice:y.totalPrice,optionsHint:h,payload:y})}}}};var Te={formats:{A3:[{min:1,max:50,price:7},{min:51,max:100,price:6},{min:101,max:200,price:5}],A4:[{min:1,max:50,price:5},{min:51,max:100,price:4.5},{min:101,max:200,price:4}],A5:[{min:1,max:50,price:4},{min:51,max:100,price:3.5},{min:101,max:200,price:3}],A6:[{min:1,max:50,price:3},{min:51,max:100,price:2.5},{min:101,max:200,price:2}]}};function tt(e){let t=Te.formats[e];if(!t)throw new Error(`Invalid format: ${e}`);return{id:`laminowanie-${e.toLowerCase()}`,title:`Laminowanie ${e}`,unit:"szt",pricing:"per_unit",tiers:t,modifiers:[{id:"express",name:"TRYB EXPRESS",type:"percent",value:.2}]}}function Le(e){let t=tt(e.format),a=[];return e.express&&a.push("express"),g(t,e.qty,a)}var Pe={id:"laminowanie",name:"Laminowanie",async mount(e,t){try{let a=await fetch("categories/laminowanie.html");if(!a.ok)throw new Error("Failed to load template");e.innerHTML=await a.text(),this.initLogic(e,t)}catch(a){e.innerHTML=`<div class="error">B\u0142\u0105d \u0142adowania: ${a}</div>`}},initLogic(e,t){let a=e.querySelector("#lam-format"),i=e.querySelector("#lam-qty"),l=e.querySelector("#lam-calculate"),r=e.querySelector("#lam-add-to-cart"),s=e.querySelector("#lam-result-display"),m=e.querySelector("#lam-total-price"),d=e.querySelector("#lam-express-hint"),u=null,n=null,o=()=>{let c=parseInt(i.value);if(!(isNaN(c)||c<=0)){n={format:a.value,qty:c,express:t.expressMode};try{let p=Le(n);u=p,m.innerText=f(p.totalPrice),d&&(d.style.display=t.expressMode?"block":"none"),s.style.display="block",r.disabled=!1,t.updateLastCalculated(p.totalPrice,"Laminowanie")}catch(p){console.error(p)}}};l.onclick=o,r.onclick=()=>{if(u&&n){let c=n.express?", EXPRESS":"";t.cart.addItem({id:`laminowanie-${Date.now()}`,category:"Laminowanie",name:`Laminowanie ${n.format}`,quantity:n.qty,unit:"szt",unitPrice:u.totalPrice/n.qty,isExpress:n.express,totalPrice:u.totalPrice,optionsHint:`${n.qty} szt, Format ${n.format}${c}`,payload:u})}},[a,i].forEach(c=>{c.addEventListener("change",o)}),i.addEventListener("input",o)}};var R=class{items=[];storageKey="razdwa-cart-v1";constructor(){this.load()}load(){try{let t=localStorage.getItem(this.storageKey);t&&(this.items=JSON.parse(t))}catch(t){console.error("Failed to load cart from localStorage",t),this.items=[]}}save(){try{localStorage.setItem(this.storageKey,JSON.stringify(this.items))}catch(t){console.error("Failed to save cart to localStorage",t)}}addItem(t){this.items.push(t),this.save()}removeItem(t){t>=0&&t<this.items.length&&(this.items.splice(t,1),this.save())}clear(){this.items=[],this.save()}getItems(){return[...this.items]}getGrandTotal(){return this.items.reduce((t,a)=>t+a.totalPrice,0)}isEmpty(){return this.items.length===0}};function Me(e,t){if(typeof XLSX>"u"){console.error("XLSX library not loaded from CDN"),alert("B\u0142\u0105d: Biblioteka Excel nie zosta\u0142a wczytana.");return}let a=e.map(m=>({Kategoria:m.category,Nazwa:m.name,Ilo\u015B\u0107:m.quantity,Jednostka:m.unit,"Cena jedn.":m.unitPrice,"Express (+20%)":m.isExpress?"TAK":"NIE","Cena ca\u0142kowita":m.totalPrice,Klient:t.name,Telefon:t.phone,Email:t.email,Priorytet:t.priority})),i=XLSX.utils.json_to_sheet(a),l=XLSX.utils.book_new();XLSX.utils.book_append_sheet(l,i,"Zam\xF3wienie");let r=new Date().toISOString().slice(0,10),s=`Zamowienie_${t.name.replace(/\s+/g,"_")}_${r}.xlsx`;XLSX.writeFile(l,s)}var P=new R;function z(){let e=document.getElementById("basketList"),t=document.getElementById("basketTotal"),a=document.getElementById("basketDebug");if(!e||!t||!a)return;let i=P.getItems();i.length===0?e.innerHTML=`
      <div class="basketItem">
        <div>
          <div class="basketTitle">Brak pozycji</div>
          <div class="basketMeta">Kliknij \u201EDodaj\u201D, aby zbudowa\u0107 list\u0119.</div>
        </div>
        <div class="basketPrice">\u2014</div>
      </div>
    `:e.innerHTML=i.map((r,s)=>`
      <div class="basketItem">
        <div style="min-width:0;">
          <div class="basketTitle">${r.category}: ${r.name}</div>
          <div class="basketMeta">${r.optionsHint} (${r.quantity} ${r.unit})</div>
        </div>
        <div style="display:flex; gap:10px; align-items:center;">
          <div class="basketPrice">${f(r.totalPrice)}</div>
          <button class="iconBtn" onclick="window.removeItem(${s})" title="Usu\u0144">\xD7</button>
        </div>
      </div>
    `).join("");let l=P.getGrandTotal();t.innerText=f(l),a.innerText=JSON.stringify(i.map(r=>r.payload),null,2)}window.removeItem=e=>{P.removeItem(e),z()};document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("viewContainer"),t=document.getElementById("categorySelector"),a=document.getElementById("categorySearch"),i=document.getElementById("globalExpress");if(!e||!t||!i||!a)return;let l=()=>({cart:{addItem:s=>{P.addItem(s),z()}},expressMode:i.checked,updateLastCalculated:(s,m)=>{let d=document.getElementById("currentPrice"),u=document.getElementById("currentHint");d&&(d.innerText=f(s)),u&&(u.innerText=m?`(${m})`:"")}}),r=new C(e,l);r.setCategories(L),r.addRoute(ve),r.addRoute(Se),r.addRoute(U),r.addRoute(W),r.addRoute(X),r.addRoute(ne),r.addRoute(le),r.addRoute(ce),r.addRoute(pe),r.addRoute(fe),r.addRoute(ke),r.addRoute(be),r.addRoute(Pe),L.forEach(s=>{let m=document.createElement("option");m.value=s.id,m.innerText=`${s.icon} ${s.name}`,s.implemented||(m.disabled=!0,m.innerText+=" (wkr\xF3tce)"),t.appendChild(m)}),t.addEventListener("change",()=>{let s=t.value;s?window.location.hash=`#/${s}`:window.location.hash="#/"}),a.addEventListener("input",()=>{let s=a.value.toLowerCase();Array.from(t.options).forEach((d,u)=>{if(u===0)return;let n=d.text.toLowerCase();d.hidden=!n.includes(s)})}),a.addEventListener("keydown",s=>{if(s.key==="Enter"){let m=a.value.toLowerCase(),d=Array.from(t.options).find((u,n)=>n>0&&!u.hidden&&!u.disabled);d&&(t.value=d.value,window.location.hash=`#/${d.value}`,a.value="")}}),window.addEventListener("hashchange",()=>{let m=(window.location.hash||"#/").slice(2);t.value=m}),i.addEventListener("change",()=>{let s=window.location.hash;window.location.hash="",window.location.hash=s}),document.getElementById("clearBtn")?.addEventListener("click",()=>{P.clear(),z()}),document.getElementById("sendBtn")?.addEventListener("click",()=>{let s={name:document.getElementById("custName").value||"Anonim",phone:document.getElementById("custPhone").value||"-",email:document.getElementById("custEmail").value||"-",priority:document.getElementById("custPriority").value};if(P.isEmpty()){alert("Lista jest pusta!");return}Me(P.getItems(),s)}),z(),r.start()});"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./sw.js").then(e=>console.log("SW registered",e)).catch(e=>console.error("SW failed",e))});
