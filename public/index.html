<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kalkulator – Studio Raz Druku Dwa</title>
  <link rel="stylesheet" href="assets/styles.css" />
</head>

<body>
<div class="wrap">
  <header>
    <div>
      <h1>Kalkulator – Studio Raz Druku Dwa</h1>
      <p class="small">Oblicz → Dodaj do listy → Wyślij listę do arkusza.</p>
    </div>
  </header>

  <div class="grid">
    <!-- LEFT -->
    <div class="card">
      <div class="tabs">
        <button class="tab active" data-tab="simple">Druk A4/A3</button>
        <button class="tab" data-tab="cad">Druk CAD</button>
        <button class="tab" data-tab="cad_ops">CAD: składanie / skan</button>
        <button class="tab" data-tab="biz">Wizytówki</button>
      </div>

      <!-- TAB: SIMPLE -->
      <section id="tab-simple">
        <h2>Druk A4/A3 + skan</h2>

        <div class="form">
          <div class="row">
            <label>Tryb</label>
            <div class="control">
              <div class="seg" id="simpleModeSeg">
                <button type="button" class="chip active" data-value="bw">Czarno-biały</button>
                <button type="button" class="chip" data-value="color">Kolorowy</button>
              </div>
            </div>
          </div>

          <div class="row">
            <label>Format</label>
            <div class="control">
              <div class="seg" id="simpleFormatSeg">
                <button type="button" class="chip active" data-value="A4">A4</button>
                <button type="button" class="chip" data-value="A3">A3</button>
              </div>
            </div>
          </div>

          <div class="row">
            <label>Ilość stron druku</label>
            <div class="control">
              <input id="pagesPrint" type="number" min="0" step="1" value="" placeholder="np. 25" />
            </div>
          </div>

          <div class="row">
            <label>Wysyłka e-mail</label>
            <div class="control">
              <label class="hint" style="display:flex; align-items:center; gap:8px; color:var(--txt); font-weight:800;">
                <input id="emailShip" type="checkbox" style="width:auto;">
                +1 zł (osobny produkt)
              </label>
            </div>
          </div>

          <div class="row">
            <label>Zadruk &gt; 25%</label>
            <div class="control">
              <label class="hint" style="display:flex; align-items:center; gap:8px; color:var(--txt); font-weight:800;">
                <input id="ink25" type="checkbox" style="width:auto;">
                Dodaj dopłatę +50% jako osobny produkt
              </label>

              <div id="ink25Box" style="margin-top:8px; display:none;">
                <div class="hint">Ilość stron z dopłatą +50% (niezależnie od ilości stron druku).</div>
                <input id="ink25Qty" type="number" min="0" step="1" value="" placeholder="np. 10" />
              </div>
            </div>
          </div>

          <div class="divider"></div>

          <div class="row">
            <label>Skanowanie (A4/A3)</label>
            <div class="control">
              <select id="scanType">
                <option value="none">Brak</option>
                <option value="auto">Automatyczne A4/A3</option>
                <option value="manual">Ręczne z szyby A4/A3</option>
              </select>
            </div>
          </div>

          <div class="row">
            <label>Ilość stron skanu</label>
            <div class="control">
              <input id="scanQty" type="number" min="0" step="1" value="" placeholder="np. 5" />
              <div class="hint">Liczone jako stawka za stronę wg progów.</div>
            </div>
          </div>
        </div>

        <div class="actions">
          <button id="calcBtnSimple" class="primary">Oblicz</button>
          <button id="addBtnSimple">Dodaj</button>
        </div>
      </section>

      <!-- TAB: CAD -->
      <section id="tab-cad" class="hidden">
        <h2>Druk CAD wielkoformatowy</h2>

        <div class="form">
          <div class="row">
            <label>Tryb</label>
            <div class="control">
              <div class="seg" id="cadModeSeg">
                <button type="button" class="chip active" data-value="bw">Czarno-biały</button>
                <button type="button" class="chip" data-value="color">Kolorowy</button>
              </div>
              <div class="hint">Jeśli długość = bazowa → formatowe (zł/szt); jeśli inna → MB (zł/mb).</div>
            </div>
          </div>

          <div class="row">
            <label>Format</label>
            <div class="control">
              <div class="seg" id="cadFormatSeg">
               <button type="button" class="chip active" data-value="A0p">A0+</button>
<button type="button" class="chip" data-value="A0">A0</button>
<button type="button" class="chip" data-value="A1">A1</button>
<button type="button" class="chip" data-value="A2">A2</button>
<button type="button" class="chip" data-value="A3">A3</button>

              </div>
              <div class="hint" id="cadBaseSize">Wymiar bazowy: —</div>
            </div>
          </div>

          <div class="row">
            <label>Długość (mm)</label>
            <div class="control">
              <input id="cadLengthMm" type="number" min="0" step="1" value="" placeholder="np. 594 albo 687" />
              <div class="hint">Liczymy po długości (dłuższy bok).</div>
            </div>
          </div>

          <div class="row">
            <label></label>
            <div class="control actions" style="margin:0;">
              <button id="cadUseBaseBtn" type="button">Użyj długości bazowej</button>
            </div>
          </div>
        </div>

        <div class="divider"></div>
        <div class="hint" id="cadExplain"></div>

        <div class="actions">
          <button id="calcBtnCad" class="primary">Oblicz</button>
          <button id="addBtnCad">Dodaj</button>
        </div>
      </section>

      <!-- TAB: CAD OPS -->
      <section id="tab-cad_ops" class="hidden">
        <h2>CAD: składanie</h2>

        <div class="form">
          <div class="row">
            <label>Format</label>
            <div class="control">
              <div class="seg" id="foldFormatSeg">
                <button type="button" class="chip active" data-value="A0p">A0+</button>
                <button type="button" class="chip" data-value="A0">A0</button>
                <button type="button" class="chip" data-value="A1">A1</button>
                <button type="button" class="chip" data-value="A2">A2</button>
                <button type="button" class="chip" data-value="A3">A3</button>
                <button type="button" class="chip" data-value="A3L">A3-poprzeczne</button>
              </div>
              <div class="hint">Stawki: A0+ 4.00, A0 3.00, A1 2.00, A2 1.50, A3 1.00, A3-poprzeczne 0.70.</div>
            </div>
          </div>

          <div class="row">
            <label>Ilość sztuk</label>
            <div class="control">
              <input id="foldQty" type="number" min="0" step="1" value="" placeholder="np. 3" />
            </div>
          </div>
        </div>

        <div class="actions">
          <button id="addBtnFold" class="success">Dodaj składanie</button>
        </div>

        <div class="divider"></div>

        <h2>Skanowanie wielkoformatowe</h2>
        <div class="form">
          <div class="row">
            <label>Długość (mm)</label>
            <div class="control">
              <input id="wfScanMm" type="number" min="0" step="1" value="" placeholder="np. 1100" />
              <div class="hint">0,08 zł / cm. mm → cm = mm / 10 (zaokrąglenie do pełnych cm).</div>
            </div>
          </div>
          <div class="row">
            <label>Ilość sztuk</label>
            <div class="control">
              <input id="wfScanQty" type="number" min="0" step="1" value="" placeholder="np. 2" />
            </div>
          </div>
        </div>

        <div class="actions">
          <button id="addBtnWfScan" class="success">Dodaj skan</button>
        </div>
      </section>

      <!-- TAB: WIZYTÓWKI -->
      <section id="tab-biz" class="hidden">
        <h2>Wizytówki – druk cyfrowy</h2>

        <div class="form">
          <div class="row">
            <label>Rodzaj</label>
            <div class="control">
              <div class="seg" id="bizFamilySeg">
                <button type="button" class="chip active" data-value="standard">Standard</button>
                <button type="button" class="chip" data-value="deluxe">DELUXE</button>
              </div>
              <div class="hint">Standard: mat/błysk/softtouch (info ważne). DELUXE: UV 3D.</div>
            </div>
          </div>

          <div class="row" id="bizFinishRow">
            <label>Wykończenie</label>
            <div class="control">
              <div class="seg" id="bizFinishSeg">
                <button type="button" class="chip active" data-value="mat">Mat</button>
                <button type="button" class="chip" data-value="blysk">Błysk</button>
                <button type="button" class="chip" data-value="softtouch">SoftTouch</button>
              </div>
              <div class="hint">Ta opcja jest informacją do Excela (nawet jeśli ceny mat/błysk są takie same).</div>
            </div>
          </div>

          <div class="row" id="bizSizeRow">
            <label>Rozmiar</label>
            <div class="control">
              <div class="seg" id="bizSizeSeg">
                <button type="button" class="chip active" data-value="85x55">85×55</button>
                <button type="button" class="chip" data-value="90x50">90×50</button>
              </div>
            </div>
          </div>

          <div class="row" id="bizLamRow">
            <label>Foliowanie</label>
            <div class="control">
              <div class="seg" id="bizLamSeg">
                <button type="button" class="chip active" data-value="noLam">Bez</button>
                <button type="button" class="chip" data-value="lam">Foliowane</button>
              </div>
              <div class="hint">To wybiera „drugą cenę" z tabeli.</div>
            </div>
          </div>

          <div class="row" id="bizDeluxeOptRow" style="display:none;">
            <label>DELUXE opcja</label>
            <div class="control">
              <div class="seg" id="bizDeluxeOptSeg">
                <button type="button" class="chip active" data-value="uv3d_softtouch">UV 3D + SoftTouch</button>
                <button type="button" class="chip" data-value="uv3d_gold_softtouch">UV 3D + Złocenie + SoftTouch</button>
              </div>
              <div class="hint">Czas realizacji: 4–5 dni roboczych.</div>
            </div>
          </div>

          <div class="row">
            <label>Zadruk</label>
            <div class="control">
              <div class="seg" id="bizSidesSeg">
                <button type="button" class="chip active" data-value="s10">Jednostronne (1/0)</button>
                <button type="button" class="chip" data-value="s20">Dwustronne (2/0)</button>
              </div>
              <div class="hint">Nie wpływa na cenę (tu), ale idzie do Excela w podsumowaniu.</div>
            </div>
          </div>

          <div class="row">
            <label>Ilość sztuk</label>
            <div class="control">
              <input id="bizQty" type="number" min="1" step="1" value="" placeholder="np. 80 (zaokrągli do 100)" />
              <div class="hint">Zaokrąglamy w górę do najbliższego progu (np. 80 → 100).</div>
            </div>
          </div>

          <div class="actions">
            <button id="calcBtnBiz" class="primary">Oblicz</button>
            <button id="addBtnBiz">Dodaj</button>
          </div>
        </div>
      </section>

      <details style="margin-top:10px;">
        <summary>Szczegóły bieżącej pozycji (JSON)</summary>
        <pre id="debug">{}</pre>
      </details>
    </div>

    <!-- RIGHT -->
    <div class="card">
      <h2>Podsumowanie</h2>

      <div class="summary">
        <div class="sumRow">
          <div class="k">Ostatnio obliczone <span class="pill" id="currentHint"></span></div>
          <div class="v"><span id="currentPrice">0.00</span> zł</div>
        </div>
        <div class="sumRow total">
          <div class="k">Suma listy</div>
          <div class="v"><span id="basketTotal">0.00</span> zł</div>
        </div>
      </div>

      <div class="divider"></div>

      <div class="basket">
        <div class="basketList" id="basketList"></div>

        <div class="actions">
          <button id="clearBtn" class="danger">Wyczyść listę</button>
        </div>

        <div class="divider"></div>

        <details>
          <summary>Ustawienia wysyłki</summary>
          <div class="hint" style="margin-top:8px;">Wklej URL z wdrożenia Apps Script (Web App).</div>
          <input id="webAppUrl" type="text" placeholder="https://script.google.com/macros/s/.../exec" />
        </details>

        <div class="actions">
          <button id="sendBtn" class="success">Wyślij listę do arkusza</button>
          <button id="copyBtn">Kopiuj JSON listy</button>
          <span id="sendStatus" class="status"></span>
        </div>

        <details style="margin-top:10px;">
          <summary>Szczegóły listy (JSON)</summary>
          <pre id="basketDebug">[]</pre>
        </details>
      </div>
    </div>
  </div>
</div>
<script type="module" src="assets/app.js"></script>
</body>
</html>
